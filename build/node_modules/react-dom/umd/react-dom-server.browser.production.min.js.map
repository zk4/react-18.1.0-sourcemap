{"version":3,"file":"react-dom-server.browser.production.min.js","sources":["../../../../packages/shared/ReactVersion.js","../../../../packages/shared/formatProdErrorMessage.js","../../../../packages/react-server/src/ReactServerStreamConfigBrowser.js","../../../../packages/shared/hasOwnProperty.js","../../../../packages/react-dom/src/shared/DOMProperty.js","../../../../packages/react-dom/src/shared/CSSProperty.js","../../../../packages/react-dom/src/server/escapeTextForBrowser.js","../../../../packages/react-dom/src/shared/hyphenateStyleName.js","../../../../packages/shared/isArray.js","../../../../packages/react-dom/src/server/ReactDOMServerFormatConfig.js","../../../../packages/shared/assign.js","../../../../packages/shared/ReactSymbols.js","../../../../packages/shared/getComponentNameFromType.js","../../../../packages/shared/ReactSharedInternals.js","../../../../packages/shared/ReactComponentStackFrame.js","../../../../packages/shared/checkPropTypes.js","../../../../packages/react-server/src/ReactFizzContext.js","../../../../packages/react-server/src/ReactFizzNewContext.js","../../../../packages/shared/ReactInstanceMap.js","../../../../packages/react-server/src/ReactFizzClassComponent.js","../../../../packages/react-server/src/ReactFizzTreeContext.js","../../../../packages/shared/objectIs.js","../../../../packages/react-server/src/ReactFizzHooks.js","../../../../packages/react-server/src/ReactFizzServer.js","../../../../packages/react-dom/src/server/ReactDOMFizzServerBrowser.js"],"sourcesContent":["/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\n// TODO: this is special because it gets imported during build.\r\n//\r\n// TODO: 18.0.0 has not been released to NPM;\r\n// It exists as a placeholder so that DevTools can support work tag changes between releases.\r\n// When we next publish a release, update the matching TODO in backend/renderer.js\r\n// TODO: This module is used both by the release scripts and to expose a version\r\n// at runtime. We should instead inject the version number as part of the build\r\n// process, and use the ReactVersions.js module as the single source of truth.\r\nexport default '18.1.0';\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n */\r\n\r\n// Do not require this module directly! Use normal `invariant` calls with\r\n// template literal strings. The messages will be replaced with error codes\r\n// during build.\r\n\r\nfunction formatProdErrorMessage(code) {\r\n  let url = 'https://reactjs.org/docs/error-decoder.html?invariant=' + code;\r\n  for (let i = 1; i < arguments.length; i++) {\r\n    url += '&args[]=' + encodeURIComponent(arguments[i]);\r\n  }\r\n  return (\r\n    `Minified React error #${code}; visit ${url} for the full message or ` +\r\n    'use the non-minified dev environment for full errors and additional ' +\r\n    'helpful warnings.'\r\n  );\r\n}\r\n\r\nexport default formatProdErrorMessage;\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nexport type Destination = ReadableStreamController;\r\n\r\nexport type PrecomputedChunk = Uint8Array;\r\nexport type Chunk = Uint8Array;\r\n\r\nexport function scheduleWork(callback: () => void) {\r\n  callback();\r\n}\r\n\r\nexport function flushBuffered(destination: Destination) {\r\n  // WHATWG Streams do not yet have a way to flush the underlying\r\n  // transform streams. https://github.com/whatwg/streams/issues/960\r\n}\r\n\r\nconst VIEW_SIZE = 512;\r\nlet currentView = null;\r\nlet writtenBytes = 0;\r\n\r\nexport function beginWriting(destination: Destination) {\r\n  currentView = new Uint8Array(VIEW_SIZE);\r\n  writtenBytes = 0;\r\n}\r\n\r\nexport function writeChunk(\r\n  destination: Destination,\r\n  chunk: PrecomputedChunk | Chunk,\r\n): void {\r\n  if (chunk.length === 0) {\r\n    return;\r\n  }\r\n\r\n  if (chunk.length > VIEW_SIZE) {\r\n    // this chunk may overflow a single view which implies it was not\r\n    // one that is cached by the streaming renderer. We will enqueu\r\n    // it directly and expect it is not re-used\r\n    if (writtenBytes > 0) {\r\n      destination.enqueue(\r\n        new Uint8Array(\r\n          ((currentView: any): Uint8Array).buffer,\r\n          0,\r\n          writtenBytes,\r\n        ),\r\n      );\r\n      currentView = new Uint8Array(VIEW_SIZE);\r\n      writtenBytes = 0;\r\n    }\r\n    destination.enqueue(chunk);\r\n    return;\r\n  }\r\n\r\n  let bytesToWrite = chunk;\r\n  const allowableBytes = ((currentView: any): Uint8Array).length - writtenBytes;\r\n  if (allowableBytes < bytesToWrite.length) {\r\n    // this chunk would overflow the current view. We enqueue a full view\r\n    // and start a new view with the remaining chunk\r\n    if (allowableBytes === 0) {\r\n      // the current view is already full, send it\r\n      destination.enqueue(currentView);\r\n    } else {\r\n      // fill up the current view and apply the remaining chunk bytes\r\n      // to a new view.\r\n      ((currentView: any): Uint8Array).set(\r\n        bytesToWrite.subarray(0, allowableBytes),\r\n        writtenBytes,\r\n      );\r\n      // writtenBytes += allowableBytes; // this can be skipped because we are going to immediately reset the view\r\n      destination.enqueue(currentView);\r\n      bytesToWrite = bytesToWrite.subarray(allowableBytes);\r\n    }\r\n    currentView = new Uint8Array(VIEW_SIZE);\r\n    writtenBytes = 0;\r\n  }\r\n  ((currentView: any): Uint8Array).set(bytesToWrite, writtenBytes);\r\n  writtenBytes += bytesToWrite.length;\r\n}\r\n\r\nexport function writeChunkAndReturn(\r\n  destination: Destination,\r\n  chunk: PrecomputedChunk | Chunk,\r\n): boolean {\r\n  writeChunk(destination, chunk);\r\n  // in web streams there is no backpressure so we can alwas write more\r\n  return true;\r\n}\r\n\r\nexport function completeWriting(destination: Destination) {\r\n  if (currentView && writtenBytes > 0) {\r\n    destination.enqueue(new Uint8Array(currentView.buffer, 0, writtenBytes));\r\n    currentView = null;\r\n    writtenBytes = 0;\r\n  }\r\n}\r\n\r\nexport function close(destination: Destination) {\r\n  destination.close();\r\n}\r\n\r\nconst textEncoder = new TextEncoder();\r\n\r\nexport function stringToChunk(content: string): Chunk {\r\n  return textEncoder.encode(content);\r\n}\r\n\r\nexport function stringToPrecomputedChunk(content: string): PrecomputedChunk {\r\n  return textEncoder.encode(content);\r\n}\r\n\r\nexport function closeWithError(destination: Destination, error: mixed): void {\r\n  if (typeof destination.error === 'function') {\r\n    // $FlowFixMe: This is an Error object or the destination accepts other types.\r\n    destination.error(error);\r\n  } else {\r\n    // Earlier implementations doesn't support this method. In that environment you're\r\n    // supposed to throw from a promise returned but we don't return a promise in our\r\n    // approach. We could fork this implementation but this is environment is an edge\r\n    // case to begin with. It's even less common to run this in an older environment.\r\n    // Even then, this is not where errors are supposed to happen and they get reported\r\n    // to a global callback in addition to this anyway. So it's fine just to close this.\r\n    destination.close();\r\n  }\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\nexport default hasOwnProperty;\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport {\r\n  enableFilterEmptyStringAttributesDOM,\r\n  enableCustomElementPropertySupport,\r\n} from 'shared/ReactFeatureFlags';\r\nimport hasOwnProperty from 'shared/hasOwnProperty';\r\n\r\ntype PropertyType = 0 | 1 | 2 | 3 | 4 | 5 | 6;\r\n\r\n// A reserved attribute.\r\n// It is handled by React separately and shouldn't be written to the DOM.\r\nexport const RESERVED = 0;\r\n\r\n// A simple string attribute.\r\n// Attributes that aren't in the filter are presumed to have this type.\r\nexport const STRING = 1;\r\n\r\n// A string attribute that accepts booleans in React. In HTML, these are called\r\n// \"enumerated\" attributes with \"true\" and \"false\" as possible values.\r\n// When true, it should be set to a \"true\" string.\r\n// When false, it should be set to a \"false\" string.\r\nexport const BOOLEANISH_STRING = 2;\r\n\r\n// A real boolean attribute.\r\n// When true, it should be present (set either to an empty string or its name).\r\n// When false, it should be omitted.\r\nexport const BOOLEAN = 3;\r\n\r\n// An attribute that can be used as a flag as well as with a value.\r\n// When true, it should be present (set either to an empty string or its name).\r\n// When false, it should be omitted.\r\n// For any other value, should be present with that value.\r\nexport const OVERLOADED_BOOLEAN = 4;\r\n\r\n// An attribute that must be numeric or parse as a numeric.\r\n// When falsy, it should be removed.\r\nexport const NUMERIC = 5;\r\n\r\n// An attribute that must be positive numeric or parse as a positive numeric.\r\n// When falsy, it should be removed.\r\nexport const POSITIVE_NUMERIC = 6;\r\n\r\nexport type PropertyInfo = {|\r\n  +acceptsBooleans: boolean,\r\n  +attributeName: string,\r\n  +attributeNamespace: string | null,\r\n  +mustUseProperty: boolean,\r\n  +propertyName: string,\r\n  +type: PropertyType,\r\n  +sanitizeURL: boolean,\r\n  +removeEmptyString: boolean,\r\n|};\r\n\r\n/* eslint-disable max-len */\r\nexport const ATTRIBUTE_NAME_START_CHAR =\r\n  ':A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD';\r\n/* eslint-enable max-len */\r\nexport const ATTRIBUTE_NAME_CHAR =\r\n  ATTRIBUTE_NAME_START_CHAR + '\\\\-.0-9\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040';\r\n\r\nexport const VALID_ATTRIBUTE_NAME_REGEX = new RegExp(\r\n  '^[' + ATTRIBUTE_NAME_START_CHAR + '][' + ATTRIBUTE_NAME_CHAR + ']*$',\r\n);\r\n\r\nconst illegalAttributeNameCache = {};\r\nconst validatedAttributeNameCache = {};\r\n\r\nexport function isAttributeNameSafe(attributeName: string): boolean {\r\n  if (hasOwnProperty.call(validatedAttributeNameCache, attributeName)) {\r\n    return true;\r\n  }\r\n  if (hasOwnProperty.call(illegalAttributeNameCache, attributeName)) {\r\n    return false;\r\n  }\r\n  if (VALID_ATTRIBUTE_NAME_REGEX.test(attributeName)) {\r\n    validatedAttributeNameCache[attributeName] = true;\r\n    return true;\r\n  }\r\n  illegalAttributeNameCache[attributeName] = true;\r\n  if (__DEV__) {\r\n    console.error('Invalid attribute name: `%s`', attributeName);\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function shouldIgnoreAttribute(\r\n  name: string,\r\n  propertyInfo: PropertyInfo | null,\r\n  isCustomComponentTag: boolean,\r\n): boolean {\r\n  if (propertyInfo !== null) {\r\n    return propertyInfo.type === RESERVED;\r\n  }\r\n  if (isCustomComponentTag) {\r\n    return false;\r\n  }\r\n  if (\r\n    name.length > 2 &&\r\n    (name[0] === 'o' || name[0] === 'O') &&\r\n    (name[1] === 'n' || name[1] === 'N')\r\n  ) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function shouldRemoveAttributeWithWarning(\r\n  name: string,\r\n  value: mixed,\r\n  propertyInfo: PropertyInfo | null,\r\n  isCustomComponentTag: boolean,\r\n): boolean {\r\n  if (propertyInfo !== null && propertyInfo.type === RESERVED) {\r\n    return false;\r\n  }\r\n  switch (typeof value) {\r\n    case 'function':\r\n    // $FlowIssue symbol is perfectly valid here\r\n    case 'symbol': // eslint-disable-line\r\n      return true;\r\n    case 'boolean': {\r\n      if (isCustomComponentTag) {\r\n        return false;\r\n      }\r\n      if (propertyInfo !== null) {\r\n        return !propertyInfo.acceptsBooleans;\r\n      } else {\r\n        const prefix = name.toLowerCase().slice(0, 5);\r\n        return prefix !== 'data-' && prefix !== 'aria-';\r\n      }\r\n    }\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\nexport function shouldRemoveAttribute(\r\n  name: string,\r\n  value: mixed,\r\n  propertyInfo: PropertyInfo | null,\r\n  isCustomComponentTag: boolean,\r\n): boolean {\r\n  if (value === null || typeof value === 'undefined') {\r\n    return true;\r\n  }\r\n  if (\r\n    shouldRemoveAttributeWithWarning(\r\n      name,\r\n      value,\r\n      propertyInfo,\r\n      isCustomComponentTag,\r\n    )\r\n  ) {\r\n    return true;\r\n  }\r\n  if (isCustomComponentTag) {\r\n    if (enableCustomElementPropertySupport) {\r\n      if (value === false) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  if (propertyInfo !== null) {\r\n    if (enableFilterEmptyStringAttributesDOM) {\r\n      if (propertyInfo.removeEmptyString && value === '') {\r\n        if (__DEV__) {\r\n          if (name === 'src') {\r\n            console.error(\r\n              'An empty string (\"\") was passed to the %s attribute. ' +\r\n                'This may cause the browser to download the whole page again over the network. ' +\r\n                'To fix this, either do not render the element at all ' +\r\n                'or pass null to %s instead of an empty string.',\r\n              name,\r\n              name,\r\n            );\r\n          } else {\r\n            console.error(\r\n              'An empty string (\"\") was passed to the %s attribute. ' +\r\n                'To fix this, either do not render the element at all ' +\r\n                'or pass null to %s instead of an empty string.',\r\n              name,\r\n              name,\r\n            );\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n    }\r\n\r\n    switch (propertyInfo.type) {\r\n      case BOOLEAN:\r\n        return !value;\r\n      case OVERLOADED_BOOLEAN:\r\n        return value === false;\r\n      case NUMERIC:\r\n        return isNaN(value);\r\n      case POSITIVE_NUMERIC:\r\n        return isNaN(value) || (value: any) < 1;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function getPropertyInfo(name: string): PropertyInfo | null {\r\n  return properties.hasOwnProperty(name) ? properties[name] : null;\r\n}\r\n\r\nfunction PropertyInfoRecord(\r\n  name: string,\r\n  type: PropertyType,\r\n  mustUseProperty: boolean,\r\n  attributeName: string,\r\n  attributeNamespace: string | null,\r\n  sanitizeURL: boolean,\r\n  removeEmptyString: boolean,\r\n) {\r\n  this.acceptsBooleans =\r\n    type === BOOLEANISH_STRING ||\r\n    type === BOOLEAN ||\r\n    type === OVERLOADED_BOOLEAN;\r\n  this.attributeName = attributeName;\r\n  this.attributeNamespace = attributeNamespace;\r\n  this.mustUseProperty = mustUseProperty;\r\n  this.propertyName = name;\r\n  this.type = type;\r\n  this.sanitizeURL = sanitizeURL;\r\n  this.removeEmptyString = removeEmptyString;\r\n}\r\n\r\n// When adding attributes to this list, be sure to also add them to\r\n// the `possibleStandardNames` module to ensure casing and incorrect\r\n// name warnings.\r\nconst properties = {};\r\n\r\n// These props are reserved by React. They shouldn't be written to the DOM.\r\nconst reservedProps = [\r\n  'children',\r\n  'dangerouslySetInnerHTML',\r\n  // TODO: This prevents the assignment of defaultValue to regular\r\n  // elements (not just inputs). Now that ReactDOMInput assigns to the\r\n  // defaultValue property -- do we need this?\r\n  'defaultValue',\r\n  'defaultChecked',\r\n  'innerHTML',\r\n  'suppressContentEditableWarning',\r\n  'suppressHydrationWarning',\r\n  'style',\r\n];\r\nif (enableCustomElementPropertySupport) {\r\n  reservedProps.push('innerText', 'textContent');\r\n}\r\n\r\nreservedProps.forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    RESERVED,\r\n    false, // mustUseProperty\r\n    name, // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// A few React string attributes have a different name.\r\n// This is a mapping from React prop names to the attribute names.\r\n[\r\n  ['acceptCharset', 'accept-charset'],\r\n  ['className', 'class'],\r\n  ['htmlFor', 'for'],\r\n  ['httpEquiv', 'http-equiv'],\r\n].forEach(([name, attributeName]) => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    STRING,\r\n    false, // mustUseProperty\r\n    attributeName, // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These are \"enumerated\" HTML attributes that accept \"true\" and \"false\".\r\n// In React, we let users pass `true` and `false` even though technically\r\n// these aren't boolean attributes (they are coerced to strings).\r\n['contentEditable', 'draggable', 'spellCheck', 'value'].forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    BOOLEANISH_STRING,\r\n    false, // mustUseProperty\r\n    name.toLowerCase(), // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These are \"enumerated\" SVG attributes that accept \"true\" and \"false\".\r\n// In React, we let users pass `true` and `false` even though technically\r\n// these aren't boolean attributes (they are coerced to strings).\r\n// Since these are SVG attributes, their attribute names are case-sensitive.\r\n[\r\n  'autoReverse',\r\n  'externalResourcesRequired',\r\n  'focusable',\r\n  'preserveAlpha',\r\n].forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    BOOLEANISH_STRING,\r\n    false, // mustUseProperty\r\n    name, // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These are HTML boolean attributes.\r\n[\r\n  'allowFullScreen',\r\n  'async',\r\n  // Note: there is a special case that prevents it from being written to the DOM\r\n  // on the client side because the browsers are inconsistent. Instead we call focus().\r\n  'autoFocus',\r\n  'autoPlay',\r\n  'controls',\r\n  'default',\r\n  'defer',\r\n  'disabled',\r\n  'disablePictureInPicture',\r\n  'disableRemotePlayback',\r\n  'formNoValidate',\r\n  'hidden',\r\n  'loop',\r\n  'noModule',\r\n  'noValidate',\r\n  'open',\r\n  'playsInline',\r\n  'readOnly',\r\n  'required',\r\n  'reversed',\r\n  'scoped',\r\n  'seamless',\r\n  // Microdata\r\n  'itemScope',\r\n].forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    BOOLEAN,\r\n    false, // mustUseProperty\r\n    name.toLowerCase(), // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These are the few React props that we set as DOM properties\r\n// rather than attributes. These are all booleans.\r\n[\r\n  'checked',\r\n  // Note: `option.selected` is not updated if `select.multiple` is\r\n  // disabled with `removeAttribute`. We have special logic for handling this.\r\n  'multiple',\r\n  'muted',\r\n  'selected',\r\n\r\n  // NOTE: if you add a camelCased prop to this list,\r\n  // you'll need to set attributeName to name.toLowerCase()\r\n  // instead in the assignment below.\r\n].forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    BOOLEAN,\r\n    true, // mustUseProperty\r\n    name, // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These are HTML attributes that are \"overloaded booleans\": they behave like\r\n// booleans, but can also accept a string value.\r\n[\r\n  'capture',\r\n  'download',\r\n\r\n  // NOTE: if you add a camelCased prop to this list,\r\n  // you'll need to set attributeName to name.toLowerCase()\r\n  // instead in the assignment below.\r\n].forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    OVERLOADED_BOOLEAN,\r\n    false, // mustUseProperty\r\n    name, // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These are HTML attributes that must be positive numbers.\r\n[\r\n  'cols',\r\n  'rows',\r\n  'size',\r\n  'span',\r\n\r\n  // NOTE: if you add a camelCased prop to this list,\r\n  // you'll need to set attributeName to name.toLowerCase()\r\n  // instead in the assignment below.\r\n].forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    POSITIVE_NUMERIC,\r\n    false, // mustUseProperty\r\n    name, // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These are HTML attributes that must be numbers.\r\n['rowSpan', 'start'].forEach(name => {\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    NUMERIC,\r\n    false, // mustUseProperty\r\n    name.toLowerCase(), // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\nconst CAMELIZE = /[\\-\\:]([a-z])/g;\r\nconst capitalize = token => token[1].toUpperCase();\r\n\r\n// This is a list of all SVG attributes that need special casing, namespacing,\r\n// or boolean value assignment. Regular attributes that just accept strings\r\n// and have the same names are omitted, just like in the HTML attribute filter.\r\n// Some of these attributes can be hard to find. This list was created by\r\n// scraping the MDN documentation.\r\n[\r\n  'accent-height',\r\n  'alignment-baseline',\r\n  'arabic-form',\r\n  'baseline-shift',\r\n  'cap-height',\r\n  'clip-path',\r\n  'clip-rule',\r\n  'color-interpolation',\r\n  'color-interpolation-filters',\r\n  'color-profile',\r\n  'color-rendering',\r\n  'dominant-baseline',\r\n  'enable-background',\r\n  'fill-opacity',\r\n  'fill-rule',\r\n  'flood-color',\r\n  'flood-opacity',\r\n  'font-family',\r\n  'font-size',\r\n  'font-size-adjust',\r\n  'font-stretch',\r\n  'font-style',\r\n  'font-variant',\r\n  'font-weight',\r\n  'glyph-name',\r\n  'glyph-orientation-horizontal',\r\n  'glyph-orientation-vertical',\r\n  'horiz-adv-x',\r\n  'horiz-origin-x',\r\n  'image-rendering',\r\n  'letter-spacing',\r\n  'lighting-color',\r\n  'marker-end',\r\n  'marker-mid',\r\n  'marker-start',\r\n  'overline-position',\r\n  'overline-thickness',\r\n  'paint-order',\r\n  'panose-1',\r\n  'pointer-events',\r\n  'rendering-intent',\r\n  'shape-rendering',\r\n  'stop-color',\r\n  'stop-opacity',\r\n  'strikethrough-position',\r\n  'strikethrough-thickness',\r\n  'stroke-dasharray',\r\n  'stroke-dashoffset',\r\n  'stroke-linecap',\r\n  'stroke-linejoin',\r\n  'stroke-miterlimit',\r\n  'stroke-opacity',\r\n  'stroke-width',\r\n  'text-anchor',\r\n  'text-decoration',\r\n  'text-rendering',\r\n  'underline-position',\r\n  'underline-thickness',\r\n  'unicode-bidi',\r\n  'unicode-range',\r\n  'units-per-em',\r\n  'v-alphabetic',\r\n  'v-hanging',\r\n  'v-ideographic',\r\n  'v-mathematical',\r\n  'vector-effect',\r\n  'vert-adv-y',\r\n  'vert-origin-x',\r\n  'vert-origin-y',\r\n  'word-spacing',\r\n  'writing-mode',\r\n  'xmlns:xlink',\r\n  'x-height',\r\n\r\n  // NOTE: if you add a camelCased prop to this list,\r\n  // you'll need to set attributeName to name.toLowerCase()\r\n  // instead in the assignment below.\r\n].forEach(attributeName => {\r\n  const name = attributeName.replace(CAMELIZE, capitalize);\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    STRING,\r\n    false, // mustUseProperty\r\n    attributeName,\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// String SVG attributes with the xlink namespace.\r\n[\r\n  'xlink:actuate',\r\n  'xlink:arcrole',\r\n  'xlink:role',\r\n  'xlink:show',\r\n  'xlink:title',\r\n  'xlink:type',\r\n\r\n  // NOTE: if you add a camelCased prop to this list,\r\n  // you'll need to set attributeName to name.toLowerCase()\r\n  // instead in the assignment below.\r\n].forEach(attributeName => {\r\n  const name = attributeName.replace(CAMELIZE, capitalize);\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    STRING,\r\n    false, // mustUseProperty\r\n    attributeName,\r\n    'http://www.w3.org/1999/xlink',\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// String SVG attributes with the xml namespace.\r\n[\r\n  'xml:base',\r\n  'xml:lang',\r\n  'xml:space',\r\n\r\n  // NOTE: if you add a camelCased prop to this list,\r\n  // you'll need to set attributeName to name.toLowerCase()\r\n  // instead in the assignment below.\r\n].forEach(attributeName => {\r\n  const name = attributeName.replace(CAMELIZE, capitalize);\r\n  properties[name] = new PropertyInfoRecord(\r\n    name,\r\n    STRING,\r\n    false, // mustUseProperty\r\n    attributeName,\r\n    'http://www.w3.org/XML/1998/namespace',\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These attribute exists both in HTML and SVG.\r\n// The attribute name is case-sensitive in SVG so we can't just use\r\n// the React name like we do for attributes that exist only in HTML.\r\n['tabIndex', 'crossOrigin'].forEach(attributeName => {\r\n  properties[attributeName] = new PropertyInfoRecord(\r\n    attributeName,\r\n    STRING,\r\n    false, // mustUseProperty\r\n    attributeName.toLowerCase(), // attributeName\r\n    null, // attributeNamespace\r\n    false, // sanitizeURL\r\n    false, // removeEmptyString\r\n  );\r\n});\r\n\r\n// These attributes accept URLs. These must not allow javascript: URLS.\r\n// These will also need to accept Trusted Types object in the future.\r\nconst xlinkHref = 'xlinkHref';\r\nproperties[xlinkHref] = new PropertyInfoRecord(\r\n  'xlinkHref',\r\n  STRING,\r\n  false, // mustUseProperty\r\n  'xlink:href',\r\n  'http://www.w3.org/1999/xlink',\r\n  true, // sanitizeURL\r\n  false, // removeEmptyString\r\n);\r\n\r\n['src', 'href', 'action', 'formAction'].forEach(attributeName => {\r\n  properties[attributeName] = new PropertyInfoRecord(\r\n    attributeName,\r\n    STRING,\r\n    false, // mustUseProperty\r\n    attributeName.toLowerCase(), // attributeName\r\n    null, // attributeNamespace\r\n    true, // sanitizeURL\r\n    true, // removeEmptyString\r\n  );\r\n});\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\n/**\r\n * CSS properties which accept numbers but are not in units of \"px\".\r\n */\r\nexport const isUnitlessNumber = {\r\n  animationIterationCount: true,\r\n  aspectRatio: true,\r\n  borderImageOutset: true,\r\n  borderImageSlice: true,\r\n  borderImageWidth: true,\r\n  boxFlex: true,\r\n  boxFlexGroup: true,\r\n  boxOrdinalGroup: true,\r\n  columnCount: true,\r\n  columns: true,\r\n  flex: true,\r\n  flexGrow: true,\r\n  flexPositive: true,\r\n  flexShrink: true,\r\n  flexNegative: true,\r\n  flexOrder: true,\r\n  gridArea: true,\r\n  gridRow: true,\r\n  gridRowEnd: true,\r\n  gridRowSpan: true,\r\n  gridRowStart: true,\r\n  gridColumn: true,\r\n  gridColumnEnd: true,\r\n  gridColumnSpan: true,\r\n  gridColumnStart: true,\r\n  fontWeight: true,\r\n  lineClamp: true,\r\n  lineHeight: true,\r\n  opacity: true,\r\n  order: true,\r\n  orphans: true,\r\n  tabSize: true,\r\n  widows: true,\r\n  zIndex: true,\r\n  zoom: true,\r\n\r\n  // SVG-related properties\r\n  fillOpacity: true,\r\n  floodOpacity: true,\r\n  stopOpacity: true,\r\n  strokeDasharray: true,\r\n  strokeDashoffset: true,\r\n  strokeMiterlimit: true,\r\n  strokeOpacity: true,\r\n  strokeWidth: true,\r\n};\r\n\r\n/**\r\n * @param {string} prefix vendor-specific prefix, eg: Webkit\r\n * @param {string} key style name, eg: transitionDuration\r\n * @return {string} style name prefixed with `prefix`, properly camelCased, eg:\r\n * WebkitTransitionDuration\r\n */\r\nfunction prefixKey(prefix, key) {\r\n  return prefix + key.charAt(0).toUpperCase() + key.substring(1);\r\n}\r\n\r\n/**\r\n * Support style names that may come passed in prefixed by adding permutations\r\n * of vendor prefixes.\r\n */\r\nconst prefixes = ['Webkit', 'ms', 'Moz', 'O'];\r\n\r\n// Using Object.keys here, or else the vanilla for-in loop makes IE8 go into an\r\n// infinite loop, because it iterates over the newly added props too.\r\nObject.keys(isUnitlessNumber).forEach(function(prop) {\r\n  prefixes.forEach(function(prefix) {\r\n    isUnitlessNumber[prefixKey(prefix, prop)] = isUnitlessNumber[prop];\r\n  });\r\n});\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * Based on the escape-html library, which is used under the MIT License below:\r\n *\r\n * Copyright (c) 2012-2013 TJ Holowaychuk\r\n * Copyright (c) 2015 Andreas Lubbe\r\n * Copyright (c) 2015 Tiancheng \"Timothy\" Gu\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining\r\n * a copy of this software and associated documentation files (the\r\n * 'Software'), to deal in the Software without restriction, including\r\n * without limitation the rights to use, copy, modify, merge, publish,\r\n * distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to\r\n * the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\n// code copied and modified from escape-html\r\n/**\r\n * Module variables.\r\n * @private\r\n */\r\n\r\nimport {checkHtmlStringCoercion} from 'shared/CheckStringCoercion';\r\n\r\nconst matchHtmlRegExp = /[\"'&<>]/;\r\n\r\n/**\r\n * Escapes special characters and HTML entities in a given html string.\r\n *\r\n * @param  {string} string HTML string to escape for later insertion\r\n * @return {string}\r\n * @public\r\n */\r\n\r\nfunction escapeHtml(string) {\r\n  if (__DEV__) {\r\n    checkHtmlStringCoercion(string);\r\n  }\r\n  const str = '' + string;\r\n  const match = matchHtmlRegExp.exec(str);\r\n\r\n  if (!match) {\r\n    return str;\r\n  }\r\n\r\n  let escape;\r\n  let html = '';\r\n  let index;\r\n  let lastIndex = 0;\r\n\r\n  for (index = match.index; index < str.length; index++) {\r\n    switch (str.charCodeAt(index)) {\r\n      case 34: // \"\r\n        escape = '&quot;';\r\n        break;\r\n      case 38: // &\r\n        escape = '&amp;';\r\n        break;\r\n      case 39: // '\r\n        escape = '&#x27;'; // modified from escape-html; used to be '&#39'\r\n        break;\r\n      case 60: // <\r\n        escape = '&lt;';\r\n        break;\r\n      case 62: // >\r\n        escape = '&gt;';\r\n        break;\r\n      default:\r\n        continue;\r\n    }\r\n\r\n    if (lastIndex !== index) {\r\n      html += str.substring(lastIndex, index);\r\n    }\r\n\r\n    lastIndex = index + 1;\r\n    html += escape;\r\n  }\r\n\r\n  return lastIndex !== index ? html + str.substring(lastIndex, index) : html;\r\n}\r\n// end code copied and modified from escape-html\r\n\r\n/**\r\n * Escapes text to prevent scripting attacks.\r\n *\r\n * @param {*} text Text value to escape.\r\n * @return {string} An escaped string.\r\n */\r\nfunction escapeTextForBrowser(text) {\r\n  if (typeof text === 'boolean' || typeof text === 'number') {\r\n    // this shortcircuit helps perf for types that we know will never have\r\n    // special characters, especially given that this function is used often\r\n    // for numeric dom ids.\r\n    return '' + text;\r\n  }\r\n  return escapeHtml(text);\r\n}\r\n\r\nexport default escapeTextForBrowser;\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nconst uppercasePattern = /([A-Z])/g;\r\nconst msPattern = /^ms-/;\r\n\r\n/**\r\n * Hyphenates a camelcased CSS property name, for example:\r\n *\r\n *   > hyphenateStyleName('backgroundColor')\r\n *   < \"background-color\"\r\n *   > hyphenateStyleName('MozTransition')\r\n *   < \"-moz-transition\"\r\n *   > hyphenateStyleName('msTransition')\r\n *   < \"-ms-transition\"\r\n *\r\n * As Modernizr suggests (http://modernizr.com/docs/#prefixed), an `ms` prefix\r\n * is converted to `-ms-`.\r\n */\r\nexport default function hyphenateStyleName(name: string): string {\r\n  return name\r\n    .replace(uppercasePattern, '-$1')\r\n    .toLowerCase()\r\n    .replace(msPattern, '-ms-');\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\ndeclare function isArray(a: mixed): boolean %checks(Array.isArray(a));\r\n\r\nconst isArrayImpl = Array.isArray;\r\n\r\n// eslint-disable-next-line no-redeclare\r\nfunction isArray(a: mixed): boolean {\r\n  return isArrayImpl(a);\r\n}\r\n\r\nexport default isArray;\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport type {ReactNodeList} from 'shared/ReactTypes';\r\n\r\nimport {\r\n  checkHtmlStringCoercion,\r\n  checkCSSPropertyStringCoercion,\r\n  checkAttributeStringCoercion,\r\n} from 'shared/CheckStringCoercion';\r\n\r\nimport {Children} from 'react';\r\n\r\nimport {\r\n  enableFilterEmptyStringAttributesDOM,\r\n  enableCustomElementPropertySupport,\r\n} from 'shared/ReactFeatureFlags';\r\n\r\nimport type {\r\n  Destination,\r\n  Chunk,\r\n  PrecomputedChunk,\r\n} from 'react-server/src/ReactServerStreamConfig';\r\n\r\nimport {\r\n  writeChunk,\r\n  writeChunkAndReturn,\r\n  stringToChunk,\r\n  stringToPrecomputedChunk,\r\n} from 'react-server/src/ReactServerStreamConfig';\r\n\r\nimport {\r\n  getPropertyInfo,\r\n  isAttributeNameSafe,\r\n  BOOLEAN,\r\n  OVERLOADED_BOOLEAN,\r\n  NUMERIC,\r\n  POSITIVE_NUMERIC,\r\n} from '../shared/DOMProperty';\r\nimport {isUnitlessNumber} from '../shared/CSSProperty';\r\n\r\nimport {checkControlledValueProps} from '../shared/ReactControlledValuePropTypes';\r\nimport {validateProperties as validateARIAProperties} from '../shared/ReactDOMInvalidARIAHook';\r\nimport {validateProperties as validateInputProperties} from '../shared/ReactDOMNullInputValuePropHook';\r\nimport {validateProperties as validateUnknownProperties} from '../shared/ReactDOMUnknownPropertyHook';\r\nimport warnValidStyle from '../shared/warnValidStyle';\r\n\r\nimport escapeTextForBrowser from './escapeTextForBrowser';\r\nimport hyphenateStyleName from '../shared/hyphenateStyleName';\r\nimport hasOwnProperty from 'shared/hasOwnProperty';\r\nimport sanitizeURL from '../shared/sanitizeURL';\r\nimport isArray from 'shared/isArray';\r\n\r\n// Used to distinguish these contexts from ones used in other renderers.\r\n// E.g. this can be used to distinguish legacy renderers from this modern one.\r\nexport const isPrimaryRenderer = true;\r\n\r\n// Per response, global state that is not contextual to the rendering subtree.\r\nexport type ResponseState = {\r\n  bootstrapChunks: Array<Chunk | PrecomputedChunk>,\r\n  startInlineScript: PrecomputedChunk,\r\n  placeholderPrefix: PrecomputedChunk,\r\n  segmentPrefix: PrecomputedChunk,\r\n  boundaryPrefix: string,\r\n  idPrefix: string,\r\n  nextSuspenseID: number,\r\n  sentCompleteSegmentFunction: boolean,\r\n  sentCompleteBoundaryFunction: boolean,\r\n  sentClientRenderFunction: boolean, // We allow the legacy renderer to extend this object.\r\n  ...\r\n};\r\n\r\nconst startInlineScript = stringToPrecomputedChunk('<script>');\r\nconst endInlineScript = stringToPrecomputedChunk('</script>');\r\n\r\nconst startScriptSrc = stringToPrecomputedChunk('<script src=\"');\r\nconst startModuleSrc = stringToPrecomputedChunk('<script type=\"module\" src=\"');\r\nconst endAsyncScript = stringToPrecomputedChunk('\" async=\"\"></script>');\r\n\r\n/**\r\n * This escaping function is designed to work with bootstrapScriptContent only.\r\n * because we know we are escaping the entire script. We can avoid for instance\r\n * escaping html comment string sequences that are valid javascript as well because\r\n * if there are no sebsequent <script sequences the html parser will never enter\r\n * script data double escaped state (see: https://www.w3.org/TR/html53/syntax.html#script-data-double-escaped-state)\r\n *\r\n * While untrusted script content should be made safe before using this api it will\r\n * ensure that the script cannot be early terminated or never terminated state\r\n */\r\nfunction escapeBootstrapScriptContent(scriptText) {\r\n  if (__DEV__) {\r\n    checkHtmlStringCoercion(scriptText);\r\n  }\r\n  return ('' + scriptText).replace(scriptRegex, scriptReplacer);\r\n}\r\nconst scriptRegex = /(<\\/|<)(s)(cript)/gi;\r\nconst scriptReplacer = (match, prefix, s, suffix) =>\r\n  `${prefix}${s === 's' ? '\\\\u0073' : '\\\\u0053'}${suffix}`;\r\n\r\n// Allows us to keep track of what we've already written so we can refer back to it.\r\nexport function createResponseState(\r\n  identifierPrefix: string | void,\r\n  nonce: string | void,\r\n  bootstrapScriptContent: string | void,\r\n  bootstrapScripts: Array<string> | void,\r\n  bootstrapModules: Array<string> | void,\r\n): ResponseState {\r\n  const idPrefix = identifierPrefix === undefined ? '' : identifierPrefix;\r\n  const inlineScriptWithNonce =\r\n    nonce === undefined\r\n      ? startInlineScript\r\n      : stringToPrecomputedChunk(\r\n          '<script nonce=\"' + escapeTextForBrowser(nonce) + '\">',\r\n        );\r\n  const bootstrapChunks = [];\r\n  if (bootstrapScriptContent !== undefined) {\r\n    bootstrapChunks.push(\r\n      inlineScriptWithNonce,\r\n      stringToChunk(escapeBootstrapScriptContent(bootstrapScriptContent)),\r\n      endInlineScript,\r\n    );\r\n  }\r\n  if (bootstrapScripts !== undefined) {\r\n    for (let i = 0; i < bootstrapScripts.length; i++) {\r\n      bootstrapChunks.push(\r\n        startScriptSrc,\r\n        stringToChunk(escapeTextForBrowser(bootstrapScripts[i])),\r\n        endAsyncScript,\r\n      );\r\n    }\r\n  }\r\n  if (bootstrapModules !== undefined) {\r\n    for (let i = 0; i < bootstrapModules.length; i++) {\r\n      bootstrapChunks.push(\r\n        startModuleSrc,\r\n        stringToChunk(escapeTextForBrowser(bootstrapModules[i])),\r\n        endAsyncScript,\r\n      );\r\n    }\r\n  }\r\n  return {\r\n    bootstrapChunks: bootstrapChunks,\r\n    startInlineScript: inlineScriptWithNonce,\r\n    placeholderPrefix: stringToPrecomputedChunk(idPrefix + 'P:'),\r\n    segmentPrefix: stringToPrecomputedChunk(idPrefix + 'S:'),\r\n    boundaryPrefix: idPrefix + 'B:',\r\n    idPrefix: idPrefix,\r\n    nextSuspenseID: 0,\r\n    sentCompleteSegmentFunction: false,\r\n    sentCompleteBoundaryFunction: false,\r\n    sentClientRenderFunction: false,\r\n  };\r\n}\r\n\r\n// Constants for the insertion mode we're currently writing in. We don't encode all HTML5 insertion\r\n// modes. We only include the variants as they matter for the sake of our purposes.\r\n// We don't actually provide the namespace therefore we use constants instead of the string.\r\nconst ROOT_HTML_MODE = 0; // Used for the root most element tag.\r\nexport const HTML_MODE = 1;\r\nconst SVG_MODE = 2;\r\nconst MATHML_MODE = 3;\r\nconst HTML_TABLE_MODE = 4;\r\nconst HTML_TABLE_BODY_MODE = 5;\r\nconst HTML_TABLE_ROW_MODE = 6;\r\nconst HTML_COLGROUP_MODE = 7;\r\n// We have a greater than HTML_TABLE_MODE check elsewhere. If you add more cases here, make sure it\r\n// still makes sense\r\n\r\ntype InsertionMode = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7;\r\n\r\n// Lets us keep track of contextual state and pick it back up after suspending.\r\nexport type FormatContext = {\r\n  insertionMode: InsertionMode, // root/svg/html/mathml/table\r\n  selectedValue: null | string | Array<string>, // the selected value(s) inside a <select>, or null outside <select>\r\n};\r\n\r\nfunction createFormatContext(\r\n  insertionMode: InsertionMode,\r\n  selectedValue: null | string,\r\n): FormatContext {\r\n  return {\r\n    insertionMode,\r\n    selectedValue,\r\n  };\r\n}\r\n\r\nexport function createRootFormatContext(namespaceURI?: string): FormatContext {\r\n  const insertionMode =\r\n    namespaceURI === 'http://www.w3.org/2000/svg'\r\n      ? SVG_MODE\r\n      : namespaceURI === 'http://www.w3.org/1998/Math/MathML'\r\n      ? MATHML_MODE\r\n      : ROOT_HTML_MODE;\r\n  return createFormatContext(insertionMode, null);\r\n}\r\n\r\nexport function getChildFormatContext(\r\n  parentContext: FormatContext,\r\n  type: string,\r\n  props: Object,\r\n): FormatContext {\r\n  switch (type) {\r\n    case 'select':\r\n      return createFormatContext(\r\n        HTML_MODE,\r\n        props.value != null ? props.value : props.defaultValue,\r\n      );\r\n    case 'svg':\r\n      return createFormatContext(SVG_MODE, null);\r\n    case 'math':\r\n      return createFormatContext(MATHML_MODE, null);\r\n    case 'foreignObject':\r\n      return createFormatContext(HTML_MODE, null);\r\n    // Table parents are special in that their children can only be created at all if they're\r\n    // wrapped in a table parent. So we need to encode that we're entering this mode.\r\n    case 'table':\r\n      return createFormatContext(HTML_TABLE_MODE, null);\r\n    case 'thead':\r\n    case 'tbody':\r\n    case 'tfoot':\r\n      return createFormatContext(HTML_TABLE_BODY_MODE, null);\r\n    case 'colgroup':\r\n      return createFormatContext(HTML_COLGROUP_MODE, null);\r\n    case 'tr':\r\n      return createFormatContext(HTML_TABLE_ROW_MODE, null);\r\n  }\r\n  if (parentContext.insertionMode >= HTML_TABLE_MODE) {\r\n    // Whatever tag this was, it wasn't a table parent or other special parent, so we must have\r\n    // entered plain HTML again.\r\n    return createFormatContext(HTML_MODE, null);\r\n  }\r\n  if (parentContext.insertionMode === ROOT_HTML_MODE) {\r\n    // We've emitted the root and is now in plain HTML mode.\r\n    return createFormatContext(HTML_MODE, null);\r\n  }\r\n  return parentContext;\r\n}\r\n\r\nexport type SuspenseBoundaryID = null | PrecomputedChunk;\r\n\r\nexport const UNINITIALIZED_SUSPENSE_BOUNDARY_ID: SuspenseBoundaryID = null;\r\n\r\nexport function assignSuspenseBoundaryID(\r\n  responseState: ResponseState,\r\n): SuspenseBoundaryID {\r\n  const generatedID = responseState.nextSuspenseID++;\r\n  return stringToPrecomputedChunk(\r\n    responseState.boundaryPrefix + generatedID.toString(16),\r\n  );\r\n}\r\n\r\nexport function makeId(\r\n  responseState: ResponseState,\r\n  treeId: string,\r\n  localId: number,\r\n): string {\r\n  const idPrefix = responseState.idPrefix;\r\n\r\n  let id = ':' + idPrefix + 'R' + treeId;\r\n\r\n  // Unless this is the first id at this level, append a number at the end\r\n  // that represents the position of this useId hook among all the useId\r\n  // hooks for this fiber.\r\n  if (localId > 0) {\r\n    id += 'H' + localId.toString(32);\r\n  }\r\n\r\n  return id + ':';\r\n}\r\n\r\nfunction encodeHTMLTextNode(text: string): string {\r\n  return escapeTextForBrowser(text);\r\n}\r\n\r\nconst textSeparator = stringToPrecomputedChunk('<!-- -->');\r\n\r\nexport function pushTextInstance(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  text: string,\r\n  responseState: ResponseState,\r\n  textEmbedded: boolean,\r\n): boolean {\r\n  if (text === '') {\r\n    // Empty text doesn't have a DOM node representation and the hydration is aware of this.\r\n    return textEmbedded;\r\n  }\r\n  if (textEmbedded) {\r\n    target.push(textSeparator);\r\n  }\r\n  target.push(stringToChunk(encodeHTMLTextNode(text)));\r\n  return true;\r\n}\r\n\r\n// Called when Fizz is done with a Segment. Currently the only purpose is to conditionally\r\n// emit a text separator when we don't know for sure it is safe to omit\r\nexport function pushSegmentFinale(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  responseState: ResponseState,\r\n  lastPushedText: boolean,\r\n  textEmbedded: boolean,\r\n): void {\r\n  if (lastPushedText && textEmbedded) {\r\n    target.push(textSeparator);\r\n  }\r\n}\r\n\r\nconst styleNameCache: Map<string, PrecomputedChunk> = new Map();\r\nfunction processStyleName(styleName: string): PrecomputedChunk {\r\n  const chunk = styleNameCache.get(styleName);\r\n  if (chunk !== undefined) {\r\n    return chunk;\r\n  }\r\n  const result = stringToPrecomputedChunk(\r\n    escapeTextForBrowser(hyphenateStyleName(styleName)),\r\n  );\r\n  styleNameCache.set(styleName, result);\r\n  return result;\r\n}\r\n\r\nconst styleAttributeStart = stringToPrecomputedChunk(' style=\"');\r\nconst styleAssign = stringToPrecomputedChunk(':');\r\nconst styleSeparator = stringToPrecomputedChunk(';');\r\n\r\nfunction pushStyle(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  responseState: ResponseState,\r\n  style: Object,\r\n): void {\r\n  if (typeof style !== 'object') {\r\n    throw new Error(\r\n      'The `style` prop expects a mapping from style properties to values, ' +\r\n        \"not a string. For example, style={{marginRight: spacing + 'em'}} when \" +\r\n        'using JSX.',\r\n    );\r\n  }\r\n\r\n  let isFirst = true;\r\n  for (const styleName in style) {\r\n    if (!hasOwnProperty.call(style, styleName)) {\r\n      continue;\r\n    }\r\n    // If you provide unsafe user data here they can inject arbitrary CSS\r\n    // which may be problematic (I couldn't repro this):\r\n    // https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet\r\n    // http://www.thespanner.co.uk/2007/11/26/ultimate-xss-css-injection/\r\n    // This is not an XSS hole but instead a potential CSS injection issue\r\n    // which has lead to a greater discussion about how we're going to\r\n    // trust URLs moving forward. See #2115901\r\n    const styleValue = style[styleName];\r\n    if (\r\n      styleValue == null ||\r\n      typeof styleValue === 'boolean' ||\r\n      styleValue === ''\r\n    ) {\r\n      // TODO: We used to set empty string as a style with an empty value. Does that ever make sense?\r\n      continue;\r\n    }\r\n\r\n    let nameChunk;\r\n    let valueChunk;\r\n    const isCustomProperty = styleName.indexOf('--') === 0;\r\n    if (isCustomProperty) {\r\n      nameChunk = stringToChunk(escapeTextForBrowser(styleName));\r\n      if (__DEV__) {\r\n        checkCSSPropertyStringCoercion(styleValue, styleName);\r\n      }\r\n      valueChunk = stringToChunk(\r\n        escapeTextForBrowser(('' + styleValue).trim()),\r\n      );\r\n    } else {\r\n      if (__DEV__) {\r\n        warnValidStyle(styleName, styleValue);\r\n      }\r\n\r\n      nameChunk = processStyleName(styleName);\r\n      if (typeof styleValue === 'number') {\r\n        if (\r\n          styleValue !== 0 &&\r\n          !hasOwnProperty.call(isUnitlessNumber, styleName)\r\n        ) {\r\n          valueChunk = stringToChunk(styleValue + 'px'); // Presumes implicit 'px' suffix for unitless numbers\r\n        } else {\r\n          valueChunk = stringToChunk('' + styleValue);\r\n        }\r\n      } else {\r\n        if (__DEV__) {\r\n          checkCSSPropertyStringCoercion(styleValue, styleName);\r\n        }\r\n        valueChunk = stringToChunk(\r\n          escapeTextForBrowser(('' + styleValue).trim()),\r\n        );\r\n      }\r\n    }\r\n    if (isFirst) {\r\n      isFirst = false;\r\n      // If it's first, we don't need any separators prefixed.\r\n      target.push(styleAttributeStart, nameChunk, styleAssign, valueChunk);\r\n    } else {\r\n      target.push(styleSeparator, nameChunk, styleAssign, valueChunk);\r\n    }\r\n  }\r\n  if (!isFirst) {\r\n    target.push(attributeEnd);\r\n  }\r\n}\r\n\r\nconst attributeSeparator = stringToPrecomputedChunk(' ');\r\nconst attributeAssign = stringToPrecomputedChunk('=\"');\r\nconst attributeEnd = stringToPrecomputedChunk('\"');\r\nconst attributeEmptyString = stringToPrecomputedChunk('=\"\"');\r\n\r\nfunction pushAttribute(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  responseState: ResponseState,\r\n  name: string,\r\n  value: string | boolean | number | Function | Object, // not null or undefined\r\n): void {\r\n  switch (name) {\r\n    case 'style': {\r\n      pushStyle(target, responseState, value);\r\n      return;\r\n    }\r\n    case 'defaultValue':\r\n    case 'defaultChecked': // These shouldn't be set as attributes on generic HTML elements.\r\n    case 'innerHTML': // Must use dangerouslySetInnerHTML instead.\r\n    case 'suppressContentEditableWarning':\r\n    case 'suppressHydrationWarning':\r\n      // Ignored. These are built-in to React on the client.\r\n      return;\r\n  }\r\n  if (\r\n    // shouldIgnoreAttribute\r\n    // We have already filtered out null/undefined and reserved words.\r\n    name.length > 2 &&\r\n    (name[0] === 'o' || name[0] === 'O') &&\r\n    (name[1] === 'n' || name[1] === 'N')\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  const propertyInfo = getPropertyInfo(name);\r\n  if (propertyInfo !== null) {\r\n    // shouldRemoveAttribute\r\n    switch (typeof value) {\r\n      case 'function':\r\n      // $FlowIssue symbol is perfectly valid here\r\n      case 'symbol': // eslint-disable-line\r\n        return;\r\n      case 'boolean': {\r\n        if (!propertyInfo.acceptsBooleans) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    if (enableFilterEmptyStringAttributesDOM) {\r\n      if (propertyInfo.removeEmptyString && value === '') {\r\n        if (__DEV__) {\r\n          if (name === 'src') {\r\n            console.error(\r\n              'An empty string (\"\") was passed to the %s attribute. ' +\r\n                'This may cause the browser to download the whole page again over the network. ' +\r\n                'To fix this, either do not render the element at all ' +\r\n                'or pass null to %s instead of an empty string.',\r\n              name,\r\n              name,\r\n            );\r\n          } else {\r\n            console.error(\r\n              'An empty string (\"\") was passed to the %s attribute. ' +\r\n                'To fix this, either do not render the element at all ' +\r\n                'or pass null to %s instead of an empty string.',\r\n              name,\r\n              name,\r\n            );\r\n          }\r\n        }\r\n        return;\r\n      }\r\n    }\r\n\r\n    const attributeName = propertyInfo.attributeName;\r\n    const attributeNameChunk = stringToChunk(attributeName); // TODO: If it's known we can cache the chunk.\r\n\r\n    switch (propertyInfo.type) {\r\n      case BOOLEAN:\r\n        if (value) {\r\n          target.push(\r\n            attributeSeparator,\r\n            attributeNameChunk,\r\n            attributeEmptyString,\r\n          );\r\n        }\r\n        return;\r\n      case OVERLOADED_BOOLEAN:\r\n        if (value === true) {\r\n          target.push(\r\n            attributeSeparator,\r\n            attributeNameChunk,\r\n            attributeEmptyString,\r\n          );\r\n        } else if (value === false) {\r\n          // Ignored\r\n        } else {\r\n          target.push(\r\n            attributeSeparator,\r\n            attributeNameChunk,\r\n            attributeAssign,\r\n            stringToChunk(escapeTextForBrowser(value)),\r\n            attributeEnd,\r\n          );\r\n        }\r\n        return;\r\n      case NUMERIC:\r\n        if (!isNaN(value)) {\r\n          target.push(\r\n            attributeSeparator,\r\n            attributeNameChunk,\r\n            attributeAssign,\r\n            stringToChunk(escapeTextForBrowser(value)),\r\n            attributeEnd,\r\n          );\r\n        }\r\n        break;\r\n      case POSITIVE_NUMERIC:\r\n        if (!isNaN(value) && (value: any) >= 1) {\r\n          target.push(\r\n            attributeSeparator,\r\n            attributeNameChunk,\r\n            attributeAssign,\r\n            stringToChunk(escapeTextForBrowser(value)),\r\n            attributeEnd,\r\n          );\r\n        }\r\n        break;\r\n      default:\r\n        if (propertyInfo.sanitizeURL) {\r\n          if (__DEV__) {\r\n            checkAttributeStringCoercion(value, attributeName);\r\n          }\r\n          value = '' + (value: any);\r\n          sanitizeURL(value);\r\n        }\r\n        target.push(\r\n          attributeSeparator,\r\n          attributeNameChunk,\r\n          attributeAssign,\r\n          stringToChunk(escapeTextForBrowser(value)),\r\n          attributeEnd,\r\n        );\r\n    }\r\n  } else if (isAttributeNameSafe(name)) {\r\n    // shouldRemoveAttribute\r\n    switch (typeof value) {\r\n      case 'function':\r\n      // $FlowIssue symbol is perfectly valid here\r\n      case 'symbol': // eslint-disable-line\r\n        return;\r\n      case 'boolean': {\r\n        const prefix = name.toLowerCase().slice(0, 5);\r\n        if (prefix !== 'data-' && prefix !== 'aria-') {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    target.push(\r\n      attributeSeparator,\r\n      stringToChunk(name),\r\n      attributeAssign,\r\n      stringToChunk(escapeTextForBrowser(value)),\r\n      attributeEnd,\r\n    );\r\n  }\r\n}\r\n\r\nconst endOfStartTag = stringToPrecomputedChunk('>');\r\nconst endOfStartTagSelfClosing = stringToPrecomputedChunk('/>');\r\n\r\nfunction pushInnerHTML(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  innerHTML,\r\n  children,\r\n) {\r\n  if (innerHTML != null) {\r\n    if (children != null) {\r\n      throw new Error(\r\n        'Can only set one of `children` or `props.dangerouslySetInnerHTML`.',\r\n      );\r\n    }\r\n\r\n    if (typeof innerHTML !== 'object' || !('__html' in innerHTML)) {\r\n      throw new Error(\r\n        '`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. ' +\r\n          'Please visit https://reactjs.org/link/dangerously-set-inner-html ' +\r\n          'for more information.',\r\n      );\r\n    }\r\n\r\n    const html = innerHTML.__html;\r\n    if (html !== null && html !== undefined) {\r\n      if (__DEV__) {\r\n        checkHtmlStringCoercion(html);\r\n      }\r\n      target.push(stringToChunk('' + html));\r\n    }\r\n  }\r\n}\r\n\r\n// TODO: Move these to ResponseState so that we warn for every request.\r\n// It would help debugging in stateful servers (e.g. service worker).\r\nlet didWarnDefaultInputValue = false;\r\nlet didWarnDefaultChecked = false;\r\nlet didWarnDefaultSelectValue = false;\r\nlet didWarnDefaultTextareaValue = false;\r\nlet didWarnInvalidOptionChildren = false;\r\nlet didWarnInvalidOptionInnerHTML = false;\r\nlet didWarnSelectedSetOnOption = false;\r\n\r\nfunction checkSelectProp(props, propName) {\r\n  if (__DEV__) {\r\n    const value = props[propName];\r\n    if (value != null) {\r\n      const array = isArray(value);\r\n      if (props.multiple && !array) {\r\n        console.error(\r\n          'The `%s` prop supplied to <select> must be an array if ' +\r\n            '`multiple` is true.',\r\n          propName,\r\n        );\r\n      } else if (!props.multiple && array) {\r\n        console.error(\r\n          'The `%s` prop supplied to <select> must be a scalar ' +\r\n            'value if `multiple` is false.',\r\n          propName,\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction pushStartSelect(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  if (__DEV__) {\r\n    checkControlledValueProps('select', props);\r\n\r\n    checkSelectProp(props, 'value');\r\n    checkSelectProp(props, 'defaultValue');\r\n\r\n    if (\r\n      props.value !== undefined &&\r\n      props.defaultValue !== undefined &&\r\n      !didWarnDefaultSelectValue\r\n    ) {\r\n      console.error(\r\n        'Select elements must be either controlled or uncontrolled ' +\r\n          '(specify either the value prop, or the defaultValue prop, but not ' +\r\n          'both). Decide between using a controlled or uncontrolled select ' +\r\n          'element and remove one of these props. More info: ' +\r\n          'https://reactjs.org/link/controlled-components',\r\n      );\r\n      didWarnDefaultSelectValue = true;\r\n    }\r\n  }\r\n\r\n  target.push(startChunkForTag('select'));\r\n\r\n  let children = null;\r\n  let innerHTML = null;\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n          children = propValue;\r\n          break;\r\n        case 'dangerouslySetInnerHTML':\r\n          // TODO: This doesn't really make sense for select since it can't use the controlled\r\n          // value in the innerHTML.\r\n          innerHTML = propValue;\r\n          break;\r\n        case 'defaultValue':\r\n        case 'value':\r\n          // These are set on the Context instead and applied to the nested options.\r\n          break;\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  target.push(endOfStartTag);\r\n  pushInnerHTML(target, innerHTML, children);\r\n  return children;\r\n}\r\n\r\nfunction flattenOptionChildren(children: mixed): string {\r\n  let content = '';\r\n  // Flatten children and warn if they aren't strings or numbers;\r\n  // invalid types are ignored.\r\n  Children.forEach((children: any), function(child) {\r\n    if (child == null) {\r\n      return;\r\n    }\r\n    content += (child: any);\r\n    if (__DEV__) {\r\n      if (\r\n        !didWarnInvalidOptionChildren &&\r\n        typeof child !== 'string' &&\r\n        typeof child !== 'number'\r\n      ) {\r\n        didWarnInvalidOptionChildren = true;\r\n        console.error(\r\n          'Cannot infer the option value of complex children. ' +\r\n            'Pass a `value` prop or use a plain string as children to <option>.',\r\n        );\r\n      }\r\n    }\r\n  });\r\n  return content;\r\n}\r\n\r\nconst selectedMarkerAttribute = stringToPrecomputedChunk(' selected=\"\"');\r\n\r\nfunction pushStartOption(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  responseState: ResponseState,\r\n  formatContext: FormatContext,\r\n): ReactNodeList {\r\n  const selectedValue = formatContext.selectedValue;\r\n\r\n  target.push(startChunkForTag('option'));\r\n\r\n  let children = null;\r\n  let value = null;\r\n  let selected = null;\r\n  let innerHTML = null;\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n          children = propValue;\r\n          break;\r\n        case 'selected':\r\n          // ignore\r\n          selected = propValue;\r\n          if (__DEV__) {\r\n            // TODO: Remove support for `selected` in <option>.\r\n            if (!didWarnSelectedSetOnOption) {\r\n              console.error(\r\n                'Use the `defaultValue` or `value` props on <select> instead of ' +\r\n                  'setting `selected` on <option>.',\r\n              );\r\n              didWarnSelectedSetOnOption = true;\r\n            }\r\n          }\r\n          break;\r\n        case 'dangerouslySetInnerHTML':\r\n          innerHTML = propValue;\r\n          break;\r\n        // eslint-disable-next-line-no-fallthrough\r\n        case 'value':\r\n          value = propValue;\r\n        // We intentionally fallthrough to also set the attribute on the node.\r\n        // eslint-disable-next-line-no-fallthrough\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (selectedValue != null) {\r\n    let stringValue;\r\n    if (value !== null) {\r\n      if (__DEV__) {\r\n        checkAttributeStringCoercion(value, 'value');\r\n      }\r\n      stringValue = '' + value;\r\n    } else {\r\n      if (__DEV__) {\r\n        if (innerHTML !== null) {\r\n          if (!didWarnInvalidOptionInnerHTML) {\r\n            didWarnInvalidOptionInnerHTML = true;\r\n            console.error(\r\n              'Pass a `value` prop if you set dangerouslyInnerHTML so React knows ' +\r\n                'which value should be selected.',\r\n            );\r\n          }\r\n        }\r\n      }\r\n      stringValue = flattenOptionChildren(children);\r\n    }\r\n    if (isArray(selectedValue)) {\r\n      // multiple\r\n      for (let i = 0; i < selectedValue.length; i++) {\r\n        if (__DEV__) {\r\n          checkAttributeStringCoercion(selectedValue[i], 'value');\r\n        }\r\n        const v = '' + selectedValue[i];\r\n        if (v === stringValue) {\r\n          target.push(selectedMarkerAttribute);\r\n          break;\r\n        }\r\n      }\r\n    } else {\r\n      if (__DEV__) {\r\n        checkAttributeStringCoercion(selectedValue, 'select.value');\r\n      }\r\n      if ('' + selectedValue === stringValue) {\r\n        target.push(selectedMarkerAttribute);\r\n      }\r\n    }\r\n  } else if (selected) {\r\n    target.push(selectedMarkerAttribute);\r\n  }\r\n\r\n  target.push(endOfStartTag);\r\n  pushInnerHTML(target, innerHTML, children);\r\n  return children;\r\n}\r\n\r\nfunction pushInput(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  if (__DEV__) {\r\n    checkControlledValueProps('input', props);\r\n\r\n    if (\r\n      props.checked !== undefined &&\r\n      props.defaultChecked !== undefined &&\r\n      !didWarnDefaultChecked\r\n    ) {\r\n      console.error(\r\n        '%s contains an input of type %s with both checked and defaultChecked props. ' +\r\n          'Input elements must be either controlled or uncontrolled ' +\r\n          '(specify either the checked prop, or the defaultChecked prop, but not ' +\r\n          'both). Decide between using a controlled or uncontrolled input ' +\r\n          'element and remove one of these props. More info: ' +\r\n          'https://reactjs.org/link/controlled-components',\r\n        'A component',\r\n        props.type,\r\n      );\r\n      didWarnDefaultChecked = true;\r\n    }\r\n    if (\r\n      props.value !== undefined &&\r\n      props.defaultValue !== undefined &&\r\n      !didWarnDefaultInputValue\r\n    ) {\r\n      console.error(\r\n        '%s contains an input of type %s with both value and defaultValue props. ' +\r\n          'Input elements must be either controlled or uncontrolled ' +\r\n          '(specify either the value prop, or the defaultValue prop, but not ' +\r\n          'both). Decide between using a controlled or uncontrolled input ' +\r\n          'element and remove one of these props. More info: ' +\r\n          'https://reactjs.org/link/controlled-components',\r\n        'A component',\r\n        props.type,\r\n      );\r\n      didWarnDefaultInputValue = true;\r\n    }\r\n  }\r\n\r\n  target.push(startChunkForTag('input'));\r\n\r\n  let value = null;\r\n  let defaultValue = null;\r\n  let checked = null;\r\n  let defaultChecked = null;\r\n\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n        case 'dangerouslySetInnerHTML':\r\n          throw new Error(\r\n            `${'input'} is a self-closing tag and must neither have \\`children\\` nor ` +\r\n              'use `dangerouslySetInnerHTML`.',\r\n          );\r\n        // eslint-disable-next-line-no-fallthrough\r\n        case 'defaultChecked':\r\n          defaultChecked = propValue;\r\n          break;\r\n        case 'defaultValue':\r\n          defaultValue = propValue;\r\n          break;\r\n        case 'checked':\r\n          checked = propValue;\r\n          break;\r\n        case 'value':\r\n          value = propValue;\r\n          break;\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (checked !== null) {\r\n    pushAttribute(target, responseState, 'checked', checked);\r\n  } else if (defaultChecked !== null) {\r\n    pushAttribute(target, responseState, 'checked', defaultChecked);\r\n  }\r\n  if (value !== null) {\r\n    pushAttribute(target, responseState, 'value', value);\r\n  } else if (defaultValue !== null) {\r\n    pushAttribute(target, responseState, 'value', defaultValue);\r\n  }\r\n\r\n  target.push(endOfStartTagSelfClosing);\r\n  return null;\r\n}\r\n\r\nfunction pushStartTextArea(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  if (__DEV__) {\r\n    checkControlledValueProps('textarea', props);\r\n    if (\r\n      props.value !== undefined &&\r\n      props.defaultValue !== undefined &&\r\n      !didWarnDefaultTextareaValue\r\n    ) {\r\n      console.error(\r\n        'Textarea elements must be either controlled or uncontrolled ' +\r\n          '(specify either the value prop, or the defaultValue prop, but not ' +\r\n          'both). Decide between using a controlled or uncontrolled textarea ' +\r\n          'and remove one of these props. More info: ' +\r\n          'https://reactjs.org/link/controlled-components',\r\n      );\r\n      didWarnDefaultTextareaValue = true;\r\n    }\r\n  }\r\n\r\n  target.push(startChunkForTag('textarea'));\r\n\r\n  let value = null;\r\n  let defaultValue = null;\r\n  let children = null;\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n          children = propValue;\r\n          break;\r\n        case 'value':\r\n          value = propValue;\r\n          break;\r\n        case 'defaultValue':\r\n          defaultValue = propValue;\r\n          break;\r\n        case 'dangerouslySetInnerHTML':\r\n          throw new Error(\r\n            '`dangerouslySetInnerHTML` does not make sense on <textarea>.',\r\n          );\r\n        // eslint-disable-next-line-no-fallthrough\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n  if (value === null && defaultValue !== null) {\r\n    value = defaultValue;\r\n  }\r\n\r\n  target.push(endOfStartTag);\r\n\r\n  // TODO (yungsters): Remove support for children content in <textarea>.\r\n  if (children != null) {\r\n    if (__DEV__) {\r\n      console.error(\r\n        'Use the `defaultValue` or `value` props instead of setting ' +\r\n          'children on <textarea>.',\r\n      );\r\n    }\r\n\r\n    if (value != null) {\r\n      throw new Error(\r\n        'If you supply `defaultValue` on a <textarea>, do not pass children.',\r\n      );\r\n    }\r\n\r\n    if (isArray(children)) {\r\n      if (children.length > 1) {\r\n        throw new Error('<textarea> can only have at most one child.');\r\n      }\r\n\r\n      // TODO: remove the coercion and the DEV check below because it will\r\n      // always be overwritten by the coercion several lines below it. #22309\r\n      if (__DEV__) {\r\n        checkHtmlStringCoercion(children[0]);\r\n      }\r\n      value = '' + children[0];\r\n    }\r\n    if (__DEV__) {\r\n      checkHtmlStringCoercion(children);\r\n    }\r\n    value = '' + children;\r\n  }\r\n\r\n  if (typeof value === 'string' && value[0] === '\\n') {\r\n    // text/html ignores the first character in these tags if it's a newline\r\n    // Prefer to break application/xml over text/html (for now) by adding\r\n    // a newline specifically to get eaten by the parser. (Alternately for\r\n    // textareas, replacing \"^\\n\" with \"\\r\\n\" doesn't get eaten, and the first\r\n    // \\r is normalized out by HTMLTextAreaElement#value.)\r\n    // See: <http://www.w3.org/TR/html-polyglot/#newlines-in-textarea-and-pre>\r\n    // See: <http://www.w3.org/TR/html5/syntax.html#element-restrictions>\r\n    // See: <http://www.w3.org/TR/html5/syntax.html#newlines>\r\n    // See: Parsing of \"textarea\" \"listing\" and \"pre\" elements\r\n    //  from <http://www.w3.org/TR/html5/syntax.html#parsing-main-inbody>\r\n    target.push(leadingNewline);\r\n  }\r\n\r\n  // ToString and push directly instead of recurse over children.\r\n  // We don't really support complex children in the value anyway.\r\n  // This also currently avoids a trailing comment node which breaks textarea.\r\n  if (value !== null) {\r\n    if (__DEV__) {\r\n      checkAttributeStringCoercion(value, 'value');\r\n    }\r\n    target.push(stringToChunk(encodeHTMLTextNode('' + value)));\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nfunction pushSelfClosing(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  tag: string,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  target.push(startChunkForTag(tag));\r\n\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n        case 'dangerouslySetInnerHTML':\r\n          throw new Error(\r\n            `${tag} is a self-closing tag and must neither have \\`children\\` nor ` +\r\n              'use `dangerouslySetInnerHTML`.',\r\n          );\r\n        // eslint-disable-next-line-no-fallthrough\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  target.push(endOfStartTagSelfClosing);\r\n  return null;\r\n}\r\n\r\nfunction pushStartMenuItem(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  target.push(startChunkForTag('menuitem'));\r\n\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n        case 'dangerouslySetInnerHTML':\r\n          throw new Error(\r\n            'menuitems cannot have `children` nor `dangerouslySetInnerHTML`.',\r\n          );\r\n        // eslint-disable-next-line-no-fallthrough\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  target.push(endOfStartTag);\r\n  return null;\r\n}\r\n\r\nfunction pushStartTitle(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  target.push(startChunkForTag('title'));\r\n\r\n  let children = null;\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n          children = propValue;\r\n          break;\r\n        case 'dangerouslySetInnerHTML':\r\n          throw new Error(\r\n            '`dangerouslySetInnerHTML` does not make sense on <title>.',\r\n          );\r\n        // eslint-disable-next-line-no-fallthrough\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n  target.push(endOfStartTag);\r\n\r\n  if (__DEV__) {\r\n    const child =\r\n      Array.isArray(children) && children.length < 2\r\n        ? children[0] || null\r\n        : children;\r\n    if (Array.isArray(children) && children.length > 1) {\r\n      console.error(\r\n        'A title element received an array with more than 1 element as children. ' +\r\n          'In browsers title Elements can only have Text Nodes as children. If ' +\r\n          'the children being rendered output more than a single text node in aggregate the browser ' +\r\n          'will display markup and comments as text in the title and hydration will likely fail and ' +\r\n          'fall back to client rendering',\r\n      );\r\n    } else if (child != null && child.$$typeof != null) {\r\n      console.error(\r\n        'A title element received a React element for children. ' +\r\n          'In the browser title Elements can only have Text Nodes as children. If ' +\r\n          'the children being rendered output more than a single text node in aggregate the browser ' +\r\n          'will display markup and comments as text in the title and hydration will likely fail and ' +\r\n          'fall back to client rendering',\r\n      );\r\n    } else if (\r\n      child != null &&\r\n      typeof child !== 'string' &&\r\n      typeof child !== 'number'\r\n    ) {\r\n      console.error(\r\n        'A title element received a value that was not a string or number for children. ' +\r\n          'In the browser title Elements can only have Text Nodes as children. If ' +\r\n          'the children being rendered output more than a single text node in aggregate the browser ' +\r\n          'will display markup and comments as text in the title and hydration will likely fail and ' +\r\n          'fall back to client rendering',\r\n      );\r\n    }\r\n  }\r\n  return children;\r\n}\r\n\r\nfunction pushStartGenericElement(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  tag: string,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  target.push(startChunkForTag(tag));\r\n\r\n  let children = null;\r\n  let innerHTML = null;\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n          children = propValue;\r\n          break;\r\n        case 'dangerouslySetInnerHTML':\r\n          innerHTML = propValue;\r\n          break;\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  target.push(endOfStartTag);\r\n  pushInnerHTML(target, innerHTML, children);\r\n  if (typeof children === 'string') {\r\n    // Special case children as a string to avoid the unnecessary comment.\r\n    // TODO: Remove this special case after the general optimization is in place.\r\n    target.push(stringToChunk(encodeHTMLTextNode(children)));\r\n    return null;\r\n  }\r\n  return children;\r\n}\r\n\r\nfunction pushStartCustomElement(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  tag: string,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  target.push(startChunkForTag(tag));\r\n\r\n  let children = null;\r\n  let innerHTML = null;\r\n  for (let propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      let propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      if (\r\n        enableCustomElementPropertySupport &&\r\n        (typeof propValue === 'function' || typeof propValue === 'object')\r\n      ) {\r\n        // It is normal to render functions and objects on custom elements when\r\n        // client rendering, but when server rendering the output isn't useful,\r\n        // so skip it.\r\n        continue;\r\n      }\r\n      if (enableCustomElementPropertySupport && propValue === false) {\r\n        continue;\r\n      }\r\n      if (enableCustomElementPropertySupport && propValue === true) {\r\n        propValue = '';\r\n      }\r\n      if (enableCustomElementPropertySupport && propKey === 'className') {\r\n        // className gets rendered as class on the client, so it should be\r\n        // rendered as class on the server.\r\n        propKey = 'class';\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n          children = propValue;\r\n          break;\r\n        case 'dangerouslySetInnerHTML':\r\n          innerHTML = propValue;\r\n          break;\r\n        case 'style':\r\n          pushStyle(target, responseState, propValue);\r\n          break;\r\n        case 'suppressContentEditableWarning':\r\n        case 'suppressHydrationWarning':\r\n          // Ignored. These are built-in to React on the client.\r\n          break;\r\n        default:\r\n          if (\r\n            isAttributeNameSafe(propKey) &&\r\n            typeof propValue !== 'function' &&\r\n            typeof propValue !== 'symbol'\r\n          ) {\r\n            target.push(\r\n              attributeSeparator,\r\n              stringToChunk(propKey),\r\n              attributeAssign,\r\n              stringToChunk(escapeTextForBrowser(propValue)),\r\n              attributeEnd,\r\n            );\r\n          }\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  target.push(endOfStartTag);\r\n  pushInnerHTML(target, innerHTML, children);\r\n  return children;\r\n}\r\n\r\nconst leadingNewline = stringToPrecomputedChunk('\\n');\r\n\r\nfunction pushStartPreformattedElement(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  props: Object,\r\n  tag: string,\r\n  responseState: ResponseState,\r\n): ReactNodeList {\r\n  target.push(startChunkForTag(tag));\r\n\r\n  let children = null;\r\n  let innerHTML = null;\r\n  for (const propKey in props) {\r\n    if (hasOwnProperty.call(props, propKey)) {\r\n      const propValue = props[propKey];\r\n      if (propValue == null) {\r\n        continue;\r\n      }\r\n      switch (propKey) {\r\n        case 'children':\r\n          children = propValue;\r\n          break;\r\n        case 'dangerouslySetInnerHTML':\r\n          innerHTML = propValue;\r\n          break;\r\n        default:\r\n          pushAttribute(target, responseState, propKey, propValue);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  target.push(endOfStartTag);\r\n\r\n  // text/html ignores the first character in these tags if it's a newline\r\n  // Prefer to break application/xml over text/html (for now) by adding\r\n  // a newline specifically to get eaten by the parser. (Alternately for\r\n  // textareas, replacing \"^\\n\" with \"\\r\\n\" doesn't get eaten, and the first\r\n  // \\r is normalized out by HTMLTextAreaElement#value.)\r\n  // See: <http://www.w3.org/TR/html-polyglot/#newlines-in-textarea-and-pre>\r\n  // See: <http://www.w3.org/TR/html5/syntax.html#element-restrictions>\r\n  // See: <http://www.w3.org/TR/html5/syntax.html#newlines>\r\n  // See: Parsing of \"textarea\" \"listing\" and \"pre\" elements\r\n  //  from <http://www.w3.org/TR/html5/syntax.html#parsing-main-inbody>\r\n  // TODO: This doesn't deal with the case where the child is an array\r\n  // or component that returns a string.\r\n  if (innerHTML != null) {\r\n    if (children != null) {\r\n      throw new Error(\r\n        'Can only set one of `children` or `props.dangerouslySetInnerHTML`.',\r\n      );\r\n    }\r\n\r\n    if (typeof innerHTML !== 'object' || !('__html' in innerHTML)) {\r\n      throw new Error(\r\n        '`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. ' +\r\n          'Please visit https://reactjs.org/link/dangerously-set-inner-html ' +\r\n          'for more information.',\r\n      );\r\n    }\r\n\r\n    const html = innerHTML.__html;\r\n    if (html !== null && html !== undefined) {\r\n      if (typeof html === 'string' && html.length > 0 && html[0] === '\\n') {\r\n        target.push(leadingNewline, stringToChunk(html));\r\n      } else {\r\n        if (__DEV__) {\r\n          checkHtmlStringCoercion(html);\r\n        }\r\n        target.push(stringToChunk('' + html));\r\n      }\r\n    }\r\n  }\r\n  if (typeof children === 'string' && children[0] === '\\n') {\r\n    target.push(leadingNewline);\r\n  }\r\n  return children;\r\n}\r\n\r\n// We accept any tag to be rendered but since this gets injected into arbitrary\r\n// HTML, we want to make sure that it's a safe tag.\r\n// http://www.w3.org/TR/REC-xml/#NT-Name\r\nconst VALID_TAG_REGEX = /^[a-zA-Z][a-zA-Z:_\\.\\-\\d]*$/; // Simplified subset\r\nconst validatedTagCache = new Map();\r\nfunction startChunkForTag(tag: string): PrecomputedChunk {\r\n  let tagStartChunk = validatedTagCache.get(tag);\r\n  if (tagStartChunk === undefined) {\r\n    if (!VALID_TAG_REGEX.test(tag)) {\r\n      throw new Error(`Invalid tag: ${tag}`);\r\n    }\r\n\r\n    tagStartChunk = stringToPrecomputedChunk('<' + tag);\r\n    validatedTagCache.set(tag, tagStartChunk);\r\n  }\r\n  return tagStartChunk;\r\n}\r\n\r\nconst DOCTYPE: PrecomputedChunk = stringToPrecomputedChunk('<!DOCTYPE html>');\r\n\r\nexport function pushStartInstance(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  type: string,\r\n  props: Object,\r\n  responseState: ResponseState,\r\n  formatContext: FormatContext,\r\n): ReactNodeList {\r\n  if (__DEV__) {\r\n    validateARIAProperties(type, props);\r\n    validateInputProperties(type, props);\r\n    validateUnknownProperties(type, props, null);\r\n\r\n    if (\r\n      !props.suppressContentEditableWarning &&\r\n      props.contentEditable &&\r\n      props.children != null\r\n    ) {\r\n      console.error(\r\n        'A component is `contentEditable` and contains `children` managed by ' +\r\n          'React. It is now your responsibility to guarantee that none of ' +\r\n          'those nodes are unexpectedly modified or duplicated. This is ' +\r\n          'probably not intentional.',\r\n      );\r\n    }\r\n\r\n    if (\r\n      formatContext.insertionMode !== SVG_MODE &&\r\n      formatContext.insertionMode !== MATHML_MODE\r\n    ) {\r\n      if (\r\n        type.indexOf('-') === -1 &&\r\n        typeof props.is !== 'string' &&\r\n        type.toLowerCase() !== type\r\n      ) {\r\n        console.error(\r\n          '<%s /> is using incorrect casing. ' +\r\n            'Use PascalCase for React components, ' +\r\n            'or lowercase for HTML elements.',\r\n          type,\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  switch (type) {\r\n    // Special tags\r\n    case 'select':\r\n      return pushStartSelect(target, props, responseState);\r\n    case 'option':\r\n      return pushStartOption(target, props, responseState, formatContext);\r\n    case 'textarea':\r\n      return pushStartTextArea(target, props, responseState);\r\n    case 'input':\r\n      return pushInput(target, props, responseState);\r\n    case 'menuitem':\r\n      return pushStartMenuItem(target, props, responseState);\r\n    case 'title':\r\n      return pushStartTitle(target, props, responseState);\r\n    // Newline eating tags\r\n    case 'listing':\r\n    case 'pre': {\r\n      return pushStartPreformattedElement(target, props, type, responseState);\r\n    }\r\n    // Omitted close tags\r\n    case 'area':\r\n    case 'base':\r\n    case 'br':\r\n    case 'col':\r\n    case 'embed':\r\n    case 'hr':\r\n    case 'img':\r\n    case 'keygen':\r\n    case 'link':\r\n    case 'meta':\r\n    case 'param':\r\n    case 'source':\r\n    case 'track':\r\n    case 'wbr': {\r\n      return pushSelfClosing(target, props, type, responseState);\r\n    }\r\n    // These are reserved SVG and MathML elements, that are never custom elements.\r\n    // https://w3c.github.io/webcomponents/spec/custom/#custom-elements-core-concepts\r\n    case 'annotation-xml':\r\n    case 'color-profile':\r\n    case 'font-face':\r\n    case 'font-face-src':\r\n    case 'font-face-uri':\r\n    case 'font-face-format':\r\n    case 'font-face-name':\r\n    case 'missing-glyph': {\r\n      return pushStartGenericElement(target, props, type, responseState);\r\n    }\r\n    case 'html': {\r\n      if (formatContext.insertionMode === ROOT_HTML_MODE) {\r\n        // If we're rendering the html tag and we're at the root (i.e. not in foreignObject)\r\n        // then we also emit the DOCTYPE as part of the root content as a convenience for\r\n        // rendering the whole document.\r\n        target.push(DOCTYPE);\r\n      }\r\n      return pushStartGenericElement(target, props, type, responseState);\r\n    }\r\n    default: {\r\n      if (type.indexOf('-') === -1 && typeof props.is !== 'string') {\r\n        // Generic element\r\n        return pushStartGenericElement(target, props, type, responseState);\r\n      } else {\r\n        // Custom element\r\n        return pushStartCustomElement(target, props, type, responseState);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst endTag1 = stringToPrecomputedChunk('</');\r\nconst endTag2 = stringToPrecomputedChunk('>');\r\n\r\nexport function pushEndInstance(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n  type: string,\r\n  props: Object,\r\n): void {\r\n  switch (type) {\r\n    // Omitted close tags\r\n    // TODO: Instead of repeating this switch we could try to pass a flag from above.\r\n    // That would require returning a tuple. Which might be ok if it gets inlined.\r\n    case 'area':\r\n    case 'base':\r\n    case 'br':\r\n    case 'col':\r\n    case 'embed':\r\n    case 'hr':\r\n    case 'img':\r\n    case 'input':\r\n    case 'keygen':\r\n    case 'link':\r\n    case 'meta':\r\n    case 'param':\r\n    case 'source':\r\n    case 'track':\r\n    case 'wbr': {\r\n      // No close tag needed.\r\n      break;\r\n    }\r\n    default: {\r\n      target.push(endTag1, stringToChunk(type), endTag2);\r\n    }\r\n  }\r\n}\r\n\r\nexport function writeCompletedRoot(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n): boolean {\r\n  const bootstrapChunks = responseState.bootstrapChunks;\r\n  let i = 0;\r\n  for (; i < bootstrapChunks.length - 1; i++) {\r\n    writeChunk(destination, bootstrapChunks[i]);\r\n  }\r\n  if (i < bootstrapChunks.length) {\r\n    return writeChunkAndReturn(destination, bootstrapChunks[i]);\r\n  }\r\n  return true;\r\n}\r\n\r\n// Structural Nodes\r\n\r\n// A placeholder is a node inside a hidden partial tree that can be filled in later, but before\r\n// display. It's never visible to users. We use the template tag because it can be used in every\r\n// type of parent. <script> tags also work in every other tag except <colgroup>.\r\nconst placeholder1 = stringToPrecomputedChunk('<template id=\"');\r\nconst placeholder2 = stringToPrecomputedChunk('\"></template>');\r\nexport function writePlaceholder(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n  id: number,\r\n): boolean {\r\n  writeChunk(destination, placeholder1);\r\n  writeChunk(destination, responseState.placeholderPrefix);\r\n  const formattedID = stringToChunk(id.toString(16));\r\n  writeChunk(destination, formattedID);\r\n  return writeChunkAndReturn(destination, placeholder2);\r\n}\r\n\r\n// Suspense boundaries are encoded as comments.\r\nconst startCompletedSuspenseBoundary = stringToPrecomputedChunk('<!--$-->');\r\nconst startPendingSuspenseBoundary1 = stringToPrecomputedChunk(\r\n  '<!--$?--><template id=\"',\r\n);\r\nconst startPendingSuspenseBoundary2 = stringToPrecomputedChunk('\"></template>');\r\nconst startClientRenderedSuspenseBoundary = stringToPrecomputedChunk(\r\n  '<!--$!-->',\r\n);\r\nconst endSuspenseBoundary = stringToPrecomputedChunk('<!--/$-->');\r\n\r\nconst clientRenderedSuspenseBoundaryError1 = stringToPrecomputedChunk(\r\n  '<template',\r\n);\r\nconst clientRenderedSuspenseBoundaryErrorAttrInterstitial = stringToPrecomputedChunk(\r\n  '\"',\r\n);\r\nconst clientRenderedSuspenseBoundaryError1A = stringToPrecomputedChunk(\r\n  ' data-dgst=\"',\r\n);\r\nconst clientRenderedSuspenseBoundaryError1B = stringToPrecomputedChunk(\r\n  ' data-msg=\"',\r\n);\r\nconst clientRenderedSuspenseBoundaryError1C = stringToPrecomputedChunk(\r\n  ' data-stck=\"',\r\n);\r\nconst clientRenderedSuspenseBoundaryError2 = stringToPrecomputedChunk(\r\n  '></template>',\r\n);\r\n\r\nexport function pushStartCompletedSuspenseBoundary(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n) {\r\n  target.push(startCompletedSuspenseBoundary);\r\n}\r\n\r\nexport function pushEndCompletedSuspenseBoundary(\r\n  target: Array<Chunk | PrecomputedChunk>,\r\n) {\r\n  target.push(endSuspenseBoundary);\r\n}\r\n\r\nexport function writeStartCompletedSuspenseBoundary(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n): boolean {\r\n  return writeChunkAndReturn(destination, startCompletedSuspenseBoundary);\r\n}\r\nexport function writeStartPendingSuspenseBoundary(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n  id: SuspenseBoundaryID,\r\n): boolean {\r\n  writeChunk(destination, startPendingSuspenseBoundary1);\r\n\r\n  if (id === null) {\r\n    throw new Error(\r\n      'An ID must have been assigned before we can complete the boundary.',\r\n    );\r\n  }\r\n\r\n  writeChunk(destination, id);\r\n  return writeChunkAndReturn(destination, startPendingSuspenseBoundary2);\r\n}\r\nexport function writeStartClientRenderedSuspenseBoundary(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n  errorDigest: ?string,\r\n  errorMesssage: ?string,\r\n  errorComponentStack: ?string,\r\n): boolean {\r\n  let result;\r\n  result = writeChunkAndReturn(\r\n    destination,\r\n    startClientRenderedSuspenseBoundary,\r\n  );\r\n  writeChunk(destination, clientRenderedSuspenseBoundaryError1);\r\n  if (errorDigest) {\r\n    writeChunk(destination, clientRenderedSuspenseBoundaryError1A);\r\n    writeChunk(destination, stringToChunk(escapeTextForBrowser(errorDigest)));\r\n    writeChunk(\r\n      destination,\r\n      clientRenderedSuspenseBoundaryErrorAttrInterstitial,\r\n    );\r\n  }\r\n  if (__DEV__) {\r\n    if (errorMesssage) {\r\n      writeChunk(destination, clientRenderedSuspenseBoundaryError1B);\r\n      writeChunk(\r\n        destination,\r\n        stringToChunk(escapeTextForBrowser(errorMesssage)),\r\n      );\r\n      writeChunk(\r\n        destination,\r\n        clientRenderedSuspenseBoundaryErrorAttrInterstitial,\r\n      );\r\n    }\r\n    if (errorComponentStack) {\r\n      writeChunk(destination, clientRenderedSuspenseBoundaryError1C);\r\n      writeChunk(\r\n        destination,\r\n        stringToChunk(escapeTextForBrowser(errorComponentStack)),\r\n      );\r\n      writeChunk(\r\n        destination,\r\n        clientRenderedSuspenseBoundaryErrorAttrInterstitial,\r\n      );\r\n    }\r\n  }\r\n  result = writeChunkAndReturn(\r\n    destination,\r\n    clientRenderedSuspenseBoundaryError2,\r\n  );\r\n  return result;\r\n}\r\nexport function writeEndCompletedSuspenseBoundary(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n): boolean {\r\n  return writeChunkAndReturn(destination, endSuspenseBoundary);\r\n}\r\nexport function writeEndPendingSuspenseBoundary(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n): boolean {\r\n  return writeChunkAndReturn(destination, endSuspenseBoundary);\r\n}\r\nexport function writeEndClientRenderedSuspenseBoundary(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n): boolean {\r\n  return writeChunkAndReturn(destination, endSuspenseBoundary);\r\n}\r\n\r\nconst startSegmentHTML = stringToPrecomputedChunk('<div hidden id=\"');\r\nconst startSegmentHTML2 = stringToPrecomputedChunk('\">');\r\nconst endSegmentHTML = stringToPrecomputedChunk('</div>');\r\n\r\nconst startSegmentSVG = stringToPrecomputedChunk(\r\n  '<svg aria-hidden=\"true\" style=\"display:none\" id=\"',\r\n);\r\nconst startSegmentSVG2 = stringToPrecomputedChunk('\">');\r\nconst endSegmentSVG = stringToPrecomputedChunk('</svg>');\r\n\r\nconst startSegmentMathML = stringToPrecomputedChunk(\r\n  '<math aria-hidden=\"true\" style=\"display:none\" id=\"',\r\n);\r\nconst startSegmentMathML2 = stringToPrecomputedChunk('\">');\r\nconst endSegmentMathML = stringToPrecomputedChunk('</math>');\r\n\r\nconst startSegmentTable = stringToPrecomputedChunk('<table hidden id=\"');\r\nconst startSegmentTable2 = stringToPrecomputedChunk('\">');\r\nconst endSegmentTable = stringToPrecomputedChunk('</table>');\r\n\r\nconst startSegmentTableBody = stringToPrecomputedChunk(\r\n  '<table hidden><tbody id=\"',\r\n);\r\nconst startSegmentTableBody2 = stringToPrecomputedChunk('\">');\r\nconst endSegmentTableBody = stringToPrecomputedChunk('</tbody></table>');\r\n\r\nconst startSegmentTableRow = stringToPrecomputedChunk('<table hidden><tr id=\"');\r\nconst startSegmentTableRow2 = stringToPrecomputedChunk('\">');\r\nconst endSegmentTableRow = stringToPrecomputedChunk('</tr></table>');\r\n\r\nconst startSegmentColGroup = stringToPrecomputedChunk(\r\n  '<table hidden><colgroup id=\"',\r\n);\r\nconst startSegmentColGroup2 = stringToPrecomputedChunk('\">');\r\nconst endSegmentColGroup = stringToPrecomputedChunk('</colgroup></table>');\r\n\r\nexport function writeStartSegment(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n  formatContext: FormatContext,\r\n  id: number,\r\n): boolean {\r\n  switch (formatContext.insertionMode) {\r\n    case ROOT_HTML_MODE:\r\n    case HTML_MODE: {\r\n      writeChunk(destination, startSegmentHTML);\r\n      writeChunk(destination, responseState.segmentPrefix);\r\n      writeChunk(destination, stringToChunk(id.toString(16)));\r\n      return writeChunkAndReturn(destination, startSegmentHTML2);\r\n    }\r\n    case SVG_MODE: {\r\n      writeChunk(destination, startSegmentSVG);\r\n      writeChunk(destination, responseState.segmentPrefix);\r\n      writeChunk(destination, stringToChunk(id.toString(16)));\r\n      return writeChunkAndReturn(destination, startSegmentSVG2);\r\n    }\r\n    case MATHML_MODE: {\r\n      writeChunk(destination, startSegmentMathML);\r\n      writeChunk(destination, responseState.segmentPrefix);\r\n      writeChunk(destination, stringToChunk(id.toString(16)));\r\n      return writeChunkAndReturn(destination, startSegmentMathML2);\r\n    }\r\n    case HTML_TABLE_MODE: {\r\n      writeChunk(destination, startSegmentTable);\r\n      writeChunk(destination, responseState.segmentPrefix);\r\n      writeChunk(destination, stringToChunk(id.toString(16)));\r\n      return writeChunkAndReturn(destination, startSegmentTable2);\r\n    }\r\n    // TODO: For the rest of these, there will be extra wrapper nodes that never\r\n    // get deleted from the document. We need to delete the table too as part\r\n    // of the injected scripts. They are invisible though so it's not too terrible\r\n    // and it's kind of an edge case to suspend in a table. Totally supported though.\r\n    case HTML_TABLE_BODY_MODE: {\r\n      writeChunk(destination, startSegmentTableBody);\r\n      writeChunk(destination, responseState.segmentPrefix);\r\n      writeChunk(destination, stringToChunk(id.toString(16)));\r\n      return writeChunkAndReturn(destination, startSegmentTableBody2);\r\n    }\r\n    case HTML_TABLE_ROW_MODE: {\r\n      writeChunk(destination, startSegmentTableRow);\r\n      writeChunk(destination, responseState.segmentPrefix);\r\n      writeChunk(destination, stringToChunk(id.toString(16)));\r\n      return writeChunkAndReturn(destination, startSegmentTableRow2);\r\n    }\r\n    case HTML_COLGROUP_MODE: {\r\n      writeChunk(destination, startSegmentColGroup);\r\n      writeChunk(destination, responseState.segmentPrefix);\r\n      writeChunk(destination, stringToChunk(id.toString(16)));\r\n      return writeChunkAndReturn(destination, startSegmentColGroup2);\r\n    }\r\n    default: {\r\n      throw new Error('Unknown insertion mode. This is a bug in React.');\r\n    }\r\n  }\r\n}\r\nexport function writeEndSegment(\r\n  destination: Destination,\r\n  formatContext: FormatContext,\r\n): boolean {\r\n  switch (formatContext.insertionMode) {\r\n    case ROOT_HTML_MODE:\r\n    case HTML_MODE: {\r\n      return writeChunkAndReturn(destination, endSegmentHTML);\r\n    }\r\n    case SVG_MODE: {\r\n      return writeChunkAndReturn(destination, endSegmentSVG);\r\n    }\r\n    case MATHML_MODE: {\r\n      return writeChunkAndReturn(destination, endSegmentMathML);\r\n    }\r\n    case HTML_TABLE_MODE: {\r\n      return writeChunkAndReturn(destination, endSegmentTable);\r\n    }\r\n    case HTML_TABLE_BODY_MODE: {\r\n      return writeChunkAndReturn(destination, endSegmentTableBody);\r\n    }\r\n    case HTML_TABLE_ROW_MODE: {\r\n      return writeChunkAndReturn(destination, endSegmentTableRow);\r\n    }\r\n    case HTML_COLGROUP_MODE: {\r\n      return writeChunkAndReturn(destination, endSegmentColGroup);\r\n    }\r\n    default: {\r\n      throw new Error('Unknown insertion mode. This is a bug in React.');\r\n    }\r\n  }\r\n}\r\n\r\n// Instruction Set\r\n\r\n// The following code is the source scripts that we then minify and inline below,\r\n// with renamed function names that we hope don't collide:\r\n\r\n// const COMMENT_NODE = 8;\r\n// const SUSPENSE_START_DATA = '$';\r\n// const SUSPENSE_END_DATA = '/$';\r\n// const SUSPENSE_PENDING_START_DATA = '$?';\r\n// const SUSPENSE_FALLBACK_START_DATA = '$!';\r\n//\r\n// function clientRenderBoundary(suspenseBoundaryID, errorDigest, errorMsg, errorComponentStack) {\r\n//   // Find the fallback's first element.\r\n//   const suspenseIdNode = document.getElementById(suspenseBoundaryID);\r\n//   if (!suspenseIdNode) {\r\n//     // The user must have already navigated away from this tree.\r\n//     // E.g. because the parent was hydrated.\r\n//     return;\r\n//   }\r\n//   // Find the boundary around the fallback. This is always the previous node.\r\n//   const suspenseNode = suspenseIdNode.previousSibling;\r\n//   // Tag it to be client rendered.\r\n//   suspenseNode.data = SUSPENSE_FALLBACK_START_DATA;\r\n//   // assign error metadata to first sibling\r\n//   let dataset = suspenseIdNode.dataset;\r\n//   if (errorDigest) dataset.dgst = errorDigest;\r\n//   if (errorMsg) dataset.msg = errorMsg;\r\n//   if (errorComponentStack) dataset.stck = errorComponentStack;\r\n//   // Tell React to retry it if the parent already hydrated.\r\n//   if (suspenseNode._reactRetry) {\r\n//     suspenseNode._reactRetry();\r\n//   }\r\n// }\r\n//\r\n// function completeBoundary(suspenseBoundaryID, contentID) {\r\n//   // Find the fallback's first element.\r\n//   const suspenseIdNode = document.getElementById(suspenseBoundaryID);\r\n//   const contentNode = document.getElementById(contentID);\r\n//   // We'll detach the content node so that regardless of what happens next we don't leave in the tree.\r\n//   // This might also help by not causing recalcing each time we move a child from here to the target.\r\n//   contentNode.parentNode.removeChild(contentNode);\r\n//   if (!suspenseIdNode) {\r\n//     // The user must have already navigated away from this tree.\r\n//     // E.g. because the parent was hydrated. That's fine there's nothing to do\r\n//     // but we have to make sure that we already deleted the container node.\r\n//     return;\r\n//   }\r\n//   // Find the boundary around the fallback. This is always the previous node.\r\n//   const suspenseNode = suspenseIdNode.previousSibling;\r\n//\r\n//   // Clear all the existing children. This is complicated because\r\n//   // there can be embedded Suspense boundaries in the fallback.\r\n//   // This is similar to clearSuspenseBoundary in ReactDOMHostConfig.\r\n//   // TODO: We could avoid this if we never emitted suspense boundaries in fallback trees.\r\n//   // They never hydrate anyway. However, currently we support incrementally loading the fallback.\r\n//   const parentInstance = suspenseNode.parentNode;\r\n//   let node = suspenseNode.nextSibling;\r\n//   let depth = 0;\r\n//   do {\r\n//     if (node && node.nodeType === COMMENT_NODE) {\r\n//       const data = node.data;\r\n//       if (data === SUSPENSE_END_DATA) {\r\n//         if (depth === 0) {\r\n//           break;\r\n//         } else {\r\n//           depth--;\r\n//         }\r\n//       } else if (\r\n//         data === SUSPENSE_START_DATA ||\r\n//         data === SUSPENSE_PENDING_START_DATA ||\r\n//         data === SUSPENSE_FALLBACK_START_DATA\r\n//       ) {\r\n//         depth++;\r\n//       }\r\n//     }\r\n//\r\n//     const nextNode = node.nextSibling;\r\n//     parentInstance.removeChild(node);\r\n//     node = nextNode;\r\n//   } while (node);\r\n//\r\n//   const endOfBoundary = node;\r\n//\r\n//   // Insert all the children from the contentNode between the start and end of suspense boundary.\r\n//   while (contentNode.firstChild) {\r\n//     parentInstance.insertBefore(contentNode.firstChild, endOfBoundary);\r\n//   }\r\n\r\n//   suspenseNode.data = SUSPENSE_START_DATA;\r\n//   if (suspenseNode._reactRetry) {\r\n//     suspenseNode._reactRetry();\r\n//   }\r\n// }\r\n//\r\n// function completeSegment(containerID, placeholderID) {\r\n//   const segmentContainer = document.getElementById(containerID);\r\n//   const placeholderNode = document.getElementById(placeholderID);\r\n//   // We always expect both nodes to exist here because, while we might\r\n//   // have navigated away from the main tree, we still expect the detached\r\n//   // tree to exist.\r\n//   segmentContainer.parentNode.removeChild(segmentContainer);\r\n//   while (segmentContainer.firstChild) {\r\n//     placeholderNode.parentNode.insertBefore(\r\n//       segmentContainer.firstChild,\r\n//       placeholderNode,\r\n//     );\r\n//   }\r\n//   placeholderNode.parentNode.removeChild(placeholderNode);\r\n// }\r\n\r\nconst completeSegmentFunction =\r\n  'function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)}';\r\nconst completeBoundaryFunction =\r\n  'function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if(\"/$\"===d)if(0===e)break;else e--;else\"$\"!==d&&\"$?\"!==d&&\"$!\"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data=\"$\";a._reactRetry&&a._reactRetry()}}';\r\nconst clientRenderFunction =\r\n  'function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data=\"$!\",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())}';\r\n\r\nconst completeSegmentScript1Full = stringToPrecomputedChunk(\r\n  completeSegmentFunction + ';$RS(\"',\r\n);\r\nconst completeSegmentScript1Partial = stringToPrecomputedChunk('$RS(\"');\r\nconst completeSegmentScript2 = stringToPrecomputedChunk('\",\"');\r\nconst completeSegmentScript3 = stringToPrecomputedChunk('\")</script>');\r\n\r\nexport function writeCompletedSegmentInstruction(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n  contentSegmentID: number,\r\n): boolean {\r\n  writeChunk(destination, responseState.startInlineScript);\r\n  if (!responseState.sentCompleteSegmentFunction) {\r\n    // The first time we write this, we'll need to include the full implementation.\r\n    responseState.sentCompleteSegmentFunction = true;\r\n    writeChunk(destination, completeSegmentScript1Full);\r\n  } else {\r\n    // Future calls can just reuse the same function.\r\n    writeChunk(destination, completeSegmentScript1Partial);\r\n  }\r\n  writeChunk(destination, responseState.segmentPrefix);\r\n  const formattedID = stringToChunk(contentSegmentID.toString(16));\r\n  writeChunk(destination, formattedID);\r\n  writeChunk(destination, completeSegmentScript2);\r\n  writeChunk(destination, responseState.placeholderPrefix);\r\n  writeChunk(destination, formattedID);\r\n  return writeChunkAndReturn(destination, completeSegmentScript3);\r\n}\r\n\r\nconst completeBoundaryScript1Full = stringToPrecomputedChunk(\r\n  completeBoundaryFunction + ';$RC(\"',\r\n);\r\nconst completeBoundaryScript1Partial = stringToPrecomputedChunk('$RC(\"');\r\nconst completeBoundaryScript2 = stringToPrecomputedChunk('\",\"');\r\nconst completeBoundaryScript3 = stringToPrecomputedChunk('\")</script>');\r\n\r\nexport function writeCompletedBoundaryInstruction(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n  boundaryID: SuspenseBoundaryID,\r\n  contentSegmentID: number,\r\n): boolean {\r\n  writeChunk(destination, responseState.startInlineScript);\r\n  if (!responseState.sentCompleteBoundaryFunction) {\r\n    // The first time we write this, we'll need to include the full implementation.\r\n    responseState.sentCompleteBoundaryFunction = true;\r\n    writeChunk(destination, completeBoundaryScript1Full);\r\n  } else {\r\n    // Future calls can just reuse the same function.\r\n    writeChunk(destination, completeBoundaryScript1Partial);\r\n  }\r\n\r\n  if (boundaryID === null) {\r\n    throw new Error(\r\n      'An ID must have been assigned before we can complete the boundary.',\r\n    );\r\n  }\r\n\r\n  const formattedContentID = stringToChunk(contentSegmentID.toString(16));\r\n  writeChunk(destination, boundaryID);\r\n  writeChunk(destination, completeBoundaryScript2);\r\n  writeChunk(destination, responseState.segmentPrefix);\r\n  writeChunk(destination, formattedContentID);\r\n  return writeChunkAndReturn(destination, completeBoundaryScript3);\r\n}\r\n\r\nconst clientRenderScript1Full = stringToPrecomputedChunk(\r\n  clientRenderFunction + ';$RX(\"',\r\n);\r\nconst clientRenderScript1Partial = stringToPrecomputedChunk('$RX(\"');\r\nconst clientRenderScript1A = stringToPrecomputedChunk('\"');\r\nconst clientRenderScript2 = stringToPrecomputedChunk(')</script>');\r\nconst clientRenderErrorScriptArgInterstitial = stringToPrecomputedChunk(',');\r\n\r\nexport function writeClientRenderBoundaryInstruction(\r\n  destination: Destination,\r\n  responseState: ResponseState,\r\n  boundaryID: SuspenseBoundaryID,\r\n  errorDigest: ?string,\r\n  errorMessage?: string,\r\n  errorComponentStack?: string,\r\n): boolean {\r\n  writeChunk(destination, responseState.startInlineScript);\r\n  if (!responseState.sentClientRenderFunction) {\r\n    // The first time we write this, we'll need to include the full implementation.\r\n    responseState.sentClientRenderFunction = true;\r\n    writeChunk(destination, clientRenderScript1Full);\r\n  } else {\r\n    // Future calls can just reuse the same function.\r\n    writeChunk(destination, clientRenderScript1Partial);\r\n  }\r\n\r\n  if (boundaryID === null) {\r\n    throw new Error(\r\n      'An ID must have been assigned before we can complete the boundary.',\r\n    );\r\n  }\r\n\r\n  writeChunk(destination, boundaryID);\r\n  writeChunk(destination, clientRenderScript1A);\r\n  if (errorDigest || errorMessage || errorComponentStack) {\r\n    writeChunk(destination, clientRenderErrorScriptArgInterstitial);\r\n    writeChunk(\r\n      destination,\r\n      stringToChunk(escapeJSStringsForInstructionScripts(errorDigest || '')),\r\n    );\r\n  }\r\n  if (errorMessage || errorComponentStack) {\r\n    writeChunk(destination, clientRenderErrorScriptArgInterstitial);\r\n    writeChunk(\r\n      destination,\r\n      stringToChunk(escapeJSStringsForInstructionScripts(errorMessage || '')),\r\n    );\r\n  }\r\n  if (errorComponentStack) {\r\n    writeChunk(destination, clientRenderErrorScriptArgInterstitial);\r\n    writeChunk(\r\n      destination,\r\n      stringToChunk(escapeJSStringsForInstructionScripts(errorComponentStack)),\r\n    );\r\n  }\r\n  return writeChunkAndReturn(destination, clientRenderScript2);\r\n}\r\n\r\nconst regexForJSStringsInScripts = /[<\\u2028\\u2029]/g;\r\nfunction escapeJSStringsForInstructionScripts(input: string): string {\r\n  const escaped = JSON.stringify(input);\r\n  return escaped.replace(regexForJSStringsInScripts, match => {\r\n    switch (match) {\r\n      // santizing breaking out of strings and script tags\r\n      case '<':\r\n        return '\\\\u003c';\r\n      case '\\u2028':\r\n        return '\\\\u2028';\r\n      case '\\u2029':\r\n        return '\\\\u2029';\r\n      default: {\r\n        // eslint-disable-next-line react-internal/prod-error-codes\r\n        throw new Error(\r\n          'escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React',\r\n        );\r\n      }\r\n    }\r\n  });\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nconst assign = Object.assign;\r\n\r\nexport default assign;\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\n// ATTENTION\r\n// When adding new symbols to this file,\r\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\r\n\r\n// The Symbol used to tag the ReactElement-like types.\r\nexport const REACT_ELEMENT_TYPE = Symbol.for('react.element');\r\nexport const REACT_PORTAL_TYPE = Symbol.for('react.portal');\r\nexport const REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');\r\nexport const REACT_STRICT_MODE_TYPE = Symbol.for('react.strict_mode');\r\nexport const REACT_PROFILER_TYPE = Symbol.for('react.profiler');\r\nexport const REACT_PROVIDER_TYPE = Symbol.for('react.provider');\r\nexport const REACT_CONTEXT_TYPE = Symbol.for('react.context');\r\nexport const REACT_SERVER_CONTEXT_TYPE = Symbol.for('react.server_context');\r\nexport const REACT_FORWARD_REF_TYPE = Symbol.for('react.forward_ref');\r\nexport const REACT_SUSPENSE_TYPE = Symbol.for('react.suspense');\r\nexport const REACT_SUSPENSE_LIST_TYPE = Symbol.for('react.suspense_list');\r\nexport const REACT_MEMO_TYPE = Symbol.for('react.memo');\r\nexport const REACT_LAZY_TYPE = Symbol.for('react.lazy');\r\nexport const REACT_SCOPE_TYPE = Symbol.for('react.scope');\r\nexport const REACT_DEBUG_TRACING_MODE_TYPE = Symbol.for(\r\n  'react.debug_trace_mode',\r\n);\r\nexport const REACT_OFFSCREEN_TYPE = Symbol.for('react.offscreen');\r\nexport const REACT_LEGACY_HIDDEN_TYPE = Symbol.for('react.legacy_hidden');\r\nexport const REACT_CACHE_TYPE = Symbol.for('react.cache');\r\nexport const REACT_TRACING_MARKER_TYPE = Symbol.for('react.tracing_marker');\r\nexport const REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED = Symbol.for(\r\n  'react.default_value',\r\n);\r\n\r\nconst MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\r\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\r\n\r\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<*> {\r\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\r\n    return null;\r\n  }\r\n  const maybeIterator =\r\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\r\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\r\n  if (typeof maybeIterator === 'function') {\r\n    return maybeIterator;\r\n  }\r\n  return null;\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport type {LazyComponent} from 'react/src/ReactLazy';\r\nimport type {ReactContext, ReactProviderType} from 'shared/ReactTypes';\r\n\r\nimport {\r\n  REACT_CONTEXT_TYPE,\r\n  REACT_FORWARD_REF_TYPE,\r\n  REACT_FRAGMENT_TYPE,\r\n  REACT_PORTAL_TYPE,\r\n  REACT_MEMO_TYPE,\r\n  REACT_PROFILER_TYPE,\r\n  REACT_PROVIDER_TYPE,\r\n  REACT_STRICT_MODE_TYPE,\r\n  REACT_SUSPENSE_TYPE,\r\n  REACT_SUSPENSE_LIST_TYPE,\r\n  REACT_LAZY_TYPE,\r\n  REACT_CACHE_TYPE,\r\n  REACT_TRACING_MARKER_TYPE,\r\n  REACT_SERVER_CONTEXT_TYPE,\r\n} from 'shared/ReactSymbols';\r\n\r\nimport {\r\n  enableServerContext,\r\n  enableTransitionTracing,\r\n  enableCache,\r\n} from './ReactFeatureFlags';\r\n\r\n// Keep in sync with react-reconciler/getComponentNameFromFiber\r\nfunction getWrappedName(\r\n  outerType: mixed,\r\n  innerType: any,\r\n  wrapperName: string,\r\n): string {\r\n  const displayName = (outerType: any).displayName;\r\n  if (displayName) {\r\n    return displayName;\r\n  }\r\n  const functionName = innerType.displayName || innerType.name || '';\r\n  return functionName !== '' ? `${wrapperName}(${functionName})` : wrapperName;\r\n}\r\n\r\n// Keep in sync with react-reconciler/getComponentNameFromFiber\r\nfunction getContextName(type: ReactContext<any>) {\r\n  return type.displayName || 'Context';\r\n}\r\n\r\n// Note that the reconciler package should generally prefer to use getComponentNameFromFiber() instead.\r\nexport default function getComponentNameFromType(type: mixed): string | null {\r\n  if (type == null) {\r\n    // Host root, text node or just invalid type.\r\n    return null;\r\n  }\r\n  if (__DEV__) {\r\n    if (typeof (type: any).tag === 'number') {\r\n      console.error(\r\n        'Received an unexpected object in getComponentNameFromType(). ' +\r\n          'This is likely a bug in React. Please file an issue.',\r\n      );\r\n    }\r\n  }\r\n  if (typeof type === 'function') {\r\n    return (type: any).displayName || type.name || null;\r\n  }\r\n  if (typeof type === 'string') {\r\n    return type;\r\n  }\r\n  switch (type) {\r\n    case REACT_FRAGMENT_TYPE:\r\n      return 'Fragment';\r\n    case REACT_PORTAL_TYPE:\r\n      return 'Portal';\r\n    case REACT_PROFILER_TYPE:\r\n      return 'Profiler';\r\n    case REACT_STRICT_MODE_TYPE:\r\n      return 'StrictMode';\r\n    case REACT_SUSPENSE_TYPE:\r\n      return 'Suspense';\r\n    case REACT_SUSPENSE_LIST_TYPE:\r\n      return 'SuspenseList';\r\n    case REACT_CACHE_TYPE:\r\n      if (enableCache) {\r\n        return 'Cache';\r\n      }\r\n    // eslint-disable-next-line no-fallthrough\r\n    case REACT_TRACING_MARKER_TYPE:\r\n      if (enableTransitionTracing) {\r\n        return 'TracingMarker';\r\n      }\r\n  }\r\n  if (typeof type === 'object') {\r\n    switch (type.$$typeof) {\r\n      case REACT_CONTEXT_TYPE:\r\n        const context: ReactContext<any> = (type: any);\r\n        return getContextName(context) + '.Consumer';\r\n      case REACT_PROVIDER_TYPE:\r\n        const provider: ReactProviderType<any> = (type: any);\r\n        return getContextName(provider._context) + '.Provider';\r\n      case REACT_FORWARD_REF_TYPE:\r\n        return getWrappedName(type, type.render, 'ForwardRef');\r\n      case REACT_MEMO_TYPE:\r\n        const outerName = (type: any).displayName || null;\r\n        if (outerName !== null) {\r\n          return outerName;\r\n        }\r\n        return getComponentNameFromType(type.type) || 'Memo';\r\n      case REACT_LAZY_TYPE: {\r\n        const lazyComponent: LazyComponent<any, any> = (type: any);\r\n        const payload = lazyComponent._payload;\r\n        const init = lazyComponent._init;\r\n        try {\r\n          return getComponentNameFromType(init(payload));\r\n        } catch (x) {\r\n          return null;\r\n        }\r\n      }\r\n      case REACT_SERVER_CONTEXT_TYPE:\r\n        if (enableServerContext) {\r\n          const context2 = ((type: any): ReactContext<any>);\r\n          return (context2.displayName || context2._globalName) + '.Provider';\r\n        }\r\n      // eslint-disable-next-line no-fallthrough\r\n    }\r\n  }\r\n  return null;\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport * as React from 'react';\r\n\r\nconst ReactSharedInternals =\r\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\r\n\r\nexport default ReactSharedInternals;\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport type {Source} from 'shared/ReactElementType';\r\nimport type {LazyComponent} from 'react/src/ReactLazy';\r\n\r\nimport {\r\n  enableComponentStackLocations,\r\n  disableNativeComponentFrames,\r\n} from 'shared/ReactFeatureFlags';\r\n\r\nimport {\r\n  REACT_SUSPENSE_TYPE,\r\n  REACT_SUSPENSE_LIST_TYPE,\r\n  REACT_FORWARD_REF_TYPE,\r\n  REACT_MEMO_TYPE,\r\n  REACT_LAZY_TYPE,\r\n} from 'shared/ReactSymbols';\r\n\r\nimport {disableLogs, reenableLogs} from 'shared/ConsolePatchingDev';\r\n\r\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\r\n\r\nconst {ReactCurrentDispatcher} = ReactSharedInternals;\r\n\r\nlet prefix;\r\nexport function describeBuiltInComponentFrame(\r\n  name: string,\r\n  source: void | null | Source,\r\n  ownerFn: void | null | Function,\r\n): string {\r\n  if (enableComponentStackLocations) {\r\n    if (prefix === undefined) {\r\n      // Extract the VM specific prefix used by each line.\r\n      try {\r\n        throw Error();\r\n      } catch (x) {\r\n        const match = x.stack.trim().match(/\\n( *(at )?)/);\r\n        prefix = (match && match[1]) || '';\r\n      }\r\n    }\r\n    // We use the prefix to ensure our stacks line up with native stack frames.\r\n    return '\\n' + prefix + name;\r\n  } else {\r\n    let ownerName = null;\r\n    if (__DEV__ && ownerFn) {\r\n      ownerName = ownerFn.displayName || ownerFn.name || null;\r\n    }\r\n    return describeComponentFrame(name, source, ownerName);\r\n  }\r\n}\r\n\r\nlet reentry = false;\r\nlet componentFrameCache;\r\nif (__DEV__) {\r\n  const PossiblyWeakMap = typeof WeakMap === 'function' ? WeakMap : Map;\r\n  componentFrameCache = new PossiblyWeakMap();\r\n}\r\n\r\nexport function describeNativeComponentFrame(\r\n  fn: Function,\r\n  construct: boolean,\r\n): string {\r\n  // If something asked for a stack inside a fake render, it should get ignored.\r\n  if (disableNativeComponentFrames || !fn || reentry) {\r\n    return '';\r\n  }\r\n\r\n  if (__DEV__) {\r\n    const frame = componentFrameCache.get(fn);\r\n    if (frame !== undefined) {\r\n      return frame;\r\n    }\r\n  }\r\n\r\n  let control;\r\n\r\n  reentry = true;\r\n  const previousPrepareStackTrace = Error.prepareStackTrace;\r\n  // $FlowFixMe It does accept undefined.\r\n  Error.prepareStackTrace = undefined;\r\n  let previousDispatcher;\r\n  if (__DEV__) {\r\n    previousDispatcher = ReactCurrentDispatcher.current;\r\n    // Set the dispatcher in DEV because this might be call in the render function\r\n    // for warnings.\r\n    ReactCurrentDispatcher.current = null;\r\n    disableLogs();\r\n  }\r\n  try {\r\n    // This should throw.\r\n    if (construct) {\r\n      // Something should be setting the props in the constructor.\r\n      const Fake = function() {\r\n        throw Error();\r\n      };\r\n      // $FlowFixMe\r\n      Object.defineProperty(Fake.prototype, 'props', {\r\n        set: function() {\r\n          // We use a throwing setter instead of frozen or non-writable props\r\n          // because that won't throw in a non-strict mode function.\r\n          throw Error();\r\n        },\r\n      });\r\n      if (typeof Reflect === 'object' && Reflect.construct) {\r\n        // We construct a different control for this case to include any extra\r\n        // frames added by the construct call.\r\n        try {\r\n          Reflect.construct(Fake, []);\r\n        } catch (x) {\r\n          control = x;\r\n        }\r\n        Reflect.construct(fn, [], Fake);\r\n      } else {\r\n        try {\r\n          Fake.call();\r\n        } catch (x) {\r\n          control = x;\r\n        }\r\n        fn.call(Fake.prototype);\r\n      }\r\n    } else {\r\n      try {\r\n        throw Error();\r\n      } catch (x) {\r\n        control = x;\r\n      }\r\n      fn();\r\n    }\r\n  } catch (sample) {\r\n    // This is inlined manually because closure doesn't do it for us.\r\n    if (sample && control && typeof sample.stack === 'string') {\r\n      // This extracts the first frame from the sample that isn't also in the control.\r\n      // Skipping one frame that we assume is the frame that calls the two.\r\n      const sampleLines = sample.stack.split('\\n');\r\n      const controlLines = control.stack.split('\\n');\r\n      let s = sampleLines.length - 1;\r\n      let c = controlLines.length - 1;\r\n      while (s >= 1 && c >= 0 && sampleLines[s] !== controlLines[c]) {\r\n        // We expect at least one stack frame to be shared.\r\n        // Typically this will be the root most one. However, stack frames may be\r\n        // cut off due to maximum stack limits. In this case, one maybe cut off\r\n        // earlier than the other. We assume that the sample is longer or the same\r\n        // and there for cut off earlier. So we should find the root most frame in\r\n        // the sample somewhere in the control.\r\n        c--;\r\n      }\r\n      for (; s >= 1 && c >= 0; s--, c--) {\r\n        // Next we find the first one that isn't the same which should be the\r\n        // frame that called our sample function and the control.\r\n        if (sampleLines[s] !== controlLines[c]) {\r\n          // In V8, the first line is describing the message but other VMs don't.\r\n          // If we're about to return the first line, and the control is also on the same\r\n          // line, that's a pretty good indicator that our sample threw at same line as\r\n          // the control. I.e. before we entered the sample frame. So we ignore this result.\r\n          // This can happen if you passed a class to function component, or non-function.\r\n          if (s !== 1 || c !== 1) {\r\n            do {\r\n              s--;\r\n              c--;\r\n              // We may still have similar intermediate frames from the construct call.\r\n              // The next one that isn't the same should be our match though.\r\n              if (c < 0 || sampleLines[s] !== controlLines[c]) {\r\n                // V8 adds a \"new\" prefix for native classes. Let's remove it to make it prettier.\r\n                let frame = '\\n' + sampleLines[s].replace(' at new ', ' at ');\r\n\r\n                // If our component frame is labeled \"<anonymous>\"\r\n                // but we have a user-provided \"displayName\"\r\n                // splice it in to make the stack more readable.\r\n                if (fn.displayName && frame.includes('<anonymous>')) {\r\n                  frame = frame.replace('<anonymous>', fn.displayName);\r\n                }\r\n\r\n                if (__DEV__) {\r\n                  if (typeof fn === 'function') {\r\n                    componentFrameCache.set(fn, frame);\r\n                  }\r\n                }\r\n                // Return the line we found.\r\n                return frame;\r\n              }\r\n            } while (s >= 1 && c >= 0);\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  } finally {\r\n    reentry = false;\r\n    if (__DEV__) {\r\n      ReactCurrentDispatcher.current = previousDispatcher;\r\n      reenableLogs();\r\n    }\r\n    Error.prepareStackTrace = previousPrepareStackTrace;\r\n  }\r\n  // Fallback to just using the name if we couldn't make it throw.\r\n  const name = fn ? fn.displayName || fn.name : '';\r\n  const syntheticFrame = name ? describeBuiltInComponentFrame(name) : '';\r\n  if (__DEV__) {\r\n    if (typeof fn === 'function') {\r\n      componentFrameCache.set(fn, syntheticFrame);\r\n    }\r\n  }\r\n  return syntheticFrame;\r\n}\r\n\r\nconst BEFORE_SLASH_RE = /^(.*)[\\\\\\/]/;\r\n\r\nfunction describeComponentFrame(\r\n  name: null | string,\r\n  source: void | null | Source,\r\n  ownerName: null | string,\r\n) {\r\n  let sourceInfo = '';\r\n  if (__DEV__ && source) {\r\n    const path = source.fileName;\r\n    let fileName = path.replace(BEFORE_SLASH_RE, '');\r\n    // In DEV, include code for a common special case:\r\n    // prefer \"folder/index.js\" instead of just \"index.js\".\r\n    if (/^index\\./.test(fileName)) {\r\n      const match = path.match(BEFORE_SLASH_RE);\r\n      if (match) {\r\n        const pathBeforeSlash = match[1];\r\n        if (pathBeforeSlash) {\r\n          const folderName = pathBeforeSlash.replace(BEFORE_SLASH_RE, '');\r\n          fileName = folderName + '/' + fileName;\r\n        }\r\n      }\r\n    }\r\n    sourceInfo = ' (at ' + fileName + ':' + source.lineNumber + ')';\r\n  } else if (ownerName) {\r\n    sourceInfo = ' (created by ' + ownerName + ')';\r\n  }\r\n  return '\\n    in ' + (name || 'Unknown') + sourceInfo;\r\n}\r\n\r\nexport function describeClassComponentFrame(\r\n  ctor: Function,\r\n  source: void | null | Source,\r\n  ownerFn: void | null | Function,\r\n): string {\r\n  if (enableComponentStackLocations) {\r\n    return describeNativeComponentFrame(ctor, true);\r\n  } else {\r\n    return describeFunctionComponentFrame(ctor, source, ownerFn);\r\n  }\r\n}\r\n\r\nexport function describeFunctionComponentFrame(\r\n  fn: Function,\r\n  source: void | null | Source,\r\n  ownerFn: void | null | Function,\r\n): string {\r\n  if (enableComponentStackLocations) {\r\n    return describeNativeComponentFrame(fn, false);\r\n  } else {\r\n    if (!fn) {\r\n      return '';\r\n    }\r\n    const name = fn.displayName || fn.name || null;\r\n    let ownerName = null;\r\n    if (__DEV__ && ownerFn) {\r\n      ownerName = ownerFn.displayName || ownerFn.name || null;\r\n    }\r\n    return describeComponentFrame(name, source, ownerName);\r\n  }\r\n}\r\n\r\nfunction shouldConstruct(Component: Function) {\r\n  const prototype = Component.prototype;\r\n  return !!(prototype && prototype.isReactComponent);\r\n}\r\n\r\nexport function describeUnknownElementTypeFrameInDEV(\r\n  type: any,\r\n  source: void | null | Source,\r\n  ownerFn: void | null | Function,\r\n): string {\r\n  if (!__DEV__) {\r\n    return '';\r\n  }\r\n  if (type == null) {\r\n    return '';\r\n  }\r\n  if (typeof type === 'function') {\r\n    if (enableComponentStackLocations) {\r\n      return describeNativeComponentFrame(type, shouldConstruct(type));\r\n    } else {\r\n      return describeFunctionComponentFrame(type, source, ownerFn);\r\n    }\r\n  }\r\n  if (typeof type === 'string') {\r\n    return describeBuiltInComponentFrame(type, source, ownerFn);\r\n  }\r\n  switch (type) {\r\n    case REACT_SUSPENSE_TYPE:\r\n      return describeBuiltInComponentFrame('Suspense', source, ownerFn);\r\n    case REACT_SUSPENSE_LIST_TYPE:\r\n      return describeBuiltInComponentFrame('SuspenseList', source, ownerFn);\r\n  }\r\n  if (typeof type === 'object') {\r\n    switch (type.$$typeof) {\r\n      case REACT_FORWARD_REF_TYPE:\r\n        return describeFunctionComponentFrame(type.render, source, ownerFn);\r\n      case REACT_MEMO_TYPE:\r\n        // Memo may contain any component type so we recursively resolve it.\r\n        return describeUnknownElementTypeFrameInDEV(type.type, source, ownerFn);\r\n      case REACT_LAZY_TYPE: {\r\n        const lazyComponent: LazyComponent<any, any> = (type: any);\r\n        const payload = lazyComponent._payload;\r\n        const init = lazyComponent._init;\r\n        try {\r\n          // Lazy may contain any component type so we recursively resolve it.\r\n          return describeUnknownElementTypeFrameInDEV(\r\n            init(payload),\r\n            source,\r\n            ownerFn,\r\n          );\r\n        } catch (x) {}\r\n      }\r\n    }\r\n  }\r\n  return '';\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nconst loggedTypeFailures = {};\r\n\r\nimport {describeUnknownElementTypeFrameInDEV} from 'shared/ReactComponentStackFrame';\r\n\r\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\r\nimport hasOwnProperty from 'shared/hasOwnProperty';\r\n\r\nconst ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\r\n\r\nfunction setCurrentlyValidatingElement(element) {\r\n  if (__DEV__) {\r\n    if (element) {\r\n      const owner = element._owner;\r\n      const stack = describeUnknownElementTypeFrameInDEV(\r\n        element.type,\r\n        element._source,\r\n        owner ? owner.type : null,\r\n      );\r\n      ReactDebugCurrentFrame.setExtraStackFrame(stack);\r\n    } else {\r\n      ReactDebugCurrentFrame.setExtraStackFrame(null);\r\n    }\r\n  }\r\n}\r\n\r\nexport default function checkPropTypes(\r\n  typeSpecs: Object,\r\n  values: Object,\r\n  location: string,\r\n  componentName: ?string,\r\n  element?: any,\r\n): void {\r\n  if (__DEV__) {\r\n    // $FlowFixMe This is okay but Flow doesn't know it.\r\n    const has = Function.call.bind(hasOwnProperty);\r\n    for (const typeSpecName in typeSpecs) {\r\n      if (has(typeSpecs, typeSpecName)) {\r\n        let error;\r\n        // Prop type validation may throw. In case they do, we don't want to\r\n        // fail the render phase where it didn't fail before. So we log it.\r\n        // After these have been cleaned up, we'll let them throw.\r\n        try {\r\n          // This is intentionally an invariant that gets caught. It's the same\r\n          // behavior as without this statement except with a better message.\r\n          if (typeof typeSpecs[typeSpecName] !== 'function') {\r\n            // eslint-disable-next-line react-internal/prod-error-codes\r\n            const err = Error(\r\n              (componentName || 'React class') +\r\n                ': ' +\r\n                location +\r\n                ' type `' +\r\n                typeSpecName +\r\n                '` is invalid; ' +\r\n                'it must be a function, usually from the `prop-types` package, but received `' +\r\n                typeof typeSpecs[typeSpecName] +\r\n                '`.' +\r\n                'This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.',\r\n            );\r\n            err.name = 'Invariant Violation';\r\n            throw err;\r\n          }\r\n          error = typeSpecs[typeSpecName](\r\n            values,\r\n            typeSpecName,\r\n            componentName,\r\n            location,\r\n            null,\r\n            'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED',\r\n          );\r\n        } catch (ex) {\r\n          error = ex;\r\n        }\r\n        if (error && !(error instanceof Error)) {\r\n          setCurrentlyValidatingElement(element);\r\n          console.error(\r\n            '%s: type specification of %s' +\r\n              ' `%s` is invalid; the type checker ' +\r\n              'function must return `null` or an `Error` but returned a %s. ' +\r\n              'You may have forgotten to pass an argument to the type checker ' +\r\n              'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' +\r\n              'shape all require an argument).',\r\n            componentName || 'React class',\r\n            location,\r\n            typeSpecName,\r\n            typeof error,\r\n          );\r\n          setCurrentlyValidatingElement(null);\r\n        }\r\n        if (error instanceof Error && !(error.message in loggedTypeFailures)) {\r\n          // Only monitor this failure once because there tends to be a lot of the\r\n          // same error.\r\n          loggedTypeFailures[error.message] = true;\r\n          setCurrentlyValidatingElement(element);\r\n          console.error('Failed %s type: %s', location, error.message);\r\n          setCurrentlyValidatingElement(null);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport {disableLegacyContext} from 'shared/ReactFeatureFlags';\r\nimport getComponentNameFromType from 'shared/getComponentNameFromType';\r\nimport checkPropTypes from 'shared/checkPropTypes';\r\n\r\nlet warnedAboutMissingGetChildContext;\r\n\r\nif (__DEV__) {\r\n  warnedAboutMissingGetChildContext = {};\r\n}\r\n\r\nexport const emptyContextObject = {};\r\nif (__DEV__) {\r\n  Object.freeze(emptyContextObject);\r\n}\r\n\r\nexport function getMaskedContext(type: any, unmaskedContext: Object): Object {\r\n  if (disableLegacyContext) {\r\n    return emptyContextObject;\r\n  } else {\r\n    const contextTypes = type.contextTypes;\r\n    if (!contextTypes) {\r\n      return emptyContextObject;\r\n    }\r\n\r\n    const context = {};\r\n    for (const key in contextTypes) {\r\n      context[key] = unmaskedContext[key];\r\n    }\r\n\r\n    if (__DEV__) {\r\n      const name = getComponentNameFromType(type) || 'Unknown';\r\n      checkPropTypes(contextTypes, context, 'context', name);\r\n    }\r\n\r\n    return context;\r\n  }\r\n}\r\n\r\nexport function processChildContext(\r\n  instance: any,\r\n  type: any,\r\n  parentContext: Object,\r\n  childContextTypes: Object,\r\n): Object {\r\n  if (disableLegacyContext) {\r\n    return parentContext;\r\n  } else {\r\n    // TODO (bvaughn) Replace this behavior with an invariant() in the future.\r\n    // It has only been added in Fiber to match the (unintentional) behavior in Stack.\r\n    if (typeof instance.getChildContext !== 'function') {\r\n      if (__DEV__) {\r\n        const componentName = getComponentNameFromType(type) || 'Unknown';\r\n\r\n        if (!warnedAboutMissingGetChildContext[componentName]) {\r\n          warnedAboutMissingGetChildContext[componentName] = true;\r\n          console.error(\r\n            '%s.childContextTypes is specified but there is no getChildContext() method ' +\r\n              'on the instance. You can either define getChildContext() on %s or remove ' +\r\n              'childContextTypes from it.',\r\n            componentName,\r\n            componentName,\r\n          );\r\n        }\r\n      }\r\n      return parentContext;\r\n    }\r\n\r\n    const childContext = instance.getChildContext();\r\n    for (const contextKey in childContext) {\r\n      if (!(contextKey in childContextTypes)) {\r\n        throw new Error(\r\n          `${getComponentNameFromType(type) ||\r\n            'Unknown'}.getChildContext(): key \"${contextKey}\" is not defined in childContextTypes.`,\r\n        );\r\n      }\r\n    }\r\n    if (__DEV__) {\r\n      const name = getComponentNameFromType(type) || 'Unknown';\r\n      checkPropTypes(childContextTypes, childContext, 'child context', name);\r\n    }\r\n\r\n    return {...parentContext, ...childContext};\r\n  }\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport type {ReactContext} from 'shared/ReactTypes';\r\n\r\nimport {REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED} from 'shared/ReactSymbols';\r\nimport {isPrimaryRenderer} from './ReactServerFormatConfig';\r\n\r\nlet rendererSigil;\r\nif (__DEV__) {\r\n  // Use this to detect multiple renderers using the same context\r\n  rendererSigil = {};\r\n}\r\n\r\n// Used to store the parent path of all context overrides in a shared linked list.\r\n// Forming a reverse tree.\r\ntype ContextNode<T> = {\r\n  parent: null | ContextNode<any>,\r\n  depth: number, // Short hand to compute the depth of the tree at this node.\r\n  context: ReactContext<T>,\r\n  parentValue: T,\r\n  value: T,\r\n};\r\n\r\n// The structure of a context snapshot is an implementation of this file.\r\n// Currently, it's implemented as tracking the current active node.\r\nexport opaque type ContextSnapshot = null | ContextNode<any>;\r\n\r\nexport const rootContextSnapshot: ContextSnapshot = null;\r\n\r\n// We assume that this runtime owns the \"current\" field on all ReactContext instances.\r\n// This global (actually thread local) state represents what state all those \"current\",\r\n// fields are currently in.\r\nlet currentActiveSnapshot: ContextSnapshot = null;\r\n\r\nfunction popNode(prev: ContextNode<any>): void {\r\n  if (isPrimaryRenderer) {\r\n    prev.context._currentValue = prev.parentValue;\r\n  } else {\r\n    prev.context._currentValue2 = prev.parentValue;\r\n  }\r\n}\r\n\r\nfunction pushNode(next: ContextNode<any>): void {\r\n  if (isPrimaryRenderer) {\r\n    next.context._currentValue = next.value;\r\n  } else {\r\n    next.context._currentValue2 = next.value;\r\n  }\r\n}\r\n\r\nfunction popToNearestCommonAncestor(\r\n  prev: ContextNode<any>,\r\n  next: ContextNode<any>,\r\n): void {\r\n  if (prev === next) {\r\n    // We've found a shared ancestor. We don't need to pop nor reapply this one or anything above.\r\n  } else {\r\n    popNode(prev);\r\n    const parentPrev = prev.parent;\r\n    const parentNext = next.parent;\r\n    if (parentPrev === null) {\r\n      if (parentNext !== null) {\r\n        throw new Error(\r\n          'The stacks must reach the root at the same time. This is a bug in React.',\r\n        );\r\n      }\r\n    } else {\r\n      if (parentNext === null) {\r\n        throw new Error(\r\n          'The stacks must reach the root at the same time. This is a bug in React.',\r\n        );\r\n      }\r\n\r\n      popToNearestCommonAncestor(parentPrev, parentNext);\r\n    }\r\n\r\n    // On the way back, we push the new ones that weren't common.\r\n    pushNode(next);\r\n  }\r\n}\r\n\r\nfunction popAllPrevious(prev: ContextNode<any>): void {\r\n  popNode(prev);\r\n  const parentPrev = prev.parent;\r\n  if (parentPrev !== null) {\r\n    popAllPrevious(parentPrev);\r\n  }\r\n}\r\n\r\nfunction pushAllNext(next: ContextNode<any>): void {\r\n  const parentNext = next.parent;\r\n  if (parentNext !== null) {\r\n    pushAllNext(parentNext);\r\n  }\r\n  pushNode(next);\r\n}\r\n\r\nfunction popPreviousToCommonLevel(\r\n  prev: ContextNode<any>,\r\n  next: ContextNode<any>,\r\n): void {\r\n  popNode(prev);\r\n  const parentPrev = prev.parent;\r\n\r\n  if (parentPrev === null) {\r\n    throw new Error(\r\n      'The depth must equal at least at zero before reaching the root. This is a bug in React.',\r\n    );\r\n  }\r\n\r\n  if (parentPrev.depth === next.depth) {\r\n    // We found the same level. Now we just need to find a shared ancestor.\r\n    popToNearestCommonAncestor(parentPrev, next);\r\n  } else {\r\n    // We must still be deeper.\r\n    popPreviousToCommonLevel(parentPrev, next);\r\n  }\r\n}\r\n\r\nfunction popNextToCommonLevel(\r\n  prev: ContextNode<any>,\r\n  next: ContextNode<any>,\r\n): void {\r\n  const parentNext = next.parent;\r\n\r\n  if (parentNext === null) {\r\n    throw new Error(\r\n      'The depth must equal at least at zero before reaching the root. This is a bug in React.',\r\n    );\r\n  }\r\n\r\n  if (prev.depth === parentNext.depth) {\r\n    // We found the same level. Now we just need to find a shared ancestor.\r\n    popToNearestCommonAncestor(prev, parentNext);\r\n  } else {\r\n    // We must still be deeper.\r\n    popNextToCommonLevel(prev, parentNext);\r\n  }\r\n  pushNode(next);\r\n}\r\n\r\n// Perform context switching to the new snapshot.\r\n// To make it cheap to read many contexts, while not suspending, we make the switch eagerly by\r\n// updating all the context's current values. That way reads, always just read the current value.\r\n// At the cost of updating contexts even if they're never read by this subtree.\r\nexport function switchContext(newSnapshot: ContextSnapshot): void {\r\n  // The basic algorithm we need to do is to pop back any contexts that are no longer on the stack.\r\n  // We also need to update any new contexts that are now on the stack with the deepest value.\r\n  // The easiest way to update new contexts is to just reapply them in reverse order from the\r\n  // perspective of the backpointers. To avoid allocating a lot when switching, we use the stack\r\n  // for that. Therefore this algorithm is recursive.\r\n  // 1) First we pop which ever snapshot tree was deepest. Popping old contexts as we go.\r\n  // 2) Then we find the nearest common ancestor from there. Popping old contexts as we go.\r\n  // 3) Then we reapply new contexts on the way back up the stack.\r\n  const prev = currentActiveSnapshot;\r\n  const next = newSnapshot;\r\n  if (prev !== next) {\r\n    if (prev === null) {\r\n      // $FlowFixMe: This has to be non-null since it's not equal to prev.\r\n      pushAllNext(next);\r\n    } else if (next === null) {\r\n      popAllPrevious(prev);\r\n    } else if (prev.depth === next.depth) {\r\n      popToNearestCommonAncestor(prev, next);\r\n    } else if (prev.depth > next.depth) {\r\n      popPreviousToCommonLevel(prev, next);\r\n    } else {\r\n      popNextToCommonLevel(prev, next);\r\n    }\r\n    currentActiveSnapshot = next;\r\n  }\r\n}\r\n\r\nexport function pushProvider<T>(\r\n  context: ReactContext<T>,\r\n  nextValue: T,\r\n): ContextSnapshot {\r\n  let prevValue;\r\n  if (isPrimaryRenderer) {\r\n    prevValue = context._currentValue;\r\n    context._currentValue = nextValue;\r\n    if (__DEV__) {\r\n      if (\r\n        context._currentRenderer !== undefined &&\r\n        context._currentRenderer !== null &&\r\n        context._currentRenderer !== rendererSigil\r\n      ) {\r\n        console.error(\r\n          'Detected multiple renderers concurrently rendering the ' +\r\n            'same context provider. This is currently unsupported.',\r\n        );\r\n      }\r\n      context._currentRenderer = rendererSigil;\r\n    }\r\n  } else {\r\n    prevValue = context._currentValue2;\r\n    context._currentValue2 = nextValue;\r\n    if (__DEV__) {\r\n      if (\r\n        context._currentRenderer2 !== undefined &&\r\n        context._currentRenderer2 !== null &&\r\n        context._currentRenderer2 !== rendererSigil\r\n      ) {\r\n        console.error(\r\n          'Detected multiple renderers concurrently rendering the ' +\r\n            'same context provider. This is currently unsupported.',\r\n        );\r\n      }\r\n      context._currentRenderer2 = rendererSigil;\r\n    }\r\n  }\r\n  const prevNode = currentActiveSnapshot;\r\n  const newNode: ContextNode<T> = {\r\n    parent: prevNode,\r\n    depth: prevNode === null ? 0 : prevNode.depth + 1,\r\n    context: context,\r\n    parentValue: prevValue,\r\n    value: nextValue,\r\n  };\r\n  currentActiveSnapshot = newNode;\r\n  return newNode;\r\n}\r\n\r\nexport function popProvider<T>(context: ReactContext<T>): ContextSnapshot {\r\n  const prevSnapshot = currentActiveSnapshot;\r\n\r\n  if (prevSnapshot === null) {\r\n    throw new Error(\r\n      'Tried to pop a Context at the root of the app. This is a bug in React.',\r\n    );\r\n  }\r\n\r\n  if (__DEV__) {\r\n    if (prevSnapshot.context !== context) {\r\n      console.error(\r\n        'The parent context is not the expected context. This is probably a bug in React.',\r\n      );\r\n    }\r\n  }\r\n  if (isPrimaryRenderer) {\r\n    const value = prevSnapshot.parentValue;\r\n    if (value === REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED) {\r\n      prevSnapshot.context._currentValue = prevSnapshot.context._defaultValue;\r\n    } else {\r\n      prevSnapshot.context._currentValue = value;\r\n    }\r\n    if (__DEV__) {\r\n      if (\r\n        context._currentRenderer !== undefined &&\r\n        context._currentRenderer !== null &&\r\n        context._currentRenderer !== rendererSigil\r\n      ) {\r\n        console.error(\r\n          'Detected multiple renderers concurrently rendering the ' +\r\n            'same context provider. This is currently unsupported.',\r\n        );\r\n      }\r\n      context._currentRenderer = rendererSigil;\r\n    }\r\n  } else {\r\n    const value = prevSnapshot.parentValue;\r\n    if (value === REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED) {\r\n      prevSnapshot.context._currentValue2 = prevSnapshot.context._defaultValue;\r\n    } else {\r\n      prevSnapshot.context._currentValue2 = value;\r\n    }\r\n    if (__DEV__) {\r\n      if (\r\n        context._currentRenderer2 !== undefined &&\r\n        context._currentRenderer2 !== null &&\r\n        context._currentRenderer2 !== rendererSigil\r\n      ) {\r\n        console.error(\r\n          'Detected multiple renderers concurrently rendering the ' +\r\n            'same context provider. This is currently unsupported.',\r\n        );\r\n      }\r\n      context._currentRenderer2 = rendererSigil;\r\n    }\r\n  }\r\n  return (currentActiveSnapshot = prevSnapshot.parent);\r\n}\r\n\r\nexport function getActiveContext(): ContextSnapshot {\r\n  return currentActiveSnapshot;\r\n}\r\n\r\nexport function readContext<T>(context: ReactContext<T>): T {\r\n  const value = isPrimaryRenderer\r\n    ? context._currentValue\r\n    : context._currentValue2;\r\n  return value;\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\n/**\r\n * `ReactInstanceMap` maintains a mapping from a public facing stateful\r\n * instance (key) and the internal representation (value). This allows public\r\n * methods to accept the user facing instance as an argument and map them back\r\n * to internal methods.\r\n *\r\n * Note that this module is currently shared and assumed to be stateless.\r\n * If this becomes an actual Map, that will break.\r\n */\r\n\r\n/**\r\n * This API should be called `delete` but we'd have to make sure to always\r\n * transform these to strings for IE support. When this transform is fully\r\n * supported we can rename it.\r\n */\r\nexport function remove(key) {\r\n  key._reactInternals = undefined;\r\n}\r\n\r\nexport function get(key) {\r\n  return key._reactInternals;\r\n}\r\n\r\nexport function has(key) {\r\n  return key._reactInternals !== undefined;\r\n}\r\n\r\nexport function set(key, value) {\r\n  key._reactInternals = value;\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport {emptyContextObject} from './ReactFizzContext';\r\nimport {readContext} from './ReactFizzNewContext';\r\n\r\nimport {\r\n  disableLegacyContext,\r\n  warnAboutDeprecatedLifecycles,\r\n} from 'shared/ReactFeatureFlags';\r\nimport {get as getInstance, set as setInstance} from 'shared/ReactInstanceMap';\r\nimport getComponentNameFromType from 'shared/getComponentNameFromType';\r\nimport {REACT_CONTEXT_TYPE, REACT_PROVIDER_TYPE} from 'shared/ReactSymbols';\r\nimport assign from 'shared/assign';\r\nimport isArray from 'shared/isArray';\r\n\r\nconst didWarnAboutNoopUpdateForComponent = {};\r\nconst didWarnAboutDeprecatedWillMount = {};\r\n\r\nlet didWarnAboutUninitializedState;\r\nlet didWarnAboutGetSnapshotBeforeUpdateWithoutDidUpdate;\r\nlet didWarnAboutLegacyLifecyclesAndDerivedState;\r\nlet didWarnAboutUndefinedDerivedState;\r\nlet warnOnUndefinedDerivedState;\r\nlet warnOnInvalidCallback;\r\nlet didWarnAboutDirectlyAssigningPropsToState;\r\nlet didWarnAboutContextTypeAndContextTypes;\r\nlet didWarnAboutInvalidateContextType;\r\n\r\nif (__DEV__) {\r\n  didWarnAboutUninitializedState = new Set();\r\n  didWarnAboutGetSnapshotBeforeUpdateWithoutDidUpdate = new Set();\r\n  didWarnAboutLegacyLifecyclesAndDerivedState = new Set();\r\n  didWarnAboutDirectlyAssigningPropsToState = new Set();\r\n  didWarnAboutUndefinedDerivedState = new Set();\r\n  didWarnAboutContextTypeAndContextTypes = new Set();\r\n  didWarnAboutInvalidateContextType = new Set();\r\n\r\n  const didWarnOnInvalidCallback = new Set();\r\n\r\n  warnOnInvalidCallback = function(callback: mixed, callerName: string) {\r\n    if (callback === null || typeof callback === 'function') {\r\n      return;\r\n    }\r\n    const key = callerName + '_' + (callback: any);\r\n    if (!didWarnOnInvalidCallback.has(key)) {\r\n      didWarnOnInvalidCallback.add(key);\r\n      console.error(\r\n        '%s(...): Expected the last optional `callback` argument to be a ' +\r\n          'function. Instead received: %s.',\r\n        callerName,\r\n        callback,\r\n      );\r\n    }\r\n  };\r\n\r\n  warnOnUndefinedDerivedState = function(type, partialState) {\r\n    if (partialState === undefined) {\r\n      const componentName = getComponentNameFromType(type) || 'Component';\r\n      if (!didWarnAboutUndefinedDerivedState.has(componentName)) {\r\n        didWarnAboutUndefinedDerivedState.add(componentName);\r\n        console.error(\r\n          '%s.getDerivedStateFromProps(): A valid state object (or null) must be returned. ' +\r\n            'You have returned undefined.',\r\n          componentName,\r\n        );\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nfunction warnNoop(\r\n  publicInstance: React$Component<any, any>,\r\n  callerName: string,\r\n) {\r\n  if (__DEV__) {\r\n    const constructor = publicInstance.constructor;\r\n    const componentName =\r\n      (constructor && getComponentNameFromType(constructor)) || 'ReactClass';\r\n    const warningKey = componentName + '.' + callerName;\r\n    if (didWarnAboutNoopUpdateForComponent[warningKey]) {\r\n      return;\r\n    }\r\n\r\n    console.error(\r\n      '%s(...): Can only update a mounting component. ' +\r\n        'This usually means you called %s() outside componentWillMount() on the server. ' +\r\n        'This is a no-op.\\n\\nPlease check the code for the %s component.',\r\n      callerName,\r\n      callerName,\r\n      componentName,\r\n    );\r\n    didWarnAboutNoopUpdateForComponent[warningKey] = true;\r\n  }\r\n}\r\n\r\ntype InternalInstance = {\r\n  queue: null | Array<Object>,\r\n  replace: boolean,\r\n};\r\n\r\nconst classComponentUpdater = {\r\n  isMounted(inst) {\r\n    return false;\r\n  },\r\n  enqueueSetState(inst, payload, callback) {\r\n    const internals: InternalInstance = getInstance(inst);\r\n    if (internals.queue === null) {\r\n      warnNoop(inst, 'setState');\r\n    } else {\r\n      internals.queue.push(payload);\r\n      if (__DEV__) {\r\n        if (callback !== undefined && callback !== null) {\r\n          warnOnInvalidCallback(callback, 'setState');\r\n        }\r\n      }\r\n    }\r\n  },\r\n  enqueueReplaceState(inst, payload, callback) {\r\n    const internals: InternalInstance = getInstance(inst);\r\n    internals.replace = true;\r\n    internals.queue = [payload];\r\n    if (__DEV__) {\r\n      if (callback !== undefined && callback !== null) {\r\n        warnOnInvalidCallback(callback, 'setState');\r\n      }\r\n    }\r\n  },\r\n  enqueueForceUpdate(inst, callback) {\r\n    const internals: InternalInstance = getInstance(inst);\r\n    if (internals.queue === null) {\r\n      warnNoop(inst, 'forceUpdate');\r\n    } else {\r\n      if (__DEV__) {\r\n        if (callback !== undefined && callback !== null) {\r\n          warnOnInvalidCallback(callback, 'setState');\r\n        }\r\n      }\r\n    }\r\n  },\r\n};\r\n\r\nfunction applyDerivedStateFromProps(\r\n  instance: any,\r\n  ctor: any,\r\n  getDerivedStateFromProps: (props: any, state: any) => any,\r\n  prevState: any,\r\n  nextProps: any,\r\n) {\r\n  const partialState = getDerivedStateFromProps(nextProps, prevState);\r\n\r\n  if (__DEV__) {\r\n    warnOnUndefinedDerivedState(ctor, partialState);\r\n  }\r\n  // Merge the partial state and the previous state.\r\n  const newState =\r\n    partialState === null || partialState === undefined\r\n      ? prevState\r\n      : assign({}, prevState, partialState);\r\n  return newState;\r\n}\r\n\r\nexport function constructClassInstance(\r\n  ctor: any,\r\n  props: any,\r\n  maskedLegacyContext: any,\r\n): any {\r\n  let context = emptyContextObject;\r\n  const contextType = ctor.contextType;\r\n\r\n  if (__DEV__) {\r\n    if ('contextType' in ctor) {\r\n      const isValid =\r\n        // Allow null for conditional declaration\r\n        contextType === null ||\r\n        (contextType !== undefined &&\r\n          contextType.$$typeof === REACT_CONTEXT_TYPE &&\r\n          contextType._context === undefined); // Not a <Context.Consumer>\r\n\r\n      if (!isValid && !didWarnAboutInvalidateContextType.has(ctor)) {\r\n        didWarnAboutInvalidateContextType.add(ctor);\r\n\r\n        let addendum = '';\r\n        if (contextType === undefined) {\r\n          addendum =\r\n            ' However, it is set to undefined. ' +\r\n            'This can be caused by a typo or by mixing up named and default imports. ' +\r\n            'This can also happen due to a circular dependency, so ' +\r\n            'try moving the createContext() call to a separate file.';\r\n        } else if (typeof contextType !== 'object') {\r\n          addendum = ' However, it is set to a ' + typeof contextType + '.';\r\n        } else if (contextType.$$typeof === REACT_PROVIDER_TYPE) {\r\n          addendum = ' Did you accidentally pass the Context.Provider instead?';\r\n        } else if (contextType._context !== undefined) {\r\n          // <Context.Consumer>\r\n          addendum = ' Did you accidentally pass the Context.Consumer instead?';\r\n        } else {\r\n          addendum =\r\n            ' However, it is set to an object with keys {' +\r\n            Object.keys(contextType).join(', ') +\r\n            '}.';\r\n        }\r\n        console.error(\r\n          '%s defines an invalid contextType. ' +\r\n            'contextType should point to the Context object returned by React.createContext().%s',\r\n          getComponentNameFromType(ctor) || 'Component',\r\n          addendum,\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  if (typeof contextType === 'object' && contextType !== null) {\r\n    context = readContext((contextType: any));\r\n  } else if (!disableLegacyContext) {\r\n    context = maskedLegacyContext;\r\n  }\r\n\r\n  const instance = new ctor(props, context);\r\n\r\n  if (__DEV__) {\r\n    if (\r\n      typeof ctor.getDerivedStateFromProps === 'function' &&\r\n      (instance.state === null || instance.state === undefined)\r\n    ) {\r\n      const componentName = getComponentNameFromType(ctor) || 'Component';\r\n      if (!didWarnAboutUninitializedState.has(componentName)) {\r\n        didWarnAboutUninitializedState.add(componentName);\r\n        console.error(\r\n          '`%s` uses `getDerivedStateFromProps` but its initial state is ' +\r\n            '%s. This is not recommended. Instead, define the initial state by ' +\r\n            'assigning an object to `this.state` in the constructor of `%s`. ' +\r\n            'This ensures that `getDerivedStateFromProps` arguments have a consistent shape.',\r\n          componentName,\r\n          instance.state === null ? 'null' : 'undefined',\r\n          componentName,\r\n        );\r\n      }\r\n    }\r\n\r\n    // If new component APIs are defined, \"unsafe\" lifecycles won't be called.\r\n    // Warn about these lifecycles if they are present.\r\n    // Don't warn about react-lifecycles-compat polyfilled methods though.\r\n    if (\r\n      typeof ctor.getDerivedStateFromProps === 'function' ||\r\n      typeof instance.getSnapshotBeforeUpdate === 'function'\r\n    ) {\r\n      let foundWillMountName = null;\r\n      let foundWillReceivePropsName = null;\r\n      let foundWillUpdateName = null;\r\n      if (\r\n        typeof instance.componentWillMount === 'function' &&\r\n        instance.componentWillMount.__suppressDeprecationWarning !== true\r\n      ) {\r\n        foundWillMountName = 'componentWillMount';\r\n      } else if (typeof instance.UNSAFE_componentWillMount === 'function') {\r\n        foundWillMountName = 'UNSAFE_componentWillMount';\r\n      }\r\n      if (\r\n        typeof instance.componentWillReceiveProps === 'function' &&\r\n        instance.componentWillReceiveProps.__suppressDeprecationWarning !== true\r\n      ) {\r\n        foundWillReceivePropsName = 'componentWillReceiveProps';\r\n      } else if (\r\n        typeof instance.UNSAFE_componentWillReceiveProps === 'function'\r\n      ) {\r\n        foundWillReceivePropsName = 'UNSAFE_componentWillReceiveProps';\r\n      }\r\n      if (\r\n        typeof instance.componentWillUpdate === 'function' &&\r\n        instance.componentWillUpdate.__suppressDeprecationWarning !== true\r\n      ) {\r\n        foundWillUpdateName = 'componentWillUpdate';\r\n      } else if (typeof instance.UNSAFE_componentWillUpdate === 'function') {\r\n        foundWillUpdateName = 'UNSAFE_componentWillUpdate';\r\n      }\r\n      if (\r\n        foundWillMountName !== null ||\r\n        foundWillReceivePropsName !== null ||\r\n        foundWillUpdateName !== null\r\n      ) {\r\n        const componentName = getComponentNameFromType(ctor) || 'Component';\r\n        const newApiName =\r\n          typeof ctor.getDerivedStateFromProps === 'function'\r\n            ? 'getDerivedStateFromProps()'\r\n            : 'getSnapshotBeforeUpdate()';\r\n        if (!didWarnAboutLegacyLifecyclesAndDerivedState.has(componentName)) {\r\n          didWarnAboutLegacyLifecyclesAndDerivedState.add(componentName);\r\n          console.error(\r\n            'Unsafe legacy lifecycles will not be called for components using new component APIs.\\n\\n' +\r\n              '%s uses %s but also contains the following legacy lifecycles:%s%s%s\\n\\n' +\r\n              'The above lifecycles should be removed. Learn more about this warning here:\\n' +\r\n              'https://reactjs.org/link/unsafe-component-lifecycles',\r\n            componentName,\r\n            newApiName,\r\n            foundWillMountName !== null ? `\\n  ${foundWillMountName}` : '',\r\n            foundWillReceivePropsName !== null\r\n              ? `\\n  ${foundWillReceivePropsName}`\r\n              : '',\r\n            foundWillUpdateName !== null ? `\\n  ${foundWillUpdateName}` : '',\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return instance;\r\n}\r\n\r\nfunction checkClassInstance(instance: any, ctor: any, newProps: any) {\r\n  if (__DEV__) {\r\n    const name = getComponentNameFromType(ctor) || 'Component';\r\n    const renderPresent = instance.render;\r\n\r\n    if (!renderPresent) {\r\n      if (ctor.prototype && typeof ctor.prototype.render === 'function') {\r\n        console.error(\r\n          '%s(...): No `render` method found on the returned component ' +\r\n            'instance: did you accidentally return an object from the constructor?',\r\n          name,\r\n        );\r\n      } else {\r\n        console.error(\r\n          '%s(...): No `render` method found on the returned component ' +\r\n            'instance: you may have forgotten to define `render`.',\r\n          name,\r\n        );\r\n      }\r\n    }\r\n\r\n    if (\r\n      instance.getInitialState &&\r\n      !instance.getInitialState.isReactClassApproved &&\r\n      !instance.state\r\n    ) {\r\n      console.error(\r\n        'getInitialState was defined on %s, a plain JavaScript class. ' +\r\n          'This is only supported for classes created using React.createClass. ' +\r\n          'Did you mean to define a state property instead?',\r\n        name,\r\n      );\r\n    }\r\n    if (\r\n      instance.getDefaultProps &&\r\n      !instance.getDefaultProps.isReactClassApproved\r\n    ) {\r\n      console.error(\r\n        'getDefaultProps was defined on %s, a plain JavaScript class. ' +\r\n          'This is only supported for classes created using React.createClass. ' +\r\n          'Use a static property to define defaultProps instead.',\r\n        name,\r\n      );\r\n    }\r\n    if (instance.propTypes) {\r\n      console.error(\r\n        'propTypes was defined as an instance property on %s. Use a static ' +\r\n          'property to define propTypes instead.',\r\n        name,\r\n      );\r\n    }\r\n    if (instance.contextType) {\r\n      console.error(\r\n        'contextType was defined as an instance property on %s. Use a static ' +\r\n          'property to define contextType instead.',\r\n        name,\r\n      );\r\n    }\r\n\r\n    if (disableLegacyContext) {\r\n      if (ctor.childContextTypes) {\r\n        console.error(\r\n          '%s uses the legacy childContextTypes API which is no longer supported. ' +\r\n            'Use React.createContext() instead.',\r\n          name,\r\n        );\r\n      }\r\n      if (ctor.contextTypes) {\r\n        console.error(\r\n          '%s uses the legacy contextTypes API which is no longer supported. ' +\r\n            'Use React.createContext() with static contextType instead.',\r\n          name,\r\n        );\r\n      }\r\n    } else {\r\n      if (instance.contextTypes) {\r\n        console.error(\r\n          'contextTypes was defined as an instance property on %s. Use a static ' +\r\n            'property to define contextTypes instead.',\r\n          name,\r\n        );\r\n      }\r\n\r\n      if (\r\n        ctor.contextType &&\r\n        ctor.contextTypes &&\r\n        !didWarnAboutContextTypeAndContextTypes.has(ctor)\r\n      ) {\r\n        didWarnAboutContextTypeAndContextTypes.add(ctor);\r\n        console.error(\r\n          '%s declares both contextTypes and contextType static properties. ' +\r\n            'The legacy contextTypes property will be ignored.',\r\n          name,\r\n        );\r\n      }\r\n    }\r\n\r\n    if (typeof instance.componentShouldUpdate === 'function') {\r\n      console.error(\r\n        '%s has a method called ' +\r\n          'componentShouldUpdate(). Did you mean shouldComponentUpdate()? ' +\r\n          'The name is phrased as a question because the function is ' +\r\n          'expected to return a value.',\r\n        name,\r\n      );\r\n    }\r\n    if (\r\n      ctor.prototype &&\r\n      ctor.prototype.isPureReactComponent &&\r\n      typeof instance.shouldComponentUpdate !== 'undefined'\r\n    ) {\r\n      console.error(\r\n        '%s has a method called shouldComponentUpdate(). ' +\r\n          'shouldComponentUpdate should not be used when extending React.PureComponent. ' +\r\n          'Please extend React.Component if shouldComponentUpdate is used.',\r\n        getComponentNameFromType(ctor) || 'A pure component',\r\n      );\r\n    }\r\n    if (typeof instance.componentDidUnmount === 'function') {\r\n      console.error(\r\n        '%s has a method called ' +\r\n          'componentDidUnmount(). But there is no such lifecycle method. ' +\r\n          'Did you mean componentWillUnmount()?',\r\n        name,\r\n      );\r\n    }\r\n    if (typeof instance.componentDidReceiveProps === 'function') {\r\n      console.error(\r\n        '%s has a method called ' +\r\n          'componentDidReceiveProps(). But there is no such lifecycle method. ' +\r\n          'If you meant to update the state in response to changing props, ' +\r\n          'use componentWillReceiveProps(). If you meant to fetch data or ' +\r\n          'run side-effects or mutations after React has updated the UI, use componentDidUpdate().',\r\n        name,\r\n      );\r\n    }\r\n    if (typeof instance.componentWillRecieveProps === 'function') {\r\n      console.error(\r\n        '%s has a method called ' +\r\n          'componentWillRecieveProps(). Did you mean componentWillReceiveProps()?',\r\n        name,\r\n      );\r\n    }\r\n    if (typeof instance.UNSAFE_componentWillRecieveProps === 'function') {\r\n      console.error(\r\n        '%s has a method called ' +\r\n          'UNSAFE_componentWillRecieveProps(). Did you mean UNSAFE_componentWillReceiveProps()?',\r\n        name,\r\n      );\r\n    }\r\n    const hasMutatedProps = instance.props !== newProps;\r\n    if (instance.props !== undefined && hasMutatedProps) {\r\n      console.error(\r\n        '%s(...): When calling super() in `%s`, make sure to pass ' +\r\n          \"up the same props that your component's constructor was passed.\",\r\n        name,\r\n        name,\r\n      );\r\n    }\r\n    if (instance.defaultProps) {\r\n      console.error(\r\n        'Setting defaultProps as an instance property on %s is not supported and will be ignored.' +\r\n          ' Instead, define defaultProps as a static property on %s.',\r\n        name,\r\n        name,\r\n      );\r\n    }\r\n\r\n    if (\r\n      typeof instance.getSnapshotBeforeUpdate === 'function' &&\r\n      typeof instance.componentDidUpdate !== 'function' &&\r\n      !didWarnAboutGetSnapshotBeforeUpdateWithoutDidUpdate.has(ctor)\r\n    ) {\r\n      didWarnAboutGetSnapshotBeforeUpdateWithoutDidUpdate.add(ctor);\r\n      console.error(\r\n        '%s: getSnapshotBeforeUpdate() should be used with componentDidUpdate(). ' +\r\n          'This component defines getSnapshotBeforeUpdate() only.',\r\n        getComponentNameFromType(ctor),\r\n      );\r\n    }\r\n\r\n    if (typeof instance.getDerivedStateFromProps === 'function') {\r\n      console.error(\r\n        '%s: getDerivedStateFromProps() is defined as an instance method ' +\r\n          'and will be ignored. Instead, declare it as a static method.',\r\n        name,\r\n      );\r\n    }\r\n    if (typeof instance.getDerivedStateFromError === 'function') {\r\n      console.error(\r\n        '%s: getDerivedStateFromError() is defined as an instance method ' +\r\n          'and will be ignored. Instead, declare it as a static method.',\r\n        name,\r\n      );\r\n    }\r\n    if (typeof ctor.getSnapshotBeforeUpdate === 'function') {\r\n      console.error(\r\n        '%s: getSnapshotBeforeUpdate() is defined as a static method ' +\r\n          'and will be ignored. Instead, declare it as an instance method.',\r\n        name,\r\n      );\r\n    }\r\n    const state = instance.state;\r\n    if (state && (typeof state !== 'object' || isArray(state))) {\r\n      console.error('%s.state: must be set to an object or null', name);\r\n    }\r\n    if (\r\n      typeof instance.getChildContext === 'function' &&\r\n      typeof ctor.childContextTypes !== 'object'\r\n    ) {\r\n      console.error(\r\n        '%s.getChildContext(): childContextTypes must be defined in order to ' +\r\n          'use getChildContext().',\r\n        name,\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nfunction callComponentWillMount(type, instance) {\r\n  const oldState = instance.state;\r\n\r\n  if (typeof instance.componentWillMount === 'function') {\r\n    if (__DEV__) {\r\n      if (\r\n        warnAboutDeprecatedLifecycles &&\r\n        instance.componentWillMount.__suppressDeprecationWarning !== true\r\n      ) {\r\n        const componentName = getComponentNameFromType(type) || 'Unknown';\r\n\r\n        if (!didWarnAboutDeprecatedWillMount[componentName]) {\r\n          console.warn(\r\n            // keep this warning in sync with ReactStrictModeWarning.js\r\n            'componentWillMount has been renamed, and is not recommended for use. ' +\r\n              'See https://reactjs.org/link/unsafe-component-lifecycles for details.\\n\\n' +\r\n              '* Move code from componentWillMount to componentDidMount (preferred in most cases) ' +\r\n              'or the constructor.\\n' +\r\n              '\\nPlease update the following components: %s',\r\n            componentName,\r\n          );\r\n          didWarnAboutDeprecatedWillMount[componentName] = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    instance.componentWillMount();\r\n  }\r\n  if (typeof instance.UNSAFE_componentWillMount === 'function') {\r\n    instance.UNSAFE_componentWillMount();\r\n  }\r\n\r\n  if (oldState !== instance.state) {\r\n    if (__DEV__) {\r\n      console.error(\r\n        '%s.componentWillMount(): Assigning directly to this.state is ' +\r\n          \"deprecated (except inside a component's \" +\r\n          'constructor). Use setState instead.',\r\n        getComponentNameFromType(type) || 'Component',\r\n      );\r\n    }\r\n    classComponentUpdater.enqueueReplaceState(instance, instance.state, null);\r\n  }\r\n}\r\n\r\nfunction processUpdateQueue(\r\n  internalInstance: InternalInstance,\r\n  inst: any,\r\n  props: any,\r\n  maskedLegacyContext: any,\r\n): void {\r\n  if (internalInstance.queue !== null && internalInstance.queue.length > 0) {\r\n    const oldQueue = internalInstance.queue;\r\n    const oldReplace = internalInstance.replace;\r\n    internalInstance.queue = null;\r\n    internalInstance.replace = false;\r\n\r\n    if (oldReplace && oldQueue.length === 1) {\r\n      inst.state = oldQueue[0];\r\n    } else {\r\n      let nextState = oldReplace ? oldQueue[0] : inst.state;\r\n      let dontMutate = true;\r\n      for (let i = oldReplace ? 1 : 0; i < oldQueue.length; i++) {\r\n        const partial = oldQueue[i];\r\n        const partialState =\r\n          typeof partial === 'function'\r\n            ? partial.call(inst, nextState, props, maskedLegacyContext)\r\n            : partial;\r\n        if (partialState != null) {\r\n          if (dontMutate) {\r\n            dontMutate = false;\r\n            nextState = assign({}, nextState, partialState);\r\n          } else {\r\n            assign(nextState, partialState);\r\n          }\r\n        }\r\n      }\r\n      inst.state = nextState;\r\n    }\r\n  } else {\r\n    internalInstance.queue = null;\r\n  }\r\n}\r\n\r\n// Invokes the mount life-cycles on a previously never rendered instance.\r\nexport function mountClassInstance(\r\n  instance: any,\r\n  ctor: any,\r\n  newProps: any,\r\n  maskedLegacyContext: any,\r\n): void {\r\n  if (__DEV__) {\r\n    checkClassInstance(instance, ctor, newProps);\r\n  }\r\n\r\n  const initialState = instance.state !== undefined ? instance.state : null;\r\n\r\n  instance.updater = classComponentUpdater;\r\n  instance.props = newProps;\r\n  instance.state = initialState;\r\n  // We don't bother initializing the refs object on the server, since we're not going to resolve them anyway.\r\n\r\n  // The internal instance will be used to manage updates that happen during this mount.\r\n  const internalInstance: InternalInstance = {\r\n    queue: [],\r\n    replace: false,\r\n  };\r\n  setInstance(instance, internalInstance);\r\n\r\n  const contextType = ctor.contextType;\r\n  if (typeof contextType === 'object' && contextType !== null) {\r\n    instance.context = readContext(contextType);\r\n  } else if (disableLegacyContext) {\r\n    instance.context = emptyContextObject;\r\n  } else {\r\n    instance.context = maskedLegacyContext;\r\n  }\r\n\r\n  if (__DEV__) {\r\n    if (instance.state === newProps) {\r\n      const componentName = getComponentNameFromType(ctor) || 'Component';\r\n      if (!didWarnAboutDirectlyAssigningPropsToState.has(componentName)) {\r\n        didWarnAboutDirectlyAssigningPropsToState.add(componentName);\r\n        console.error(\r\n          '%s: It is not recommended to assign props directly to state ' +\r\n            \"because updates to props won't be reflected in state. \" +\r\n            'In most cases, it is better to use props directly.',\r\n          componentName,\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  const getDerivedStateFromProps = ctor.getDerivedStateFromProps;\r\n  if (typeof getDerivedStateFromProps === 'function') {\r\n    instance.state = applyDerivedStateFromProps(\r\n      instance,\r\n      ctor,\r\n      getDerivedStateFromProps,\r\n      initialState,\r\n      newProps,\r\n    );\r\n  }\r\n\r\n  // In order to support react-lifecycles-compat polyfilled components,\r\n  // Unsafe lifecycles should not be invoked for components using the new APIs.\r\n  if (\r\n    typeof ctor.getDerivedStateFromProps !== 'function' &&\r\n    typeof instance.getSnapshotBeforeUpdate !== 'function' &&\r\n    (typeof instance.UNSAFE_componentWillMount === 'function' ||\r\n      typeof instance.componentWillMount === 'function')\r\n  ) {\r\n    callComponentWillMount(ctor, instance);\r\n    // If we had additional state updates during this life-cycle, let's\r\n    // process them now.\r\n    processUpdateQueue(\r\n      internalInstance,\r\n      instance,\r\n      newProps,\r\n      maskedLegacyContext,\r\n    );\r\n  }\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\n// Ids are base 32 strings whose binary representation corresponds to the\r\n// position of a node in a tree.\r\n\r\n// Every time the tree forks into multiple children, we add additional bits to\r\n// the left of the sequence that represent the position of the child within the\r\n// current level of children.\r\n//\r\n//      00101       00010001011010101\r\n//             \r\n//   Fork 5 of 20       Parent id\r\n//\r\n// The leading 0s are important. In the above example, you only need 3 bits to\r\n// represent slot 5. However, you need 5 bits to represent all the forks at\r\n// the current level, so we must account for the empty bits at the end.\r\n//\r\n// For this same reason, slots are 1-indexed instead of 0-indexed. Otherwise,\r\n// the zeroth id at a level would be indistinguishable from its parent.\r\n//\r\n// If a node has only one child, and does not materialize an id (i.e. does not\r\n// contain a useId hook), then we don't need to allocate any space in the\r\n// sequence. It's treated as a transparent indirection. For example, these two\r\n// trees produce the same ids:\r\n//\r\n// <>                          <>\r\n//   <Indirection>               <A />\r\n//     <A />                     <B />\r\n//   </Indirection>            </>\r\n//   <B />\r\n// </>\r\n//\r\n// However, we cannot skip any node that materializes an id. Otherwise, a parent\r\n// id that does not fork would be indistinguishable from its child id. For\r\n// example, this tree does not fork, but the parent and child must have\r\n// different ids.\r\n//\r\n// <Parent>\r\n//   <Child />\r\n// </Parent>\r\n//\r\n// To handle this scenario, every time we materialize an id, we allocate a\r\n// new level with a single slot. You can think of this as a fork with only one\r\n// prong, or an array of children with length 1.\r\n//\r\n// It's possible for the size of the sequence to exceed 32 bits, the max\r\n// size for bitwise operations. When this happens, we make more room by\r\n// converting the right part of the id to a string and storing it in an overflow\r\n// variable. We use a base 32 string representation, because 32 is the largest\r\n// power of 2 that is supported by toString(). We want the base to be large so\r\n// that the resulting ids are compact, and we want the base to be a power of 2\r\n// because every log2(base) bits corresponds to a single character, i.e. every\r\n// log2(32) = 5 bits. That means we can lop bits off the end 5 at a time without\r\n// affecting the final result.\r\n\r\nexport type TreeContext = {\r\n  +id: number,\r\n  +overflow: string,\r\n};\r\n\r\nexport const emptyTreeContext = {\r\n  id: 1,\r\n  overflow: '',\r\n};\r\n\r\nexport function getTreeId(context: TreeContext): string {\r\n  const overflow = context.overflow;\r\n  const idWithLeadingBit = context.id;\r\n  const id = idWithLeadingBit & ~getLeadingBit(idWithLeadingBit);\r\n  return id.toString(32) + overflow;\r\n}\r\n\r\nexport function pushTreeContext(\r\n  baseContext: TreeContext,\r\n  totalChildren: number,\r\n  index: number,\r\n): TreeContext {\r\n  const baseIdWithLeadingBit = baseContext.id;\r\n  const baseOverflow = baseContext.overflow;\r\n\r\n  // The leftmost 1 marks the end of the sequence, non-inclusive. It's not part\r\n  // of the id; we use it to account for leading 0s.\r\n  const baseLength = getBitLength(baseIdWithLeadingBit) - 1;\r\n  const baseId = baseIdWithLeadingBit & ~(1 << baseLength);\r\n\r\n  const slot = index + 1;\r\n  const length = getBitLength(totalChildren) + baseLength;\r\n\r\n  // 30 is the max length we can store without overflowing, taking into\r\n  // consideration the leading 1 we use to mark the end of the sequence.\r\n  if (length > 30) {\r\n    // We overflowed the bitwise-safe range. Fall back to slower algorithm.\r\n    // This branch assumes the length of the base id is greater than 5; it won't\r\n    // work for smaller ids, because you need 5 bits per character.\r\n    //\r\n    // We encode the id in multiple steps: first the base id, then the\r\n    // remaining digits.\r\n    //\r\n    // Each 5 bit sequence corresponds to a single base 32 character. So for\r\n    // example, if the current id is 23 bits long, we can convert 20 of those\r\n    // bits into a string of 4 characters, with 3 bits left over.\r\n    //\r\n    // First calculate how many bits in the base id represent a complete\r\n    // sequence of characters.\r\n    const numberOfOverflowBits = baseLength - (baseLength % 5);\r\n\r\n    // Then create a bitmask that selects only those bits.\r\n    const newOverflowBits = (1 << numberOfOverflowBits) - 1;\r\n\r\n    // Select the bits, and convert them to a base 32 string.\r\n    const newOverflow = (baseId & newOverflowBits).toString(32);\r\n\r\n    // Now we can remove those bits from the base id.\r\n    const restOfBaseId = baseId >> numberOfOverflowBits;\r\n    const restOfBaseLength = baseLength - numberOfOverflowBits;\r\n\r\n    // Finally, encode the rest of the bits using the normal algorithm. Because\r\n    // we made more room, this time it won't overflow.\r\n    const restOfLength = getBitLength(totalChildren) + restOfBaseLength;\r\n    const restOfNewBits = slot << restOfBaseLength;\r\n    const id = restOfNewBits | restOfBaseId;\r\n    const overflow = newOverflow + baseOverflow;\r\n    return {\r\n      id: (1 << restOfLength) | id,\r\n      overflow,\r\n    };\r\n  } else {\r\n    // Normal path\r\n    const newBits = slot << baseLength;\r\n    const id = newBits | baseId;\r\n    const overflow = baseOverflow;\r\n    return {\r\n      id: (1 << length) | id,\r\n      overflow,\r\n    };\r\n  }\r\n}\r\n\r\nfunction getBitLength(number: number): number {\r\n  return 32 - clz32(number);\r\n}\r\n\r\nfunction getLeadingBit(id: number) {\r\n  return 1 << (getBitLength(id) - 1);\r\n}\r\n\r\n// TODO: Math.clz32 is supported in Node 12+. Maybe we can drop the fallback.\r\nconst clz32 = Math.clz32 ? Math.clz32 : clz32Fallback;\r\n\r\n// Count leading zeros.\r\n// Based on:\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/clz32\r\nconst log = Math.log;\r\nconst LN2 = Math.LN2;\r\nfunction clz32Fallback(x: number): number {\r\n  const asUint = x >>> 0;\r\n  if (asUint === 0) {\r\n    return 32;\r\n  }\r\n  return (31 - ((log(asUint) / LN2) | 0)) | 0;\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\n/**\r\n * inlined Object.is polyfill to avoid requiring consumers ship their own\r\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\r\n */\r\nfunction is(x: any, y: any) {\r\n  return (\r\n    (x === y && (x !== 0 || 1 / x === 1 / y)) || (x !== x && y !== y) // eslint-disable-line no-self-compare\r\n  );\r\n}\r\n\r\nconst objectIs: (x: any, y: any) => boolean =\r\n  typeof Object.is === 'function' ? Object.is : is;\r\n\r\nexport default objectIs;\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport type {Dispatcher as DispatcherType} from 'react-reconciler/src/ReactInternalTypes';\r\n\r\nimport type {\r\n  MutableSource,\r\n  MutableSourceGetSnapshotFn,\r\n  MutableSourceSubscribeFn,\r\n  ReactContext,\r\n  StartTransitionOptions,\r\n} from 'shared/ReactTypes';\r\n\r\nimport type {ResponseState} from './ReactServerFormatConfig';\r\nimport type {Task} from './ReactFizzServer';\r\n\r\nimport {readContext as readContextImpl} from './ReactFizzNewContext';\r\nimport {getTreeId} from './ReactFizzTreeContext';\r\n\r\nimport {makeId} from './ReactServerFormatConfig';\r\n\r\nimport {enableCache} from 'shared/ReactFeatureFlags';\r\nimport is from 'shared/objectIs';\r\n\r\ntype BasicStateAction<S> = (S => S) | S;\r\ntype Dispatch<A> = A => void;\r\n\r\ntype Update<A> = {|\r\n  action: A,\r\n  next: Update<A> | null,\r\n|};\r\n\r\ntype UpdateQueue<A> = {|\r\n  last: Update<A> | null,\r\n  dispatch: any,\r\n|};\r\n\r\ntype Hook = {|\r\n  memoizedState: any,\r\n  queue: UpdateQueue<any> | null,\r\n  next: Hook | null,\r\n|};\r\n\r\nlet currentlyRenderingComponent: Object | null = null;\r\nlet currentlyRenderingTask: Task | null = null;\r\nlet firstWorkInProgressHook: Hook | null = null;\r\nlet workInProgressHook: Hook | null = null;\r\n// Whether the work-in-progress hook is a re-rendered hook\r\nlet isReRender: boolean = false;\r\n// Whether an update was scheduled during the currently executing render pass.\r\nlet didScheduleRenderPhaseUpdate: boolean = false;\r\n// Counts the number of useId hooks in this component\r\nlet localIdCounter: number = 0;\r\n// Lazily created map of render-phase updates\r\nlet renderPhaseUpdates: Map<UpdateQueue<any>, Update<any>> | null = null;\r\n// Counter to prevent infinite loops.\r\nlet numberOfReRenders: number = 0;\r\nconst RE_RENDER_LIMIT = 25;\r\n\r\nlet isInHookUserCodeInDev = false;\r\n\r\n// In DEV, this is the name of the currently executing primitive hook\r\nlet currentHookNameInDev: ?string;\r\n\r\nfunction resolveCurrentlyRenderingComponent(): Object {\r\n  if (currentlyRenderingComponent === null) {\r\n    throw new Error(\r\n      'Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for' +\r\n        ' one of the following reasons:\\n' +\r\n        '1. You might have mismatching versions of React and the renderer (such as React DOM)\\n' +\r\n        '2. You might be breaking the Rules of Hooks\\n' +\r\n        '3. You might have more than one copy of React in the same app\\n' +\r\n        'See https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.',\r\n    );\r\n  }\r\n\r\n  if (__DEV__) {\r\n    if (isInHookUserCodeInDev) {\r\n      console.error(\r\n        'Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks. ' +\r\n          'You can only call Hooks at the top level of your React function. ' +\r\n          'For more information, see ' +\r\n          'https://reactjs.org/link/rules-of-hooks',\r\n      );\r\n    }\r\n  }\r\n  return currentlyRenderingComponent;\r\n}\r\n\r\nfunction areHookInputsEqual(\r\n  nextDeps: Array<mixed>,\r\n  prevDeps: Array<mixed> | null,\r\n) {\r\n  if (prevDeps === null) {\r\n    if (__DEV__) {\r\n      console.error(\r\n        '%s received a final argument during this render, but not during ' +\r\n          'the previous render. Even though the final argument is optional, ' +\r\n          'its type cannot change between renders.',\r\n        currentHookNameInDev,\r\n      );\r\n    }\r\n    return false;\r\n  }\r\n\r\n  if (__DEV__) {\r\n    // Don't bother comparing lengths in prod because these arrays should be\r\n    // passed inline.\r\n    if (nextDeps.length !== prevDeps.length) {\r\n      console.error(\r\n        'The final argument passed to %s changed size between renders. The ' +\r\n          'order and size of this array must remain constant.\\n\\n' +\r\n          'Previous: %s\\n' +\r\n          'Incoming: %s',\r\n        currentHookNameInDev,\r\n        `[${nextDeps.join(', ')}]`,\r\n        `[${prevDeps.join(', ')}]`,\r\n      );\r\n    }\r\n  }\r\n  for (let i = 0; i < prevDeps.length && i < nextDeps.length; i++) {\r\n    if (is(nextDeps[i], prevDeps[i])) {\r\n      continue;\r\n    }\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction createHook(): Hook {\r\n  if (numberOfReRenders > 0) {\r\n    throw new Error('Rendered more hooks than during the previous render');\r\n  }\r\n  return {\r\n    memoizedState: null,\r\n    queue: null,\r\n    next: null,\r\n  };\r\n}\r\n\r\nfunction createWorkInProgressHook(): Hook {\r\n  if (workInProgressHook === null) {\r\n    // This is the first hook in the list\r\n    if (firstWorkInProgressHook === null) {\r\n      isReRender = false;\r\n      firstWorkInProgressHook = workInProgressHook = createHook();\r\n    } else {\r\n      // There's already a work-in-progress. Reuse it.\r\n      isReRender = true;\r\n      workInProgressHook = firstWorkInProgressHook;\r\n    }\r\n  } else {\r\n    if (workInProgressHook.next === null) {\r\n      isReRender = false;\r\n      // Append to the end of the list\r\n      workInProgressHook = workInProgressHook.next = createHook();\r\n    } else {\r\n      // There's already a work-in-progress. Reuse it.\r\n      isReRender = true;\r\n      workInProgressHook = workInProgressHook.next;\r\n    }\r\n  }\r\n  return workInProgressHook;\r\n}\r\n\r\nexport function prepareToUseHooks(task: Task, componentIdentity: Object): void {\r\n  currentlyRenderingComponent = componentIdentity;\r\n  currentlyRenderingTask = task;\r\n  if (__DEV__) {\r\n    isInHookUserCodeInDev = false;\r\n  }\r\n\r\n  // The following should have already been reset\r\n  // didScheduleRenderPhaseUpdate = false;\r\n  // localIdCounter = 0;\r\n  // firstWorkInProgressHook = null;\r\n  // numberOfReRenders = 0;\r\n  // renderPhaseUpdates = null;\r\n  // workInProgressHook = null;\r\n\r\n  localIdCounter = 0;\r\n}\r\n\r\nexport function finishHooks(\r\n  Component: any,\r\n  props: any,\r\n  children: any,\r\n  refOrContext: any,\r\n): any {\r\n  // This must be called after every function component to prevent hooks from\r\n  // being used in classes.\r\n\r\n  while (didScheduleRenderPhaseUpdate) {\r\n    // Updates were scheduled during the render phase. They are stored in\r\n    // the `renderPhaseUpdates` map. Call the component again, reusing the\r\n    // work-in-progress hooks and applying the additional updates on top. Keep\r\n    // restarting until no more updates are scheduled.\r\n    didScheduleRenderPhaseUpdate = false;\r\n    localIdCounter = 0;\r\n    numberOfReRenders += 1;\r\n\r\n    // Start over from the beginning of the list\r\n    workInProgressHook = null;\r\n\r\n    children = Component(props, refOrContext);\r\n  }\r\n  resetHooksState();\r\n  return children;\r\n}\r\n\r\nexport function checkDidRenderIdHook() {\r\n  // This should be called immediately after every finishHooks call.\r\n  // Conceptually, it's part of the return value of finishHooks; it's only a\r\n  // separate function to avoid using an array tuple.\r\n  const didRenderIdHook = localIdCounter !== 0;\r\n  return didRenderIdHook;\r\n}\r\n\r\n// Reset the internal hooks state if an error occurs while rendering a component\r\nexport function resetHooksState(): void {\r\n  if (__DEV__) {\r\n    isInHookUserCodeInDev = false;\r\n  }\r\n\r\n  currentlyRenderingComponent = null;\r\n  currentlyRenderingTask = null;\r\n  didScheduleRenderPhaseUpdate = false;\r\n  firstWorkInProgressHook = null;\r\n  numberOfReRenders = 0;\r\n  renderPhaseUpdates = null;\r\n  workInProgressHook = null;\r\n}\r\n\r\nfunction getCacheForType<T>(resourceType: () => T): T {\r\n  // TODO: This should silently mark this as client rendered since it's not necessarily\r\n  // considered an error. It needs to work for things like Flight though.\r\n  throw new Error('Not implemented.');\r\n}\r\n\r\nfunction readContext<T>(context: ReactContext<T>): T {\r\n  if (__DEV__) {\r\n    if (isInHookUserCodeInDev) {\r\n      console.error(\r\n        'Context can only be read while React is rendering. ' +\r\n          'In classes, you can read it in the render method or getDerivedStateFromProps. ' +\r\n          'In function components, you can read it directly in the function body, but not ' +\r\n          'inside Hooks like useReducer() or useMemo().',\r\n      );\r\n    }\r\n  }\r\n  return readContextImpl(context);\r\n}\r\n\r\nfunction useContext<T>(context: ReactContext<T>): T {\r\n  if (__DEV__) {\r\n    currentHookNameInDev = 'useContext';\r\n  }\r\n  resolveCurrentlyRenderingComponent();\r\n  return readContextImpl(context);\r\n}\r\n\r\nfunction basicStateReducer<S>(state: S, action: BasicStateAction<S>): S {\r\n  // $FlowFixMe: Flow doesn't like mixed types\r\n  return typeof action === 'function' ? action(state) : action;\r\n}\r\n\r\nexport function useState<S>(\r\n  initialState: (() => S) | S,\r\n): [S, Dispatch<BasicStateAction<S>>] {\r\n  if (__DEV__) {\r\n    currentHookNameInDev = 'useState';\r\n  }\r\n  return useReducer(\r\n    basicStateReducer,\r\n    // useReducer has a special case to support lazy useState initializers\r\n    (initialState: any),\r\n  );\r\n}\r\n\r\nexport function useReducer<S, I, A>(\r\n  reducer: (S, A) => S,\r\n  initialArg: I,\r\n  init?: I => S,\r\n): [S, Dispatch<A>] {\r\n  if (__DEV__) {\r\n    if (reducer !== basicStateReducer) {\r\n      currentHookNameInDev = 'useReducer';\r\n    }\r\n  }\r\n  currentlyRenderingComponent = resolveCurrentlyRenderingComponent();\r\n  workInProgressHook = createWorkInProgressHook();\r\n  if (isReRender) {\r\n    // This is a re-render. Apply the new render phase updates to the previous\r\n    // current hook.\r\n    const queue: UpdateQueue<A> = (workInProgressHook.queue: any);\r\n    const dispatch: Dispatch<A> = (queue.dispatch: any);\r\n    if (renderPhaseUpdates !== null) {\r\n      // Render phase updates are stored in a map of queue -> linked list\r\n      const firstRenderPhaseUpdate = renderPhaseUpdates.get(queue);\r\n      if (firstRenderPhaseUpdate !== undefined) {\r\n        renderPhaseUpdates.delete(queue);\r\n        let newState = workInProgressHook.memoizedState;\r\n        let update = firstRenderPhaseUpdate;\r\n        do {\r\n          // Process this render phase update. We don't have to check the\r\n          // priority because it will always be the same as the current\r\n          // render's.\r\n          const action = update.action;\r\n          if (__DEV__) {\r\n            isInHookUserCodeInDev = true;\r\n          }\r\n          newState = reducer(newState, action);\r\n          if (__DEV__) {\r\n            isInHookUserCodeInDev = false;\r\n          }\r\n          update = update.next;\r\n        } while (update !== null);\r\n\r\n        workInProgressHook.memoizedState = newState;\r\n\r\n        return [newState, dispatch];\r\n      }\r\n    }\r\n    return [workInProgressHook.memoizedState, dispatch];\r\n  } else {\r\n    if (__DEV__) {\r\n      isInHookUserCodeInDev = true;\r\n    }\r\n    let initialState;\r\n    if (reducer === basicStateReducer) {\r\n      // Special case for `useState`.\r\n      initialState =\r\n        typeof initialArg === 'function'\r\n          ? ((initialArg: any): () => S)()\r\n          : ((initialArg: any): S);\r\n    } else {\r\n      initialState =\r\n        init !== undefined ? init(initialArg) : ((initialArg: any): S);\r\n    }\r\n    if (__DEV__) {\r\n      isInHookUserCodeInDev = false;\r\n    }\r\n    workInProgressHook.memoizedState = initialState;\r\n    const queue: UpdateQueue<A> = (workInProgressHook.queue = {\r\n      last: null,\r\n      dispatch: null,\r\n    });\r\n    const dispatch: Dispatch<A> = (queue.dispatch = (dispatchAction.bind(\r\n      null,\r\n      currentlyRenderingComponent,\r\n      queue,\r\n    ): any));\r\n    return [workInProgressHook.memoizedState, dispatch];\r\n  }\r\n}\r\n\r\nfunction useMemo<T>(nextCreate: () => T, deps: Array<mixed> | void | null): T {\r\n  currentlyRenderingComponent = resolveCurrentlyRenderingComponent();\r\n  workInProgressHook = createWorkInProgressHook();\r\n\r\n  const nextDeps = deps === undefined ? null : deps;\r\n\r\n  if (workInProgressHook !== null) {\r\n    const prevState = workInProgressHook.memoizedState;\r\n    if (prevState !== null) {\r\n      if (nextDeps !== null) {\r\n        const prevDeps = prevState[1];\r\n        if (areHookInputsEqual(nextDeps, prevDeps)) {\r\n          return prevState[0];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  if (__DEV__) {\r\n    isInHookUserCodeInDev = true;\r\n  }\r\n  const nextValue = nextCreate();\r\n  if (__DEV__) {\r\n    isInHookUserCodeInDev = false;\r\n  }\r\n  workInProgressHook.memoizedState = [nextValue, nextDeps];\r\n  return nextValue;\r\n}\r\n\r\nfunction useRef<T>(initialValue: T): {|current: T|} {\r\n  currentlyRenderingComponent = resolveCurrentlyRenderingComponent();\r\n  workInProgressHook = createWorkInProgressHook();\r\n  const previousRef = workInProgressHook.memoizedState;\r\n  if (previousRef === null) {\r\n    const ref = {current: initialValue};\r\n    if (__DEV__) {\r\n      Object.seal(ref);\r\n    }\r\n    workInProgressHook.memoizedState = ref;\r\n    return ref;\r\n  } else {\r\n    return previousRef;\r\n  }\r\n}\r\n\r\nexport function useLayoutEffect(\r\n  create: () => (() => void) | void,\r\n  inputs: Array<mixed> | void | null,\r\n) {\r\n  if (__DEV__) {\r\n    currentHookNameInDev = 'useLayoutEffect';\r\n    console.error(\r\n      'useLayoutEffect does nothing on the server, because its effect cannot ' +\r\n        \"be encoded into the server renderer's output format. This will lead \" +\r\n        'to a mismatch between the initial, non-hydrated UI and the intended ' +\r\n        'UI. To avoid this, useLayoutEffect should only be used in ' +\r\n        'components that render exclusively on the client. ' +\r\n        'See https://reactjs.org/link/uselayouteffect-ssr for common fixes.',\r\n    );\r\n  }\r\n}\r\n\r\nfunction dispatchAction<A>(\r\n  componentIdentity: Object,\r\n  queue: UpdateQueue<A>,\r\n  action: A,\r\n) {\r\n  if (numberOfReRenders >= RE_RENDER_LIMIT) {\r\n    throw new Error(\r\n      'Too many re-renders. React limits the number of renders to prevent ' +\r\n        'an infinite loop.',\r\n    );\r\n  }\r\n\r\n  if (componentIdentity === currentlyRenderingComponent) {\r\n    // This is a render phase update. Stash it in a lazily-created map of\r\n    // queue -> linked list of updates. After this render pass, we'll restart\r\n    // and apply the stashed updates on top of the work-in-progress hook.\r\n    didScheduleRenderPhaseUpdate = true;\r\n    const update: Update<A> = {\r\n      action,\r\n      next: null,\r\n    };\r\n    if (renderPhaseUpdates === null) {\r\n      renderPhaseUpdates = new Map();\r\n    }\r\n    const firstRenderPhaseUpdate = renderPhaseUpdates.get(queue);\r\n    if (firstRenderPhaseUpdate === undefined) {\r\n      renderPhaseUpdates.set(queue, update);\r\n    } else {\r\n      // Append the update to the end of the list.\r\n      let lastRenderPhaseUpdate = firstRenderPhaseUpdate;\r\n      while (lastRenderPhaseUpdate.next !== null) {\r\n        lastRenderPhaseUpdate = lastRenderPhaseUpdate.next;\r\n      }\r\n      lastRenderPhaseUpdate.next = update;\r\n    }\r\n  } else {\r\n    // This means an update has happened after the function component has\r\n    // returned. On the server this is a no-op. In React Fiber, the update\r\n    // would be scheduled for a future render.\r\n  }\r\n}\r\n\r\nexport function useCallback<T>(\r\n  callback: T,\r\n  deps: Array<mixed> | void | null,\r\n): T {\r\n  return useMemo(() => callback, deps);\r\n}\r\n\r\n// TODO Decide on how to implement this hook for server rendering.\r\n// If a mutation occurs during render, consider triggering a Suspense boundary\r\n// and falling back to client rendering.\r\nfunction useMutableSource<Source, Snapshot>(\r\n  source: MutableSource<Source>,\r\n  getSnapshot: MutableSourceGetSnapshotFn<Source, Snapshot>,\r\n  subscribe: MutableSourceSubscribeFn<Source, Snapshot>,\r\n): Snapshot {\r\n  resolveCurrentlyRenderingComponent();\r\n  return getSnapshot(source._source);\r\n}\r\n\r\nfunction useSyncExternalStore<T>(\r\n  subscribe: (() => void) => () => void,\r\n  getSnapshot: () => T,\r\n  getServerSnapshot?: () => T,\r\n): T {\r\n  if (getServerSnapshot === undefined) {\r\n    throw new Error(\r\n      'Missing getServerSnapshot, which is required for ' +\r\n        'server-rendered content. Will revert to client rendering.',\r\n    );\r\n  }\r\n  return getServerSnapshot();\r\n}\r\n\r\nfunction useDeferredValue<T>(value: T): T {\r\n  resolveCurrentlyRenderingComponent();\r\n  return value;\r\n}\r\n\r\nfunction unsupportedStartTransition() {\r\n  throw new Error('startTransition cannot be called during server rendering.');\r\n}\r\n\r\nfunction useTransition(): [\r\n  boolean,\r\n  (callback: () => void, options?: StartTransitionOptions) => void,\r\n] {\r\n  resolveCurrentlyRenderingComponent();\r\n  return [false, unsupportedStartTransition];\r\n}\r\n\r\nfunction useId(): string {\r\n  const task: Task = (currentlyRenderingTask: any);\r\n  const treeId = getTreeId(task.treeContext);\r\n\r\n  const responseState = currentResponseState;\r\n  if (responseState === null) {\r\n    throw new Error(\r\n      'Invalid hook call. Hooks can only be called inside of the body of a function component.',\r\n    );\r\n  }\r\n\r\n  const localId = localIdCounter++;\r\n  return makeId(responseState, treeId, localId);\r\n}\r\n\r\nfunction unsupportedRefresh() {\r\n  throw new Error('Cache cannot be refreshed during server rendering.');\r\n}\r\n\r\nfunction useCacheRefresh(): <T>(?() => T, ?T) => void {\r\n  return unsupportedRefresh;\r\n}\r\n\r\nfunction noop(): void {}\r\n\r\nexport const Dispatcher: DispatcherType = {\r\n  readContext,\r\n  useContext,\r\n  useMemo,\r\n  useReducer,\r\n  useRef,\r\n  useState,\r\n  useInsertionEffect: noop,\r\n  useLayoutEffect,\r\n  useCallback,\r\n  // useImperativeHandle is not run in the server environment\r\n  useImperativeHandle: noop,\r\n  // Effects are not run in the server environment.\r\n  useEffect: noop,\r\n  // Debugging effect\r\n  useDebugValue: noop,\r\n  useDeferredValue,\r\n  useTransition,\r\n  useId,\r\n  // Subscriptions are not setup in a server environment.\r\n  useMutableSource,\r\n  useSyncExternalStore,\r\n};\r\n\r\nif (enableCache) {\r\n  Dispatcher.getCacheForType = getCacheForType;\r\n  Dispatcher.useCacheRefresh = useCacheRefresh;\r\n}\r\n\r\nexport let currentResponseState: null | ResponseState = (null: any);\r\nexport function setCurrentResponseState(\r\n  responseState: null | ResponseState,\r\n): void {\r\n  currentResponseState = responseState;\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport type {\r\n  Destination,\r\n  Chunk,\r\n  PrecomputedChunk,\r\n} from './ReactServerStreamConfig';\r\nimport type {\r\n  ReactNodeList,\r\n  ReactContext,\r\n  ReactProviderType,\r\n} from 'shared/ReactTypes';\r\nimport type {LazyComponent as LazyComponentType} from 'react/src/ReactLazy';\r\nimport type {\r\n  SuspenseBoundaryID,\r\n  ResponseState,\r\n  FormatContext,\r\n} from './ReactServerFormatConfig';\r\nimport type {ContextSnapshot} from './ReactFizzNewContext';\r\nimport type {ComponentStackNode} from './ReactFizzComponentStack';\r\nimport type {TreeContext} from './ReactFizzTreeContext';\r\n\r\nimport {\r\n  scheduleWork,\r\n  beginWriting,\r\n  writeChunk,\r\n  writeChunkAndReturn,\r\n  completeWriting,\r\n  flushBuffered,\r\n  close,\r\n  closeWithError,\r\n} from './ReactServerStreamConfig';\r\nimport {\r\n  writeCompletedRoot,\r\n  writePlaceholder,\r\n  writeStartCompletedSuspenseBoundary,\r\n  writeStartPendingSuspenseBoundary,\r\n  writeStartClientRenderedSuspenseBoundary,\r\n  writeEndCompletedSuspenseBoundary,\r\n  writeEndPendingSuspenseBoundary,\r\n  writeEndClientRenderedSuspenseBoundary,\r\n  writeStartSegment,\r\n  writeEndSegment,\r\n  writeClientRenderBoundaryInstruction,\r\n  writeCompletedBoundaryInstruction,\r\n  writeCompletedSegmentInstruction,\r\n  pushTextInstance,\r\n  pushStartInstance,\r\n  pushEndInstance,\r\n  pushStartCompletedSuspenseBoundary,\r\n  pushEndCompletedSuspenseBoundary,\r\n  pushSegmentFinale,\r\n  UNINITIALIZED_SUSPENSE_BOUNDARY_ID,\r\n  assignSuspenseBoundaryID,\r\n  getChildFormatContext,\r\n} from './ReactServerFormatConfig';\r\nimport {\r\n  constructClassInstance,\r\n  mountClassInstance,\r\n} from './ReactFizzClassComponent';\r\nimport {\r\n  getMaskedContext,\r\n  processChildContext,\r\n  emptyContextObject,\r\n} from './ReactFizzContext';\r\nimport {\r\n  readContext,\r\n  rootContextSnapshot,\r\n  switchContext,\r\n  getActiveContext,\r\n  pushProvider,\r\n  popProvider,\r\n} from './ReactFizzNewContext';\r\nimport {\r\n  prepareToUseHooks,\r\n  finishHooks,\r\n  checkDidRenderIdHook,\r\n  resetHooksState,\r\n  Dispatcher,\r\n  currentResponseState,\r\n  setCurrentResponseState,\r\n} from './ReactFizzHooks';\r\nimport {getStackByComponentStackNode} from './ReactFizzComponentStack';\r\nimport {emptyTreeContext, pushTreeContext} from './ReactFizzTreeContext';\r\n\r\nimport {\r\n  getIteratorFn,\r\n  REACT_ELEMENT_TYPE,\r\n  REACT_PORTAL_TYPE,\r\n  REACT_LAZY_TYPE,\r\n  REACT_SUSPENSE_TYPE,\r\n  REACT_LEGACY_HIDDEN_TYPE,\r\n  REACT_DEBUG_TRACING_MODE_TYPE,\r\n  REACT_STRICT_MODE_TYPE,\r\n  REACT_PROFILER_TYPE,\r\n  REACT_SUSPENSE_LIST_TYPE,\r\n  REACT_FRAGMENT_TYPE,\r\n  REACT_FORWARD_REF_TYPE,\r\n  REACT_MEMO_TYPE,\r\n  REACT_PROVIDER_TYPE,\r\n  REACT_CONTEXT_TYPE,\r\n  REACT_SCOPE_TYPE,\r\n} from 'shared/ReactSymbols';\r\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\r\nimport {\r\n  disableLegacyContext,\r\n  disableModulePatternComponents,\r\n  warnAboutDefaultPropsOnFunctionComponents,\r\n  enableScopeAPI,\r\n  enableSuspenseAvoidThisFallbackFizz,\r\n} from 'shared/ReactFeatureFlags';\r\n\r\nimport assign from 'shared/assign';\r\nimport getComponentNameFromType from 'shared/getComponentNameFromType';\r\nimport isArray from 'shared/isArray';\r\n\r\nconst ReactCurrentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\r\nconst ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\r\n\r\ntype LegacyContext = {\r\n  [key: string]: any,\r\n};\r\n\r\ntype SuspenseBoundary = {\r\n  id: SuspenseBoundaryID,\r\n  rootSegmentID: number,\r\n  errorDigest: ?string, // the error hash if it errors\r\n  errorMessage?: string, // the error string if it errors\r\n  errorComponentStack?: string, // the error component stack if it errors\r\n  forceClientRender: boolean, // if it errors or infinitely suspends\r\n  parentFlushed: boolean,\r\n  pendingTasks: number, // when it reaches zero we can show this boundary's content\r\n  completedSegments: Array<Segment>, // completed but not yet flushed segments.\r\n  byteSize: number, // used to determine whether to inline children boundaries.\r\n  fallbackAbortableTasks: Set<Task>, // used to cancel task on the fallback if the boundary completes or gets canceled.\r\n};\r\n\r\nexport type Task = {\r\n  node: ReactNodeList,\r\n  ping: () => void,\r\n  blockedBoundary: Root | SuspenseBoundary,\r\n  blockedSegment: Segment, // the segment we'll write to\r\n  abortSet: Set<Task>, // the abortable set that this task belongs to\r\n  legacyContext: LegacyContext, // the current legacy context that this task is executing in\r\n  context: ContextSnapshot, // the current new context that this task is executing in\r\n  treeContext: TreeContext, // the current tree context that this task is executing in\r\n  componentStack: null | ComponentStackNode, // DEV-only component stack\r\n};\r\n\r\nconst PENDING = 0;\r\nconst COMPLETED = 1;\r\nconst FLUSHED = 2;\r\nconst ABORTED = 3;\r\nconst ERRORED = 4;\r\n\r\ntype Root = null;\r\n\r\ntype Segment = {\r\n  status: 0 | 1 | 2 | 3 | 4,\r\n  parentFlushed: boolean, // typically a segment will be flushed by its parent, except if its parent was already flushed\r\n  id: number, // starts as 0 and is lazily assigned if the parent flushes early\r\n  +index: number, // the index within the parent's chunks or 0 at the root\r\n  +chunks: Array<Chunk | PrecomputedChunk>,\r\n  +children: Array<Segment>,\r\n  // The context that this segment was created in.\r\n  formatContext: FormatContext,\r\n  // If this segment represents a fallback, this is the content that will replace that fallback.\r\n  +boundary: null | SuspenseBoundary,\r\n  // used to discern when text separator boundaries are needed\r\n  lastPushedText: boolean,\r\n  textEmbedded: boolean,\r\n};\r\n\r\nconst OPEN = 0;\r\nconst CLOSING = 1;\r\nconst CLOSED = 2;\r\n\r\nexport opaque type Request = {\r\n  destination: null | Destination,\r\n  +responseState: ResponseState,\r\n  +progressiveChunkSize: number,\r\n  status: 0 | 1 | 2,\r\n  fatalError: mixed,\r\n  nextSegmentId: number,\r\n  allPendingTasks: number, // when it reaches zero, we can close the connection.\r\n  pendingRootTasks: number, // when this reaches zero, we've finished at least the root boundary.\r\n  completedRootSegment: null | Segment, // Completed but not yet flushed root segments.\r\n  abortableTasks: Set<Task>,\r\n  pingedTasks: Array<Task>,\r\n  // Queues to flush in order of priority\r\n  clientRenderedBoundaries: Array<SuspenseBoundary>, // Errored or client rendered but not yet flushed.\r\n  completedBoundaries: Array<SuspenseBoundary>, // Completed but not yet fully flushed boundaries to show.\r\n  partialBoundaries: Array<SuspenseBoundary>, // Partially completed boundaries that can flush its segments early.\r\n  // onError is called when an error happens anywhere in the tree. It might recover.\r\n  // The return string is used in production  primarily to avoid leaking internals, secondarily to save bytes.\r\n  // Returning null/undefined will cause a defualt error message in production\r\n  onError: (error: mixed) => ?string,\r\n  // onAllReady is called when all pending task is done but it may not have flushed yet.\r\n  // This is a good time to start writing if you want only HTML and no intermediate steps.\r\n  onAllReady: () => void,\r\n  // onShellReady is called when there is at least a root fallback ready to show.\r\n  // Typically you don't need this callback because it's best practice to always have a\r\n  // root fallback ready so there's no need to wait.\r\n  onShellReady: () => void,\r\n  // onShellError is called when the shell didn't complete. That means you probably want to\r\n  // emit a different response to the stream instead.\r\n  onShellError: (error: mixed) => void,\r\n  onFatalError: (error: mixed) => void,\r\n};\r\n\r\n// This is a default heuristic for how to split up the HTML content into progressive\r\n// loading. Our goal is to be able to display additional new content about every 500ms.\r\n// Faster than that is unnecessary and should be throttled on the client. It also\r\n// adds unnecessary overhead to do more splits. We don't know if it's a higher or lower\r\n// end device but higher end suffer less from the overhead than lower end does from\r\n// not getting small enough pieces. We error on the side of low end.\r\n// We base this on low end 3G speeds which is about 500kbits per second. We assume\r\n// that there can be a reasonable drop off from max bandwidth which leaves you with\r\n// as little as 80%. We can receive half of that each 500ms - at best. In practice,\r\n// a little bandwidth is lost to processing and contention - e.g. CSS and images that\r\n// are downloaded along with the main content. So we estimate about half of that to be\r\n// the lower end throughput. In other words, we expect that you can at least show\r\n// about 12.5kb of content per 500ms. Not counting starting latency for the first\r\n// paint.\r\n// 500 * 1024 / 8 * .8 * 0.5 / 2\r\nconst DEFAULT_PROGRESSIVE_CHUNK_SIZE = 12800;\r\n\r\nfunction defaultErrorHandler(error: mixed) {\r\n  console['error'](error); // Don't transform to our wrapper\r\n  return null;\r\n}\r\n\r\nfunction noop(): void {}\r\n\r\nexport function createRequest(\r\n  children: ReactNodeList,\r\n  responseState: ResponseState,\r\n  rootFormatContext: FormatContext,\r\n  progressiveChunkSize: void | number,\r\n  onError: void | ((error: mixed) => ?string),\r\n  onAllReady: void | (() => void),\r\n  onShellReady: void | (() => void),\r\n  onShellError: void | ((error: mixed) => void),\r\n  onFatalError: void | ((error: mixed) => void),\r\n): Request {\r\n  const pingedTasks = [];\r\n  const abortSet: Set<Task> = new Set();\r\n  const request = {\r\n    destination: null,\r\n    responseState,\r\n    progressiveChunkSize:\r\n      progressiveChunkSize === undefined\r\n        ? DEFAULT_PROGRESSIVE_CHUNK_SIZE\r\n        : progressiveChunkSize,\r\n    status: OPEN,\r\n    fatalError: null,\r\n    nextSegmentId: 0,\r\n    allPendingTasks: 0,\r\n    pendingRootTasks: 0,\r\n    completedRootSegment: null,\r\n    abortableTasks: abortSet,\r\n    pingedTasks: pingedTasks,\r\n    clientRenderedBoundaries: [],\r\n    completedBoundaries: [],\r\n    partialBoundaries: [],\r\n    onError: onError === undefined ? defaultErrorHandler : onError,\r\n    onAllReady: onAllReady === undefined ? noop : onAllReady,\r\n    onShellReady: onShellReady === undefined ? noop : onShellReady,\r\n    onShellError: onShellError === undefined ? noop : onShellError,\r\n    onFatalError: onFatalError === undefined ? noop : onFatalError,\r\n  };\r\n  // This segment represents the root fallback.\r\n  const rootSegment = createPendingSegment(\r\n    request,\r\n    0,\r\n    null,\r\n    rootFormatContext,\r\n    // Root segments are never embedded in Text on either edge\r\n    false,\r\n    false,\r\n  );\r\n  // There is no parent so conceptually, we're unblocked to flush this segment.\r\n  rootSegment.parentFlushed = true;\r\n  const rootTask = createTask(\r\n    request,\r\n    children,\r\n    null,\r\n    rootSegment,\r\n    abortSet,\r\n    emptyContextObject,\r\n    rootContextSnapshot,\r\n    emptyTreeContext,\r\n  );\r\n  pingedTasks.push(rootTask);\r\n  return request;\r\n}\r\n\r\nfunction pingTask(request: Request, task: Task): void {\r\n  const pingedTasks = request.pingedTasks;\r\n  pingedTasks.push(task);\r\n  if (pingedTasks.length === 1) {\r\n    scheduleWork(() => performWork(request));\r\n  }\r\n}\r\n\r\nfunction createSuspenseBoundary(\r\n  request: Request,\r\n  fallbackAbortableTasks: Set<Task>,\r\n): SuspenseBoundary {\r\n  return {\r\n    id: UNINITIALIZED_SUSPENSE_BOUNDARY_ID,\r\n    rootSegmentID: -1,\r\n    parentFlushed: false,\r\n    pendingTasks: 0,\r\n    forceClientRender: false,\r\n    completedSegments: [],\r\n    byteSize: 0,\r\n    fallbackAbortableTasks,\r\n    errorDigest: null,\r\n  };\r\n}\r\n\r\nfunction createTask(\r\n  request: Request,\r\n  node: ReactNodeList,\r\n  blockedBoundary: Root | SuspenseBoundary,\r\n  blockedSegment: Segment,\r\n  abortSet: Set<Task>,\r\n  legacyContext: LegacyContext,\r\n  context: ContextSnapshot,\r\n  treeContext: TreeContext,\r\n): Task {\r\n  request.allPendingTasks++;\r\n  if (blockedBoundary === null) {\r\n    request.pendingRootTasks++;\r\n  } else {\r\n    blockedBoundary.pendingTasks++;\r\n  }\r\n  const task: Task = ({\r\n    node,\r\n    ping: () => pingTask(request, task),\r\n    blockedBoundary,\r\n    blockedSegment,\r\n    abortSet,\r\n    legacyContext,\r\n    context,\r\n    treeContext,\r\n  }: any);\r\n  if (__DEV__) {\r\n    task.componentStack = null;\r\n  }\r\n  abortSet.add(task);\r\n  return task;\r\n}\r\n\r\nfunction createPendingSegment(\r\n  request: Request,\r\n  index: number,\r\n  boundary: null | SuspenseBoundary,\r\n  formatContext: FormatContext,\r\n  lastPushedText: boolean,\r\n  textEmbedded: boolean,\r\n): Segment {\r\n  return {\r\n    status: PENDING,\r\n    id: -1, // lazily assigned later\r\n    index,\r\n    parentFlushed: false,\r\n    chunks: [],\r\n    children: [],\r\n    formatContext,\r\n    boundary,\r\n    lastPushedText,\r\n    textEmbedded,\r\n  };\r\n}\r\n\r\n// DEV-only global reference to the currently executing task\r\nlet currentTaskInDEV: null | Task = null;\r\nfunction getCurrentStackInDEV(): string {\r\n  if (__DEV__) {\r\n    if (currentTaskInDEV === null || currentTaskInDEV.componentStack === null) {\r\n      return '';\r\n    }\r\n    return getStackByComponentStackNode(currentTaskInDEV.componentStack);\r\n  }\r\n  return '';\r\n}\r\n\r\nfunction pushBuiltInComponentStackInDEV(task: Task, type: string): void {\r\n  if (__DEV__) {\r\n    task.componentStack = {\r\n      tag: 0,\r\n      parent: task.componentStack,\r\n      type,\r\n    };\r\n  }\r\n}\r\nfunction pushFunctionComponentStackInDEV(task: Task, type: Function): void {\r\n  if (__DEV__) {\r\n    task.componentStack = {\r\n      tag: 1,\r\n      parent: task.componentStack,\r\n      type,\r\n    };\r\n  }\r\n}\r\nfunction pushClassComponentStackInDEV(task: Task, type: Function): void {\r\n  if (__DEV__) {\r\n    task.componentStack = {\r\n      tag: 2,\r\n      parent: task.componentStack,\r\n      type,\r\n    };\r\n  }\r\n}\r\nfunction popComponentStackInDEV(task: Task): void {\r\n  if (__DEV__) {\r\n    if (task.componentStack === null) {\r\n      console.error(\r\n        'Unexpectedly popped too many stack frames. This is a bug in React.',\r\n      );\r\n    } else {\r\n      task.componentStack = task.componentStack.parent;\r\n    }\r\n  }\r\n}\r\n\r\n// stash the component stack of an unwinding error until it is processed\r\nlet lastBoundaryErrorComponentStackDev: ?string = null;\r\n\r\nfunction captureBoundaryErrorDetailsDev(\r\n  boundary: SuspenseBoundary,\r\n  error: mixed,\r\n) {\r\n  if (__DEV__) {\r\n    let errorMessage;\r\n    if (typeof error === 'string') {\r\n      errorMessage = error;\r\n    } else if (error && typeof error.message === 'string') {\r\n      errorMessage = error.message;\r\n    } else {\r\n      // eslint-disable-next-line react-internal/safe-string-coercion\r\n      errorMessage = String(error);\r\n    }\r\n\r\n    const errorComponentStack =\r\n      lastBoundaryErrorComponentStackDev || getCurrentStackInDEV();\r\n    lastBoundaryErrorComponentStackDev = null;\r\n\r\n    boundary.errorMessage = errorMessage;\r\n    boundary.errorComponentStack = errorComponentStack;\r\n  }\r\n}\r\n\r\nfunction logRecoverableError(request: Request, error: any): ?string {\r\n  // If this callback errors, we intentionally let that error bubble up to become a fatal error\r\n  // so that someone fixes the error reporting instead of hiding it.\r\n  const errorDigest = request.onError(error);\r\n  if (errorDigest != null && typeof errorDigest !== 'string') {\r\n    // eslint-disable-next-line react-internal/prod-error-codes\r\n    throw new Error(\r\n      `onError returned something with a type other than \"string\". onError should return a string and may return null or undefined but must not return anything else. It received something of type \"${typeof errorDigest}\" instead`,\r\n    );\r\n  }\r\n  return errorDigest;\r\n}\r\n\r\nfunction fatalError(request: Request, error: mixed): void {\r\n  // This is called outside error handling code such as if the root errors outside\r\n  // a suspense boundary or if the root suspense boundary's fallback errors.\r\n  // It's also called if React itself or its host configs errors.\r\n  const onShellError = request.onShellError;\r\n  onShellError(error);\r\n  const onFatalError = request.onFatalError;\r\n  onFatalError(error);\r\n  if (request.destination !== null) {\r\n    request.status = CLOSED;\r\n    closeWithError(request.destination, error);\r\n  } else {\r\n    request.status = CLOSING;\r\n    request.fatalError = error;\r\n  }\r\n}\r\n\r\nfunction renderSuspenseBoundary(\r\n  request: Request,\r\n  task: Task,\r\n  props: Object,\r\n): void {\r\n  pushBuiltInComponentStackInDEV(task, 'Suspense');\r\n  const parentBoundary = task.blockedBoundary;\r\n  const parentSegment = task.blockedSegment;\r\n\r\n  // Each time we enter a suspense boundary, we split out into a new segment for\r\n  // the fallback so that we can later replace that segment with the content.\r\n  // This also lets us split out the main content even if it doesn't suspend,\r\n  // in case it ends up generating a large subtree of content.\r\n  const fallback: ReactNodeList = props.fallback;\r\n  const content: ReactNodeList = props.children;\r\n\r\n  const fallbackAbortSet: Set<Task> = new Set();\r\n  const newBoundary = createSuspenseBoundary(request, fallbackAbortSet);\r\n  const insertionIndex = parentSegment.chunks.length;\r\n  // The children of the boundary segment is actually the fallback.\r\n  const boundarySegment = createPendingSegment(\r\n    request,\r\n    insertionIndex,\r\n    newBoundary,\r\n    parentSegment.formatContext,\r\n    // boundaries never require text embedding at their edges because comment nodes bound them\r\n    false,\r\n    false,\r\n  );\r\n  parentSegment.children.push(boundarySegment);\r\n  // The parentSegment has a child Segment at this index so we reset the lastPushedText marker on the parent\r\n  parentSegment.lastPushedText = false;\r\n\r\n  // This segment is the actual child content. We can start rendering that immediately.\r\n  const contentRootSegment = createPendingSegment(\r\n    request,\r\n    0,\r\n    null,\r\n    parentSegment.formatContext,\r\n    // boundaries never require text embedding at their edges because comment nodes bound them\r\n    false,\r\n    false,\r\n  );\r\n  // We mark the root segment as having its parent flushed. It's not really flushed but there is\r\n  // no parent segment so there's nothing to wait on.\r\n  contentRootSegment.parentFlushed = true;\r\n\r\n  // Currently this is running synchronously. We could instead schedule this to pingedTasks.\r\n  // I suspect that there might be some efficiency benefits from not creating the suspended task\r\n  // and instead just using the stack if possible.\r\n  // TODO: Call this directly instead of messing with saving and restoring contexts.\r\n\r\n  // We can reuse the current context and task to render the content immediately without\r\n  // context switching. We just need to temporarily switch which boundary and which segment\r\n  // we're writing to. If something suspends, it'll spawn new suspended task with that context.\r\n  task.blockedBoundary = newBoundary;\r\n  task.blockedSegment = contentRootSegment;\r\n  try {\r\n    // We use the safe form because we don't handle suspending here. Only error handling.\r\n    renderNode(request, task, content);\r\n    pushSegmentFinale(\r\n      contentRootSegment.chunks,\r\n      request.responseState,\r\n      contentRootSegment.lastPushedText,\r\n      contentRootSegment.textEmbedded,\r\n    );\r\n    contentRootSegment.status = COMPLETED;\r\n    queueCompletedSegment(newBoundary, contentRootSegment);\r\n    if (newBoundary.pendingTasks === 0) {\r\n      // This must have been the last segment we were waiting on. This boundary is now complete.\r\n      // Therefore we won't need the fallback. We early return so that we don't have to create\r\n      // the fallback.\r\n      popComponentStackInDEV(task);\r\n      return;\r\n    }\r\n  } catch (error) {\r\n    contentRootSegment.status = ERRORED;\r\n    newBoundary.forceClientRender = true;\r\n    newBoundary.errorDigest = logRecoverableError(request, error);\r\n    if (__DEV__) {\r\n      captureBoundaryErrorDetailsDev(newBoundary, error);\r\n    }\r\n\r\n    // We don't need to decrement any task numbers because we didn't spawn any new task.\r\n    // We don't need to schedule any task because we know the parent has written yet.\r\n    // We do need to fallthrough to create the fallback though.\r\n  } finally {\r\n    task.blockedBoundary = parentBoundary;\r\n    task.blockedSegment = parentSegment;\r\n  }\r\n\r\n  // We create suspended task for the fallback because we don't want to actually work\r\n  // on it yet in case we finish the main content, so we queue for later.\r\n  const suspendedFallbackTask = createTask(\r\n    request,\r\n    fallback,\r\n    parentBoundary,\r\n    boundarySegment,\r\n    fallbackAbortSet,\r\n    task.legacyContext,\r\n    task.context,\r\n    task.treeContext,\r\n  );\r\n  if (__DEV__) {\r\n    suspendedFallbackTask.componentStack = task.componentStack;\r\n  }\r\n  // TODO: This should be queued at a separate lower priority queue so that we only work\r\n  // on preparing fallbacks if we don't have any more main content to task on.\r\n  request.pingedTasks.push(suspendedFallbackTask);\r\n\r\n  popComponentStackInDEV(task);\r\n}\r\n\r\nfunction renderBackupSuspenseBoundary(\r\n  request: Request,\r\n  task: Task,\r\n  props: Object,\r\n) {\r\n  pushBuiltInComponentStackInDEV(task, 'Suspense');\r\n\r\n  const content = props.children;\r\n  const segment = task.blockedSegment;\r\n\r\n  pushStartCompletedSuspenseBoundary(segment.chunks);\r\n  renderNode(request, task, content);\r\n  pushEndCompletedSuspenseBoundary(segment.chunks);\r\n\r\n  popComponentStackInDEV(task);\r\n}\r\n\r\nfunction renderHostElement(\r\n  request: Request,\r\n  task: Task,\r\n  type: string,\r\n  props: Object,\r\n): void {\r\n  pushBuiltInComponentStackInDEV(task, type);\r\n  const segment = task.blockedSegment;\r\n  const children = pushStartInstance(\r\n    segment.chunks,\r\n    type,\r\n    props,\r\n    request.responseState,\r\n    segment.formatContext,\r\n  );\r\n  segment.lastPushedText = false;\r\n  const prevContext = segment.formatContext;\r\n  segment.formatContext = getChildFormatContext(prevContext, type, props);\r\n  // We use the non-destructive form because if something suspends, we still\r\n  // need to pop back up and finish this subtree of HTML.\r\n  renderNode(request, task, children);\r\n\r\n  // We expect that errors will fatal the whole task and that we don't need\r\n  // the correct context. Therefore this is not in a finally.\r\n  segment.formatContext = prevContext;\r\n  pushEndInstance(segment.chunks, type, props);\r\n  segment.lastPushedText = false;\r\n  popComponentStackInDEV(task);\r\n}\r\n\r\nfunction shouldConstruct(Component) {\r\n  return Component.prototype && Component.prototype.isReactComponent;\r\n}\r\n\r\nfunction renderWithHooks<Props, SecondArg>(\r\n  request: Request,\r\n  task: Task,\r\n  Component: (p: Props, arg: SecondArg) => any,\r\n  props: Props,\r\n  secondArg: SecondArg,\r\n): any {\r\n  const componentIdentity = {};\r\n  prepareToUseHooks(task, componentIdentity);\r\n  const result = Component(props, secondArg);\r\n  return finishHooks(Component, props, result, secondArg);\r\n}\r\n\r\nfunction finishClassComponent(\r\n  request: Request,\r\n  task: Task,\r\n  instance: any,\r\n  Component: any,\r\n  props: any,\r\n): ReactNodeList {\r\n  const nextChildren = instance.render();\r\n\r\n  if (__DEV__) {\r\n    if (instance.props !== props) {\r\n      if (!didWarnAboutReassigningProps) {\r\n        console.error(\r\n          'It looks like %s is reassigning its own `this.props` while rendering. ' +\r\n            'This is not supported and can lead to confusing bugs.',\r\n          getComponentNameFromType(Component) || 'a component',\r\n        );\r\n      }\r\n      didWarnAboutReassigningProps = true;\r\n    }\r\n  }\r\n\r\n  if (!disableLegacyContext) {\r\n    const childContextTypes = Component.childContextTypes;\r\n    if (childContextTypes !== null && childContextTypes !== undefined) {\r\n      const previousContext = task.legacyContext;\r\n      const mergedContext = processChildContext(\r\n        instance,\r\n        Component,\r\n        previousContext,\r\n        childContextTypes,\r\n      );\r\n      task.legacyContext = mergedContext;\r\n      renderNodeDestructive(request, task, nextChildren);\r\n      task.legacyContext = previousContext;\r\n      return;\r\n    }\r\n  }\r\n\r\n  renderNodeDestructive(request, task, nextChildren);\r\n}\r\n\r\nfunction renderClassComponent(\r\n  request: Request,\r\n  task: Task,\r\n  Component: any,\r\n  props: any,\r\n): void {\r\n  pushClassComponentStackInDEV(task, Component);\r\n  const maskedContext = !disableLegacyContext\r\n    ? getMaskedContext(Component, task.legacyContext)\r\n    : undefined;\r\n  const instance = constructClassInstance(Component, props, maskedContext);\r\n  mountClassInstance(instance, Component, props, maskedContext);\r\n  finishClassComponent(request, task, instance, Component, props);\r\n  popComponentStackInDEV(task);\r\n}\r\n\r\nconst didWarnAboutBadClass = {};\r\nconst didWarnAboutModulePatternComponent = {};\r\nconst didWarnAboutContextTypeOnFunctionComponent = {};\r\nconst didWarnAboutGetDerivedStateOnFunctionComponent = {};\r\nlet didWarnAboutReassigningProps = false;\r\nconst didWarnAboutDefaultPropsOnFunctionComponent = {};\r\nlet didWarnAboutGenerators = false;\r\nlet didWarnAboutMaps = false;\r\nlet hasWarnedAboutUsingContextAsConsumer = false;\r\n\r\n// This would typically be a function component but we still support module pattern\r\n// components for some reason.\r\nfunction renderIndeterminateComponent(\r\n  request: Request,\r\n  task: Task,\r\n  Component: any,\r\n  props: any,\r\n): void {\r\n  let legacyContext;\r\n  if (!disableLegacyContext) {\r\n    legacyContext = getMaskedContext(Component, task.legacyContext);\r\n  }\r\n  pushFunctionComponentStackInDEV(task, Component);\r\n\r\n  if (__DEV__) {\r\n    if (\r\n      Component.prototype &&\r\n      typeof Component.prototype.render === 'function'\r\n    ) {\r\n      const componentName = getComponentNameFromType(Component) || 'Unknown';\r\n\r\n      if (!didWarnAboutBadClass[componentName]) {\r\n        console.error(\r\n          \"The <%s /> component appears to have a render method, but doesn't extend React.Component. \" +\r\n            'This is likely to cause errors. Change %s to extend React.Component instead.',\r\n          componentName,\r\n          componentName,\r\n        );\r\n        didWarnAboutBadClass[componentName] = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  const value = renderWithHooks(request, task, Component, props, legacyContext);\r\n  const hasId = checkDidRenderIdHook();\r\n\r\n  if (__DEV__) {\r\n    // Support for module components is deprecated and is removed behind a flag.\r\n    // Whether or not it would crash later, we want to show a good message in DEV first.\r\n    if (\r\n      typeof value === 'object' &&\r\n      value !== null &&\r\n      typeof value.render === 'function' &&\r\n      value.$$typeof === undefined\r\n    ) {\r\n      const componentName = getComponentNameFromType(Component) || 'Unknown';\r\n      if (!didWarnAboutModulePatternComponent[componentName]) {\r\n        console.error(\r\n          'The <%s /> component appears to be a function component that returns a class instance. ' +\r\n            'Change %s to a class that extends React.Component instead. ' +\r\n            \"If you can't use a class try assigning the prototype on the function as a workaround. \" +\r\n            \"`%s.prototype = React.Component.prototype`. Don't use an arrow function since it \" +\r\n            'cannot be called with `new` by React.',\r\n          componentName,\r\n          componentName,\r\n          componentName,\r\n        );\r\n        didWarnAboutModulePatternComponent[componentName] = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (\r\n    // Run these checks in production only if the flag is off.\r\n    // Eventually we'll delete this branch altogether.\r\n    !disableModulePatternComponents &&\r\n    typeof value === 'object' &&\r\n    value !== null &&\r\n    typeof value.render === 'function' &&\r\n    value.$$typeof === undefined\r\n  ) {\r\n    if (__DEV__) {\r\n      const componentName = getComponentNameFromType(Component) || 'Unknown';\r\n      if (!didWarnAboutModulePatternComponent[componentName]) {\r\n        console.error(\r\n          'The <%s /> component appears to be a function component that returns a class instance. ' +\r\n            'Change %s to a class that extends React.Component instead. ' +\r\n            \"If you can't use a class try assigning the prototype on the function as a workaround. \" +\r\n            \"`%s.prototype = React.Component.prototype`. Don't use an arrow function since it \" +\r\n            'cannot be called with `new` by React.',\r\n          componentName,\r\n          componentName,\r\n          componentName,\r\n        );\r\n        didWarnAboutModulePatternComponent[componentName] = true;\r\n      }\r\n    }\r\n\r\n    mountClassInstance(value, Component, props, legacyContext);\r\n    finishClassComponent(request, task, value, Component, props);\r\n  } else {\r\n    // Proceed under the assumption that this is a function component\r\n    if (__DEV__) {\r\n      if (disableLegacyContext && Component.contextTypes) {\r\n        console.error(\r\n          '%s uses the legacy contextTypes API which is no longer supported. ' +\r\n            'Use React.createContext() with React.useContext() instead.',\r\n          getComponentNameFromType(Component) || 'Unknown',\r\n        );\r\n      }\r\n    }\r\n    if (__DEV__) {\r\n      validateFunctionComponentInDev(Component);\r\n    }\r\n    // We're now successfully past this task, and we don't have to pop back to\r\n    // the previous task every again, so we can use the destructive recursive form.\r\n    if (hasId) {\r\n      // This component materialized an id. We treat this as its own level, with\r\n      // a single \"child\" slot.\r\n      const prevTreeContext = task.treeContext;\r\n      const totalChildren = 1;\r\n      const index = 0;\r\n      task.treeContext = pushTreeContext(prevTreeContext, totalChildren, index);\r\n      try {\r\n        renderNodeDestructive(request, task, value);\r\n      } finally {\r\n        task.treeContext = prevTreeContext;\r\n      }\r\n    } else {\r\n      renderNodeDestructive(request, task, value);\r\n    }\r\n  }\r\n  popComponentStackInDEV(task);\r\n}\r\n\r\nfunction validateFunctionComponentInDev(Component: any): void {\r\n  if (__DEV__) {\r\n    if (Component) {\r\n      if (Component.childContextTypes) {\r\n        console.error(\r\n          '%s(...): childContextTypes cannot be defined on a function component.',\r\n          Component.displayName || Component.name || 'Component',\r\n        );\r\n      }\r\n    }\r\n\r\n    if (\r\n      warnAboutDefaultPropsOnFunctionComponents &&\r\n      Component.defaultProps !== undefined\r\n    ) {\r\n      const componentName = getComponentNameFromType(Component) || 'Unknown';\r\n\r\n      if (!didWarnAboutDefaultPropsOnFunctionComponent[componentName]) {\r\n        console.error(\r\n          '%s: Support for defaultProps will be removed from function components ' +\r\n            'in a future major release. Use JavaScript default parameters instead.',\r\n          componentName,\r\n        );\r\n        didWarnAboutDefaultPropsOnFunctionComponent[componentName] = true;\r\n      }\r\n    }\r\n\r\n    if (typeof Component.getDerivedStateFromProps === 'function') {\r\n      const componentName = getComponentNameFromType(Component) || 'Unknown';\r\n\r\n      if (!didWarnAboutGetDerivedStateOnFunctionComponent[componentName]) {\r\n        console.error(\r\n          '%s: Function components do not support getDerivedStateFromProps.',\r\n          componentName,\r\n        );\r\n        didWarnAboutGetDerivedStateOnFunctionComponent[componentName] = true;\r\n      }\r\n    }\r\n\r\n    if (\r\n      typeof Component.contextType === 'object' &&\r\n      Component.contextType !== null\r\n    ) {\r\n      const componentName = getComponentNameFromType(Component) || 'Unknown';\r\n\r\n      if (!didWarnAboutContextTypeOnFunctionComponent[componentName]) {\r\n        console.error(\r\n          '%s: Function components do not support contextType.',\r\n          componentName,\r\n        );\r\n        didWarnAboutContextTypeOnFunctionComponent[componentName] = true;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction resolveDefaultProps(Component: any, baseProps: Object): Object {\r\n  if (Component && Component.defaultProps) {\r\n    // Resolve default props. Taken from ReactElement\r\n    const props = assign({}, baseProps);\r\n    const defaultProps = Component.defaultProps;\r\n    for (const propName in defaultProps) {\r\n      if (props[propName] === undefined) {\r\n        props[propName] = defaultProps[propName];\r\n      }\r\n    }\r\n    return props;\r\n  }\r\n  return baseProps;\r\n}\r\n\r\nfunction renderForwardRef(\r\n  request: Request,\r\n  task: Task,\r\n  type: any,\r\n  props: Object,\r\n  ref: any,\r\n): void {\r\n  pushFunctionComponentStackInDEV(task, type.render);\r\n  const children = renderWithHooks(request, task, type.render, props, ref);\r\n  const hasId = checkDidRenderIdHook();\r\n  if (hasId) {\r\n    // This component materialized an id. We treat this as its own level, with\r\n    // a single \"child\" slot.\r\n    const prevTreeContext = task.treeContext;\r\n    const totalChildren = 1;\r\n    const index = 0;\r\n    task.treeContext = pushTreeContext(prevTreeContext, totalChildren, index);\r\n    try {\r\n      renderNodeDestructive(request, task, children);\r\n    } finally {\r\n      task.treeContext = prevTreeContext;\r\n    }\r\n  } else {\r\n    renderNodeDestructive(request, task, children);\r\n  }\r\n  popComponentStackInDEV(task);\r\n}\r\n\r\nfunction renderMemo(\r\n  request: Request,\r\n  task: Task,\r\n  type: any,\r\n  props: Object,\r\n  ref: any,\r\n): void {\r\n  const innerType = type.type;\r\n  const resolvedProps = resolveDefaultProps(innerType, props);\r\n  renderElement(request, task, innerType, resolvedProps, ref);\r\n}\r\n\r\nfunction renderContextConsumer(\r\n  request: Request,\r\n  task: Task,\r\n  context: ReactContext<any>,\r\n  props: Object,\r\n): void {\r\n  // The logic below for Context differs depending on PROD or DEV mode. In\r\n  // DEV mode, we create a separate object for Context.Consumer that acts\r\n  // like a proxy to Context. This proxy object adds unnecessary code in PROD\r\n  // so we use the old behaviour (Context.Consumer references Context) to\r\n  // reduce size and overhead. The separate object references context via\r\n  // a property called \"_context\", which also gives us the ability to check\r\n  // in DEV mode if this property exists or not and warn if it does not.\r\n  if (__DEV__) {\r\n    if ((context: any)._context === undefined) {\r\n      // This may be because it's a Context (rather than a Consumer).\r\n      // Or it may be because it's older React where they're the same thing.\r\n      // We only want to warn if we're sure it's a new React.\r\n      if (context !== context.Consumer) {\r\n        if (!hasWarnedAboutUsingContextAsConsumer) {\r\n          hasWarnedAboutUsingContextAsConsumer = true;\r\n          console.error(\r\n            'Rendering <Context> directly is not supported and will be removed in ' +\r\n              'a future major release. Did you mean to render <Context.Consumer> instead?',\r\n          );\r\n        }\r\n      }\r\n    } else {\r\n      context = (context: any)._context;\r\n    }\r\n  }\r\n  const render = props.children;\r\n\r\n  if (__DEV__) {\r\n    if (typeof render !== 'function') {\r\n      console.error(\r\n        'A context consumer was rendered with multiple children, or a child ' +\r\n          \"that isn't a function. A context consumer expects a single child \" +\r\n          'that is a function. If you did pass a function, make sure there ' +\r\n          'is no trailing or leading whitespace around it.',\r\n      );\r\n    }\r\n  }\r\n\r\n  const newValue = readContext(context);\r\n  const newChildren = render(newValue);\r\n\r\n  renderNodeDestructive(request, task, newChildren);\r\n}\r\n\r\nfunction renderContextProvider(\r\n  request: Request,\r\n  task: Task,\r\n  type: ReactProviderType<any>,\r\n  props: Object,\r\n): void {\r\n  const context = type._context;\r\n  const value = props.value;\r\n  const children = props.children;\r\n  let prevSnapshot;\r\n  if (__DEV__) {\r\n    prevSnapshot = task.context;\r\n  }\r\n  task.context = pushProvider(context, value);\r\n  renderNodeDestructive(request, task, children);\r\n  task.context = popProvider(context);\r\n  if (__DEV__) {\r\n    if (prevSnapshot !== task.context) {\r\n      console.error(\r\n        'Popping the context provider did not return back to the original snapshot. This is a bug in React.',\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nfunction renderLazyComponent(\r\n  request: Request,\r\n  task: Task,\r\n  lazyComponent: LazyComponentType<any, any>,\r\n  props: Object,\r\n  ref: any,\r\n): void {\r\n  pushBuiltInComponentStackInDEV(task, 'Lazy');\r\n  const payload = lazyComponent._payload;\r\n  const init = lazyComponent._init;\r\n  const Component = init(payload);\r\n  const resolvedProps = resolveDefaultProps(Component, props);\r\n  renderElement(request, task, Component, resolvedProps, ref);\r\n  popComponentStackInDEV(task);\r\n}\r\n\r\nfunction renderElement(\r\n  request: Request,\r\n  task: Task,\r\n  type: any,\r\n  props: Object,\r\n  ref: any,\r\n): void {\r\n  if (typeof type === 'function') {\r\n    if (shouldConstruct(type)) {\r\n      renderClassComponent(request, task, type, props);\r\n      return;\r\n    } else {\r\n      renderIndeterminateComponent(request, task, type, props);\r\n      return;\r\n    }\r\n  }\r\n  if (typeof type === 'string') {\r\n    renderHostElement(request, task, type, props);\r\n    return;\r\n  }\r\n\r\n  switch (type) {\r\n    // TODO: LegacyHidden acts the same as a fragment. This only works\r\n    // because we currently assume that every instance of LegacyHidden is\r\n    // accompanied by a host component wrapper. In the hidden mode, the host\r\n    // component is given a `hidden` attribute, which ensures that the\r\n    // initial HTML is not visible. To support the use of LegacyHidden as a\r\n    // true fragment, without an extra DOM node, we would have to hide the\r\n    // initial HTML in some other way.\r\n    // TODO: Add REACT_OFFSCREEN_TYPE here too with the same capability.\r\n    case REACT_LEGACY_HIDDEN_TYPE:\r\n    case REACT_DEBUG_TRACING_MODE_TYPE:\r\n    case REACT_STRICT_MODE_TYPE:\r\n    case REACT_PROFILER_TYPE:\r\n    case REACT_FRAGMENT_TYPE: {\r\n      renderNodeDestructive(request, task, props.children);\r\n      return;\r\n    }\r\n    case REACT_SUSPENSE_LIST_TYPE: {\r\n      pushBuiltInComponentStackInDEV(task, 'SuspenseList');\r\n      // TODO: SuspenseList should control the boundaries.\r\n      renderNodeDestructive(request, task, props.children);\r\n      popComponentStackInDEV(task);\r\n      return;\r\n    }\r\n    case REACT_SCOPE_TYPE: {\r\n      if (enableScopeAPI) {\r\n        renderNodeDestructive(request, task, props.children);\r\n        return;\r\n      }\r\n      throw new Error('ReactDOMServer does not yet support scope components.');\r\n    }\r\n    // eslint-disable-next-line-no-fallthrough\r\n    case REACT_SUSPENSE_TYPE: {\r\n      if (\r\n        enableSuspenseAvoidThisFallbackFizz &&\r\n        props.unstable_avoidThisFallback === true\r\n      ) {\r\n        renderBackupSuspenseBoundary(request, task, props);\r\n      } else {\r\n        renderSuspenseBoundary(request, task, props);\r\n      }\r\n      return;\r\n    }\r\n  }\r\n\r\n  if (typeof type === 'object' && type !== null) {\r\n    switch (type.$$typeof) {\r\n      case REACT_FORWARD_REF_TYPE: {\r\n        renderForwardRef(request, task, type, props, ref);\r\n        return;\r\n      }\r\n      case REACT_MEMO_TYPE: {\r\n        renderMemo(request, task, type, props, ref);\r\n        return;\r\n      }\r\n      case REACT_PROVIDER_TYPE: {\r\n        renderContextProvider(request, task, type, props);\r\n        return;\r\n      }\r\n      case REACT_CONTEXT_TYPE: {\r\n        renderContextConsumer(request, task, type, props);\r\n        return;\r\n      }\r\n      case REACT_LAZY_TYPE: {\r\n        renderLazyComponent(request, task, type, props);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  let info = '';\r\n  if (__DEV__) {\r\n    if (\r\n      type === undefined ||\r\n      (typeof type === 'object' &&\r\n        type !== null &&\r\n        Object.keys(type).length === 0)\r\n    ) {\r\n      info +=\r\n        ' You likely forgot to export your component from the file ' +\r\n        \"it's defined in, or you might have mixed up default and \" +\r\n        'named imports.';\r\n    }\r\n  }\r\n\r\n  throw new Error(\r\n    'Element type is invalid: expected a string (for built-in ' +\r\n      'components) or a class/function (for composite components) ' +\r\n      `but got: ${type == null ? type : typeof type}.${info}`,\r\n  );\r\n}\r\n\r\nfunction validateIterable(iterable, iteratorFn: Function): void {\r\n  if (__DEV__) {\r\n    // We don't support rendering Generators because it's a mutation.\r\n    // See https://github.com/facebook/react/issues/12995\r\n    if (\r\n      typeof Symbol === 'function' &&\r\n      // $FlowFixMe Flow doesn't know about toStringTag\r\n      iterable[Symbol.toStringTag] === 'Generator'\r\n    ) {\r\n      if (!didWarnAboutGenerators) {\r\n        console.error(\r\n          'Using Generators as children is unsupported and will likely yield ' +\r\n            'unexpected results because enumerating a generator mutates it. ' +\r\n            'You may convert it to an array with `Array.from()` or the ' +\r\n            '`[...spread]` operator before rendering. Keep in mind ' +\r\n            'you might need to polyfill these features for older browsers.',\r\n        );\r\n      }\r\n      didWarnAboutGenerators = true;\r\n    }\r\n\r\n    // Warn about using Maps as children\r\n    if ((iterable: any).entries === iteratorFn) {\r\n      if (!didWarnAboutMaps) {\r\n        console.error(\r\n          'Using Maps as children is not supported. ' +\r\n            'Use an array of keyed ReactElements instead.',\r\n        );\r\n      }\r\n      didWarnAboutMaps = true;\r\n    }\r\n  }\r\n}\r\n\r\nfunction renderNodeDestructive(\r\n  request: Request,\r\n  task: Task,\r\n  node: ReactNodeList,\r\n): void {\r\n  if (__DEV__) {\r\n    // In Dev we wrap renderNodeDestructiveImpl in a try / catch so we can capture\r\n    // a component stack at the right place in the tree. We don't do this in renderNode\r\n    // becuase it is not called at every layer of the tree and we may lose frames\r\n    try {\r\n      return renderNodeDestructiveImpl(request, task, node);\r\n    } catch (x) {\r\n      if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\r\n        // This is a Wakable, noop\r\n      } else {\r\n        // This is an error, stash the component stack if it is null.\r\n        lastBoundaryErrorComponentStackDev =\r\n          lastBoundaryErrorComponentStackDev !== null\r\n            ? lastBoundaryErrorComponentStackDev\r\n            : getCurrentStackInDEV();\r\n      }\r\n      // rethrow so normal suspense logic can handle thrown value accordingly\r\n      throw x;\r\n    }\r\n  } else {\r\n    return renderNodeDestructiveImpl(request, task, node);\r\n  }\r\n}\r\n\r\n// This function by it self renders a node and consumes the task by mutating it\r\n// to update the current execution state.\r\nfunction renderNodeDestructiveImpl(\r\n  request: Request,\r\n  task: Task,\r\n  node: ReactNodeList,\r\n): void {\r\n  // Stash the node we're working on. We'll pick up from this task in case\r\n  // something suspends.\r\n  task.node = node;\r\n\r\n  // Handle object types\r\n  if (typeof node === 'object' && node !== null) {\r\n    switch ((node: any).$$typeof) {\r\n      case REACT_ELEMENT_TYPE: {\r\n        const element: React$Element<any> = (node: any);\r\n        const type = element.type;\r\n        const props = element.props;\r\n        const ref = element.ref;\r\n        renderElement(request, task, type, props, ref);\r\n        return;\r\n      }\r\n      case REACT_PORTAL_TYPE:\r\n        throw new Error(\r\n          'Portals are not currently supported by the server renderer. ' +\r\n            'Render them conditionally so that they only appear on the client render.',\r\n        );\r\n      // eslint-disable-next-line-no-fallthrough\r\n      case REACT_LAZY_TYPE: {\r\n        const lazyNode: LazyComponentType<any, any> = (node: any);\r\n        const payload = lazyNode._payload;\r\n        const init = lazyNode._init;\r\n        let resolvedNode;\r\n        if (__DEV__) {\r\n          try {\r\n            resolvedNode = init(payload);\r\n          } catch (x) {\r\n            if (\r\n              typeof x === 'object' &&\r\n              x !== null &&\r\n              typeof x.then === 'function'\r\n            ) {\r\n              // this Lazy initializer is suspending. push a temporary frame onto the stack so it can be\r\n              // popped off in spawnNewSuspendedTask. This aligns stack behavior between Lazy in element position\r\n              // vs Component position. We do not want the frame for Errors so we exclusively do this in\r\n              // the wakeable branch\r\n              pushBuiltInComponentStackInDEV(task, 'Lazy');\r\n            }\r\n            throw x;\r\n          }\r\n        } else {\r\n          resolvedNode = init(payload);\r\n        }\r\n        renderNodeDestructive(request, task, resolvedNode);\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (isArray(node)) {\r\n      renderChildrenArray(request, task, node);\r\n      return;\r\n    }\r\n\r\n    const iteratorFn = getIteratorFn(node);\r\n    if (iteratorFn) {\r\n      if (__DEV__) {\r\n        validateIterable(node, iteratorFn);\r\n      }\r\n      const iterator = iteratorFn.call(node);\r\n      if (iterator) {\r\n        // We need to know how many total children are in this set, so that we\r\n        // can allocate enough id slots to acommodate them. So we must exhaust\r\n        // the iterator before we start recursively rendering the children.\r\n        // TODO: This is not great but I think it's inherent to the id\r\n        // generation algorithm.\r\n        let step = iterator.next();\r\n        // If there are not entries, we need to push an empty so we start by checking that.\r\n        if (!step.done) {\r\n          const children = [];\r\n          do {\r\n            children.push(step.value);\r\n            step = iterator.next();\r\n          } while (!step.done);\r\n          renderChildrenArray(request, task, children);\r\n          return;\r\n        }\r\n        return;\r\n      }\r\n    }\r\n\r\n    const childString = Object.prototype.toString.call(node);\r\n\r\n    throw new Error(\r\n      `Objects are not valid as a React child (found: ${\r\n        childString === '[object Object]'\r\n          ? 'object with keys {' + Object.keys(node).join(', ') + '}'\r\n          : childString\r\n      }). ` +\r\n        'If you meant to render a collection of children, use an array ' +\r\n        'instead.',\r\n    );\r\n  }\r\n\r\n  if (typeof node === 'string') {\r\n    const segment = task.blockedSegment;\r\n    segment.lastPushedText = pushTextInstance(\r\n      task.blockedSegment.chunks,\r\n      node,\r\n      request.responseState,\r\n      segment.lastPushedText,\r\n    );\r\n    return;\r\n  }\r\n\r\n  if (typeof node === 'number') {\r\n    const segment = task.blockedSegment;\r\n    segment.lastPushedText = pushTextInstance(\r\n      task.blockedSegment.chunks,\r\n      '' + node,\r\n      request.responseState,\r\n      segment.lastPushedText,\r\n    );\r\n    return;\r\n  }\r\n\r\n  if (__DEV__) {\r\n    if (typeof node === 'function') {\r\n      console.error(\r\n        'Functions are not valid as a React child. This may happen if ' +\r\n          'you return a Component instead of <Component /> from render. ' +\r\n          'Or maybe you meant to call this function rather than return it.',\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nfunction renderChildrenArray(request, task, children) {\r\n  const totalChildren = children.length;\r\n  for (let i = 0; i < totalChildren; i++) {\r\n    const prevTreeContext = task.treeContext;\r\n    task.treeContext = pushTreeContext(prevTreeContext, totalChildren, i);\r\n    try {\r\n      // We need to use the non-destructive form so that we can safely pop back\r\n      // up and render the sibling if something suspends.\r\n      renderNode(request, task, children[i]);\r\n    } finally {\r\n      task.treeContext = prevTreeContext;\r\n    }\r\n  }\r\n}\r\n\r\nfunction spawnNewSuspendedTask(\r\n  request: Request,\r\n  task: Task,\r\n  x: Promise<any>,\r\n): void {\r\n  // Something suspended, we'll need to create a new segment and resolve it later.\r\n  const segment = task.blockedSegment;\r\n  const insertionIndex = segment.chunks.length;\r\n  const newSegment = createPendingSegment(\r\n    request,\r\n    insertionIndex,\r\n    null,\r\n    segment.formatContext,\r\n    // Adopt the parent segment's leading text embed\r\n    segment.lastPushedText,\r\n    // Assume we are text embedded at the trailing edge\r\n    true,\r\n  );\r\n  segment.children.push(newSegment);\r\n  // Reset lastPushedText for current Segment since the new Segment \"consumed\" it\r\n  segment.lastPushedText = false;\r\n  const newTask = createTask(\r\n    request,\r\n    task.node,\r\n    task.blockedBoundary,\r\n    newSegment,\r\n    task.abortSet,\r\n    task.legacyContext,\r\n    task.context,\r\n    task.treeContext,\r\n  );\r\n  if (__DEV__) {\r\n    if (task.componentStack !== null) {\r\n      // We pop one task off the stack because the node that suspended will be tried again,\r\n      // which will add it back onto the stack.\r\n      newTask.componentStack = task.componentStack.parent;\r\n    }\r\n  }\r\n  const ping = newTask.ping;\r\n  x.then(ping, ping);\r\n}\r\n\r\n// This is a non-destructive form of rendering a node. If it suspends it spawns\r\n// a new task and restores the context of this task to what it was before.\r\nfunction renderNode(request: Request, task: Task, node: ReactNodeList): void {\r\n  // TODO: Store segment.children.length here and reset it in case something\r\n  // suspended partially through writing something.\r\n\r\n  // Snapshot the current context in case something throws to interrupt the\r\n  // process.\r\n  const previousFormatContext = task.blockedSegment.formatContext;\r\n  const previousLegacyContext = task.legacyContext;\r\n  const previousContext = task.context;\r\n  let previousComponentStack = null;\r\n  if (__DEV__) {\r\n    previousComponentStack = task.componentStack;\r\n  }\r\n  try {\r\n    return renderNodeDestructive(request, task, node);\r\n  } catch (x) {\r\n    resetHooksState();\r\n    if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\r\n      spawnNewSuspendedTask(request, task, x);\r\n      // Restore the context. We assume that this will be restored by the inner\r\n      // functions in case nothing throws so we don't use \"finally\" here.\r\n      task.blockedSegment.formatContext = previousFormatContext;\r\n      task.legacyContext = previousLegacyContext;\r\n      task.context = previousContext;\r\n      // Restore all active ReactContexts to what they were before.\r\n      switchContext(previousContext);\r\n      if (__DEV__) {\r\n        task.componentStack = previousComponentStack;\r\n      }\r\n      return;\r\n    } else {\r\n      // Restore the context. We assume that this will be restored by the inner\r\n      // functions in case nothing throws so we don't use \"finally\" here.\r\n      task.blockedSegment.formatContext = previousFormatContext;\r\n      task.legacyContext = previousLegacyContext;\r\n      task.context = previousContext;\r\n      // Restore all active ReactContexts to what they were before.\r\n      switchContext(previousContext);\r\n      if (__DEV__) {\r\n        task.componentStack = previousComponentStack;\r\n      }\r\n      // We assume that we don't need the correct context.\r\n      // Let's terminate the rest of the tree and don't render any siblings.\r\n      throw x;\r\n    }\r\n  }\r\n}\r\n\r\nfunction erroredTask(\r\n  request: Request,\r\n  boundary: Root | SuspenseBoundary,\r\n  segment: Segment,\r\n  error: mixed,\r\n) {\r\n  // Report the error to a global handler.\r\n  const errorDigest = logRecoverableError(request, error);\r\n  if (boundary === null) {\r\n    fatalError(request, error);\r\n  } else {\r\n    boundary.pendingTasks--;\r\n    if (!boundary.forceClientRender) {\r\n      boundary.forceClientRender = true;\r\n      boundary.errorDigest = errorDigest;\r\n      if (__DEV__) {\r\n        captureBoundaryErrorDetailsDev(boundary, error);\r\n      }\r\n\r\n      // Regardless of what happens next, this boundary won't be displayed,\r\n      // so we can flush it, if the parent already flushed.\r\n      if (boundary.parentFlushed) {\r\n        // We don't have a preference where in the queue this goes since it's likely\r\n        // to error on the client anyway. However, intentionally client-rendered\r\n        // boundaries should be flushed earlier so that they can start on the client.\r\n        // We reuse the same queue for errors.\r\n        request.clientRenderedBoundaries.push(boundary);\r\n      }\r\n    }\r\n  }\r\n\r\n  request.allPendingTasks--;\r\n  if (request.allPendingTasks === 0) {\r\n    const onAllReady = request.onAllReady;\r\n    onAllReady();\r\n  }\r\n}\r\n\r\nfunction abortTaskSoft(task: Task): void {\r\n  // This aborts task without aborting the parent boundary that it blocks.\r\n  // It's used for when we didn't need this task to complete the tree.\r\n  // If task was needed, then it should use abortTask instead.\r\n  const request: Request = this;\r\n  const boundary = task.blockedBoundary;\r\n  const segment = task.blockedSegment;\r\n  segment.status = ABORTED;\r\n  finishedTask(request, boundary, segment);\r\n}\r\n\r\nfunction abortTask(task: Task, request: Request, reason: mixed): void {\r\n  // This aborts the task and aborts the parent that it blocks, putting it into\r\n  // client rendered mode.\r\n  const boundary = task.blockedBoundary;\r\n  const segment = task.blockedSegment;\r\n  segment.status = ABORTED;\r\n\r\n  if (boundary === null) {\r\n    request.allPendingTasks--;\r\n    // We didn't complete the root so we have nothing to show. We can close\r\n    // the request;\r\n    if (request.status !== CLOSED) {\r\n      request.status = CLOSED;\r\n      if (request.destination !== null) {\r\n        close(request.destination);\r\n      }\r\n    }\r\n  } else {\r\n    boundary.pendingTasks--;\r\n\r\n    if (!boundary.forceClientRender) {\r\n      boundary.forceClientRender = true;\r\n      let error =\r\n        reason === undefined\r\n          ? new Error('The render was aborted by the server without a reason.')\r\n          : reason;\r\n      boundary.errorDigest = request.onError(error);\r\n      if (__DEV__) {\r\n        const errorPrefix =\r\n          'The server did not finish this Suspense boundary: ';\r\n        if (error && typeof error.message === 'string') {\r\n          error = errorPrefix + error.message;\r\n        } else {\r\n          // eslint-disable-next-line react-internal/safe-string-coercion\r\n          error = errorPrefix + String(error);\r\n        }\r\n        const previousTaskInDev = currentTaskInDEV;\r\n        currentTaskInDEV = task;\r\n        try {\r\n          captureBoundaryErrorDetailsDev(boundary, error);\r\n        } finally {\r\n          currentTaskInDEV = previousTaskInDev;\r\n        }\r\n      }\r\n      if (boundary.parentFlushed) {\r\n        request.clientRenderedBoundaries.push(boundary);\r\n      }\r\n    }\r\n\r\n    // If this boundary was still pending then we haven't already cancelled its fallbacks.\r\n    // We'll need to abort the fallbacks, which will also error that parent boundary.\r\n    boundary.fallbackAbortableTasks.forEach(fallbackTask =>\r\n      abortTask(fallbackTask, request, reason),\r\n    );\r\n    boundary.fallbackAbortableTasks.clear();\r\n\r\n    request.allPendingTasks--;\r\n    if (request.allPendingTasks === 0) {\r\n      const onAllReady = request.onAllReady;\r\n      onAllReady();\r\n    }\r\n  }\r\n}\r\n\r\nfunction queueCompletedSegment(\r\n  boundary: SuspenseBoundary,\r\n  segment: Segment,\r\n): void {\r\n  if (\r\n    segment.chunks.length === 0 &&\r\n    segment.children.length === 1 &&\r\n    segment.children[0].boundary === null\r\n  ) {\r\n    // This is an empty segment. There's nothing to write, so we can instead transfer the ID\r\n    // to the child. That way any existing references point to the child.\r\n    const childSegment = segment.children[0];\r\n    childSegment.id = segment.id;\r\n    childSegment.parentFlushed = true;\r\n    if (childSegment.status === COMPLETED) {\r\n      queueCompletedSegment(boundary, childSegment);\r\n    }\r\n  } else {\r\n    const completedSegments = boundary.completedSegments;\r\n    completedSegments.push(segment);\r\n  }\r\n}\r\n\r\nfunction finishedTask(\r\n  request: Request,\r\n  boundary: Root | SuspenseBoundary,\r\n  segment: Segment,\r\n) {\r\n  if (boundary === null) {\r\n    if (segment.parentFlushed) {\r\n      if (request.completedRootSegment !== null) {\r\n        throw new Error(\r\n          'There can only be one root segment. This is a bug in React.',\r\n        );\r\n      }\r\n\r\n      request.completedRootSegment = segment;\r\n    }\r\n    request.pendingRootTasks--;\r\n    if (request.pendingRootTasks === 0) {\r\n      // We have completed the shell so the shell can't error anymore.\r\n      request.onShellError = noop;\r\n      const onShellReady = request.onShellReady;\r\n      onShellReady();\r\n    }\r\n  } else {\r\n    boundary.pendingTasks--;\r\n    if (boundary.forceClientRender) {\r\n      // This already errored.\r\n    } else if (boundary.pendingTasks === 0) {\r\n      // This must have been the last segment we were waiting on. This boundary is now complete.\r\n      if (segment.parentFlushed) {\r\n        // Our parent segment already flushed, so we need to schedule this segment to be emitted.\r\n        // If it is a segment that was aborted, we'll write other content instead so we don't need\r\n        // to emit it.\r\n        if (segment.status === COMPLETED) {\r\n          queueCompletedSegment(boundary, segment);\r\n        }\r\n      }\r\n      if (boundary.parentFlushed) {\r\n        // The segment might be part of a segment that didn't flush yet, but if the boundary's\r\n        // parent flushed, we need to schedule the boundary to be emitted.\r\n        request.completedBoundaries.push(boundary);\r\n      }\r\n      // We can now cancel any pending task on the fallback since we won't need to show it anymore.\r\n      // This needs to happen after we read the parentFlushed flags because aborting can finish\r\n      // work which can trigger user code, which can start flushing, which can change those flags.\r\n      boundary.fallbackAbortableTasks.forEach(abortTaskSoft, request);\r\n      boundary.fallbackAbortableTasks.clear();\r\n    } else {\r\n      if (segment.parentFlushed) {\r\n        // Our parent already flushed, so we need to schedule this segment to be emitted.\r\n        // If it is a segment that was aborted, we'll write other content instead so we don't need\r\n        // to emit it.\r\n        if (segment.status === COMPLETED) {\r\n          queueCompletedSegment(boundary, segment);\r\n          const completedSegments = boundary.completedSegments;\r\n          if (completedSegments.length === 1) {\r\n            // This is the first time since we last flushed that we completed anything.\r\n            // We can schedule this boundary to emit its partially completed segments early\r\n            // in case the parent has already been flushed.\r\n            if (boundary.parentFlushed) {\r\n              request.partialBoundaries.push(boundary);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  request.allPendingTasks--;\r\n  if (request.allPendingTasks === 0) {\r\n    // This needs to be called at the very end so that we can synchronously write the result\r\n    // in the callback if needed.\r\n    const onAllReady = request.onAllReady;\r\n    onAllReady();\r\n  }\r\n}\r\n\r\nfunction retryTask(request: Request, task: Task): void {\r\n  const segment = task.blockedSegment;\r\n  if (segment.status !== PENDING) {\r\n    // We completed this by other means before we had a chance to retry it.\r\n    return;\r\n  }\r\n  // We restore the context to what it was when we suspended.\r\n  // We don't restore it after we leave because it's likely that we'll end up\r\n  // needing a very similar context soon again.\r\n  switchContext(task.context);\r\n  let prevTaskInDEV = null;\r\n  if (__DEV__) {\r\n    prevTaskInDEV = currentTaskInDEV;\r\n    currentTaskInDEV = task;\r\n  }\r\n  try {\r\n    // We call the destructive form that mutates this task. That way if something\r\n    // suspends again, we can reuse the same task instead of spawning a new one.\r\n    renderNodeDestructive(request, task, task.node);\r\n    pushSegmentFinale(\r\n      segment.chunks,\r\n      request.responseState,\r\n      segment.lastPushedText,\r\n      segment.textEmbedded,\r\n    );\r\n\r\n    task.abortSet.delete(task);\r\n    segment.status = COMPLETED;\r\n    finishedTask(request, task.blockedBoundary, segment);\r\n  } catch (x) {\r\n    resetHooksState();\r\n    if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\r\n      // Something suspended again, let's pick it back up later.\r\n      const ping = task.ping;\r\n      x.then(ping, ping);\r\n    } else {\r\n      task.abortSet.delete(task);\r\n      segment.status = ERRORED;\r\n      erroredTask(request, task.blockedBoundary, segment, x);\r\n    }\r\n  } finally {\r\n    if (__DEV__) {\r\n      currentTaskInDEV = prevTaskInDEV;\r\n    }\r\n  }\r\n}\r\n\r\nexport function performWork(request: Request): void {\r\n  if (request.status === CLOSED) {\r\n    return;\r\n  }\r\n  const prevContext = getActiveContext();\r\n  const prevDispatcher = ReactCurrentDispatcher.current;\r\n  ReactCurrentDispatcher.current = Dispatcher;\r\n  let prevGetCurrentStackImpl;\r\n  if (__DEV__) {\r\n    prevGetCurrentStackImpl = ReactDebugCurrentFrame.getCurrentStack;\r\n    ReactDebugCurrentFrame.getCurrentStack = getCurrentStackInDEV;\r\n  }\r\n  const prevResponseState = currentResponseState;\r\n  setCurrentResponseState(request.responseState);\r\n  try {\r\n    const pingedTasks = request.pingedTasks;\r\n    let i;\r\n    for (i = 0; i < pingedTasks.length; i++) {\r\n      const task = pingedTasks[i];\r\n      retryTask(request, task);\r\n    }\r\n    pingedTasks.splice(0, i);\r\n    if (request.destination !== null) {\r\n      flushCompletedQueues(request, request.destination);\r\n    }\r\n  } catch (error) {\r\n    logRecoverableError(request, error);\r\n    fatalError(request, error);\r\n  } finally {\r\n    setCurrentResponseState(prevResponseState);\r\n    ReactCurrentDispatcher.current = prevDispatcher;\r\n    if (__DEV__) {\r\n      ReactDebugCurrentFrame.getCurrentStack = prevGetCurrentStackImpl;\r\n    }\r\n    if (prevDispatcher === Dispatcher) {\r\n      // This means that we were in a reentrant work loop. This could happen\r\n      // in a renderer that supports synchronous work like renderToString,\r\n      // when it's called from within another renderer.\r\n      // Normally we don't bother switching the contexts to their root/default\r\n      // values when leaving because we'll likely need the same or similar\r\n      // context again. However, when we're inside a synchronous loop like this\r\n      // we'll to restore the context to what it was before returning.\r\n      switchContext(prevContext);\r\n    }\r\n  }\r\n}\r\n\r\nfunction flushSubtree(\r\n  request: Request,\r\n  destination: Destination,\r\n  segment: Segment,\r\n): boolean {\r\n  segment.parentFlushed = true;\r\n  switch (segment.status) {\r\n    case PENDING: {\r\n      // We're emitting a placeholder for this segment to be filled in later.\r\n      // Therefore we'll need to assign it an ID - to refer to it by.\r\n      const segmentID = (segment.id = request.nextSegmentId++);\r\n      // When this segment finally completes it won't be embedded in text since it will flush separately\r\n      segment.lastPushedText = false;\r\n      segment.textEmbedded = false;\r\n      return writePlaceholder(destination, request.responseState, segmentID);\r\n    }\r\n    case COMPLETED: {\r\n      segment.status = FLUSHED;\r\n      let r = true;\r\n      const chunks = segment.chunks;\r\n      let chunkIdx = 0;\r\n      const children = segment.children;\r\n      for (let childIdx = 0; childIdx < children.length; childIdx++) {\r\n        const nextChild = children[childIdx];\r\n        // Write all the chunks up until the next child.\r\n        for (; chunkIdx < nextChild.index; chunkIdx++) {\r\n          writeChunk(destination, chunks[chunkIdx]);\r\n        }\r\n        r = flushSegment(request, destination, nextChild);\r\n      }\r\n      // Finally just write all the remaining chunks\r\n      for (; chunkIdx < chunks.length - 1; chunkIdx++) {\r\n        writeChunk(destination, chunks[chunkIdx]);\r\n      }\r\n      if (chunkIdx < chunks.length) {\r\n        r = writeChunkAndReturn(destination, chunks[chunkIdx]);\r\n      }\r\n      return r;\r\n    }\r\n    default: {\r\n      throw new Error(\r\n        'Aborted, errored or already flushed boundaries should not be flushed again. This is a bug in React.',\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nfunction flushSegment(\r\n  request: Request,\r\n  destination,\r\n  segment: Segment,\r\n): boolean {\r\n  const boundary = segment.boundary;\r\n  if (boundary === null) {\r\n    // Not a suspense boundary.\r\n    return flushSubtree(request, destination, segment);\r\n  }\r\n  boundary.parentFlushed = true;\r\n  // This segment is a Suspense boundary. We need to decide whether to\r\n  // emit the content or the fallback now.\r\n  if (boundary.forceClientRender) {\r\n    // Emit a client rendered suspense boundary wrapper.\r\n    // We never queue the inner boundary so we'll never emit its content or partial segments.\r\n\r\n    writeStartClientRenderedSuspenseBoundary(\r\n      destination,\r\n      request.responseState,\r\n      boundary.errorDigest,\r\n      boundary.errorMessage,\r\n      boundary.errorComponentStack,\r\n    );\r\n    // Flush the fallback.\r\n    flushSubtree(request, destination, segment);\r\n\r\n    return writeEndClientRenderedSuspenseBoundary(\r\n      destination,\r\n      request.responseState,\r\n    );\r\n  } else if (boundary.pendingTasks > 0) {\r\n    // This boundary is still loading. Emit a pending suspense boundary wrapper.\r\n\r\n    // Assign an ID to refer to the future content by.\r\n    boundary.rootSegmentID = request.nextSegmentId++;\r\n    if (boundary.completedSegments.length > 0) {\r\n      // If this is at least partially complete, we can queue it to be partially emitted early.\r\n      request.partialBoundaries.push(boundary);\r\n    }\r\n\r\n    /// This is the first time we should have referenced this ID.\r\n    const id = (boundary.id = assignSuspenseBoundaryID(request.responseState));\r\n\r\n    writeStartPendingSuspenseBoundary(destination, request.responseState, id);\r\n\r\n    // Flush the fallback.\r\n    flushSubtree(request, destination, segment);\r\n\r\n    return writeEndPendingSuspenseBoundary(destination, request.responseState);\r\n  } else if (boundary.byteSize > request.progressiveChunkSize) {\r\n    // This boundary is large and will be emitted separately so that we can progressively show\r\n    // other content. We add it to the queue during the flush because we have to ensure that\r\n    // the parent flushes first so that there's something to inject it into.\r\n    // We also have to make sure that it's emitted into the queue in a deterministic slot.\r\n    // I.e. we can't insert it here when it completes.\r\n\r\n    // Assign an ID to refer to the future content by.\r\n    boundary.rootSegmentID = request.nextSegmentId++;\r\n\r\n    request.completedBoundaries.push(boundary);\r\n    // Emit a pending rendered suspense boundary wrapper.\r\n    writeStartPendingSuspenseBoundary(\r\n      destination,\r\n      request.responseState,\r\n      boundary.id,\r\n    );\r\n\r\n    // Flush the fallback.\r\n    flushSubtree(request, destination, segment);\r\n\r\n    return writeEndPendingSuspenseBoundary(destination, request.responseState);\r\n  } else {\r\n    // We can inline this boundary's content as a complete boundary.\r\n    writeStartCompletedSuspenseBoundary(destination, request.responseState);\r\n\r\n    const completedSegments = boundary.completedSegments;\r\n\r\n    if (completedSegments.length !== 1) {\r\n      throw new Error(\r\n        'A previously unvisited boundary must have exactly one root segment. This is a bug in React.',\r\n      );\r\n    }\r\n\r\n    const contentSegment = completedSegments[0];\r\n    flushSegment(request, destination, contentSegment);\r\n\r\n    return writeEndCompletedSuspenseBoundary(\r\n      destination,\r\n      request.responseState,\r\n    );\r\n  }\r\n}\r\n\r\nfunction flushClientRenderedBoundary(\r\n  request: Request,\r\n  destination: Destination,\r\n  boundary: SuspenseBoundary,\r\n): boolean {\r\n  return writeClientRenderBoundaryInstruction(\r\n    destination,\r\n    request.responseState,\r\n    boundary.id,\r\n    boundary.errorDigest,\r\n    boundary.errorMessage,\r\n    boundary.errorComponentStack,\r\n  );\r\n}\r\n\r\nfunction flushSegmentContainer(\r\n  request: Request,\r\n  destination: Destination,\r\n  segment: Segment,\r\n): boolean {\r\n  writeStartSegment(\r\n    destination,\r\n    request.responseState,\r\n    segment.formatContext,\r\n    segment.id,\r\n  );\r\n  flushSegment(request, destination, segment);\r\n  return writeEndSegment(destination, segment.formatContext);\r\n}\r\n\r\nfunction flushCompletedBoundary(\r\n  request: Request,\r\n  destination: Destination,\r\n  boundary: SuspenseBoundary,\r\n): boolean {\r\n  const completedSegments = boundary.completedSegments;\r\n  let i = 0;\r\n  for (; i < completedSegments.length; i++) {\r\n    const segment = completedSegments[i];\r\n    flushPartiallyCompletedSegment(request, destination, boundary, segment);\r\n  }\r\n  completedSegments.length = 0;\r\n\r\n  return writeCompletedBoundaryInstruction(\r\n    destination,\r\n    request.responseState,\r\n    boundary.id,\r\n    boundary.rootSegmentID,\r\n  );\r\n}\r\n\r\nfunction flushPartialBoundary(\r\n  request: Request,\r\n  destination: Destination,\r\n  boundary: SuspenseBoundary,\r\n): boolean {\r\n  const completedSegments = boundary.completedSegments;\r\n  let i = 0;\r\n  for (; i < completedSegments.length; i++) {\r\n    const segment = completedSegments[i];\r\n    if (\r\n      !flushPartiallyCompletedSegment(request, destination, boundary, segment)\r\n    ) {\r\n      i++;\r\n      completedSegments.splice(0, i);\r\n      // Only write as much as the buffer wants. Something higher priority\r\n      // might want to write later.\r\n      return false;\r\n    }\r\n  }\r\n  completedSegments.splice(0, i);\r\n  return true;\r\n}\r\n\r\nfunction flushPartiallyCompletedSegment(\r\n  request: Request,\r\n  destination: Destination,\r\n  boundary: SuspenseBoundary,\r\n  segment: Segment,\r\n): boolean {\r\n  if (segment.status === FLUSHED) {\r\n    // We've already flushed this inline.\r\n    return true;\r\n  }\r\n\r\n  const segmentID = segment.id;\r\n  if (segmentID === -1) {\r\n    // This segment wasn't previously referred to. This happens at the root of\r\n    // a boundary. We make kind of a leap here and assume this is the root.\r\n    const rootSegmentID = (segment.id = boundary.rootSegmentID);\r\n\r\n    if (rootSegmentID === -1) {\r\n      throw new Error(\r\n        'A root segment ID must have been assigned by now. This is a bug in React.',\r\n      );\r\n    }\r\n\r\n    return flushSegmentContainer(request, destination, segment);\r\n  } else {\r\n    flushSegmentContainer(request, destination, segment);\r\n    return writeCompletedSegmentInstruction(\r\n      destination,\r\n      request.responseState,\r\n      segmentID,\r\n    );\r\n  }\r\n}\r\n\r\nfunction flushCompletedQueues(\r\n  request: Request,\r\n  destination: Destination,\r\n): void {\r\n  beginWriting(destination);\r\n  try {\r\n    // The structure of this is to go through each queue one by one and write\r\n    // until the sink tells us to stop. When we should stop, we still finish writing\r\n    // that item fully and then yield. At that point we remove the already completed\r\n    // items up until the point we completed them.\r\n\r\n    // TODO: Emit preloading.\r\n\r\n    // TODO: It's kind of unfortunate to keep checking this array after we've already\r\n    // emitted the root.\r\n    const completedRootSegment = request.completedRootSegment;\r\n    if (completedRootSegment !== null && request.pendingRootTasks === 0) {\r\n      flushSegment(request, destination, completedRootSegment);\r\n      request.completedRootSegment = null;\r\n      writeCompletedRoot(destination, request.responseState);\r\n    }\r\n\r\n    // We emit client rendering instructions for already emitted boundaries first.\r\n    // This is so that we can signal to the client to start client rendering them as\r\n    // soon as possible.\r\n    const clientRenderedBoundaries = request.clientRenderedBoundaries;\r\n    let i;\r\n    for (i = 0; i < clientRenderedBoundaries.length; i++) {\r\n      const boundary = clientRenderedBoundaries[i];\r\n      if (!flushClientRenderedBoundary(request, destination, boundary)) {\r\n        request.destination = null;\r\n        i++;\r\n        clientRenderedBoundaries.splice(0, i);\r\n        return;\r\n      }\r\n    }\r\n    clientRenderedBoundaries.splice(0, i);\r\n\r\n    // Next we emit any complete boundaries. It's better to favor boundaries\r\n    // that are completely done since we can actually show them, than it is to emit\r\n    // any individual segments from a partially complete boundary.\r\n    const completedBoundaries = request.completedBoundaries;\r\n    for (i = 0; i < completedBoundaries.length; i++) {\r\n      const boundary = completedBoundaries[i];\r\n      if (!flushCompletedBoundary(request, destination, boundary)) {\r\n        request.destination = null;\r\n        i++;\r\n        completedBoundaries.splice(0, i);\r\n        return;\r\n      }\r\n    }\r\n    completedBoundaries.splice(0, i);\r\n\r\n    // Allow anything written so far to flush to the underlying sink before\r\n    // we continue with lower priorities.\r\n    completeWriting(destination);\r\n    beginWriting(destination);\r\n\r\n    // TODO: Here we'll emit data used by hydration.\r\n\r\n    // Next we emit any segments of any boundaries that are partially complete\r\n    // but not deeply complete.\r\n    const partialBoundaries = request.partialBoundaries;\r\n    for (i = 0; i < partialBoundaries.length; i++) {\r\n      const boundary = partialBoundaries[i];\r\n      if (!flushPartialBoundary(request, destination, boundary)) {\r\n        request.destination = null;\r\n        i++;\r\n        partialBoundaries.splice(0, i);\r\n        return;\r\n      }\r\n    }\r\n    partialBoundaries.splice(0, i);\r\n\r\n    // Next we check the completed boundaries again. This may have had\r\n    // boundaries added to it in case they were too larged to be inlined.\r\n    // New ones might be added in this loop.\r\n    const largeBoundaries = request.completedBoundaries;\r\n    for (i = 0; i < largeBoundaries.length; i++) {\r\n      const boundary = largeBoundaries[i];\r\n      if (!flushCompletedBoundary(request, destination, boundary)) {\r\n        request.destination = null;\r\n        i++;\r\n        largeBoundaries.splice(0, i);\r\n        return;\r\n      }\r\n    }\r\n    largeBoundaries.splice(0, i);\r\n  } finally {\r\n    completeWriting(destination);\r\n    flushBuffered(destination);\r\n    if (\r\n      request.allPendingTasks === 0 &&\r\n      request.pingedTasks.length === 0 &&\r\n      request.clientRenderedBoundaries.length === 0 &&\r\n      request.completedBoundaries.length === 0\r\n      // We don't need to check any partially completed segments because\r\n      // either they have pending task or they're complete.\r\n    ) {\r\n      if (__DEV__) {\r\n        if (request.abortableTasks.size !== 0) {\r\n          console.error(\r\n            'There was still abortable task at the root when we closed. This is a bug in React.',\r\n          );\r\n        }\r\n      }\r\n      // We're done.\r\n      close(destination);\r\n    }\r\n  }\r\n}\r\n\r\nexport function startWork(request: Request): void {\r\n  scheduleWork(() => performWork(request));\r\n}\r\n\r\nexport function startFlowing(request: Request, destination: Destination): void {\r\n  if (request.status === CLOSING) {\r\n    request.status = CLOSED;\r\n    closeWithError(destination, request.fatalError);\r\n    return;\r\n  }\r\n  if (request.status === CLOSED) {\r\n    return;\r\n  }\r\n  if (request.destination !== null) {\r\n    // We're already flowing.\r\n    return;\r\n  }\r\n  request.destination = destination;\r\n  try {\r\n    flushCompletedQueues(request, destination);\r\n  } catch (error) {\r\n    logRecoverableError(request, error);\r\n    fatalError(request, error);\r\n  }\r\n}\r\n\r\n// This is called to early terminate a request. It puts all pending boundaries in client rendered state.\r\nexport function abort(request: Request, reason: mixed): void {\r\n  try {\r\n    const abortableTasks = request.abortableTasks;\r\n    abortableTasks.forEach(task => abortTask(task, request, reason));\r\n    abortableTasks.clear();\r\n    if (request.destination !== null) {\r\n      flushCompletedQueues(request, request.destination);\r\n    }\r\n  } catch (error) {\r\n    logRecoverableError(request, error);\r\n    fatalError(request, error);\r\n  }\r\n}\r\n","/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport type {ReactNodeList} from 'shared/ReactTypes';\r\n\r\nimport ReactVersion from 'shared/ReactVersion';\r\n\r\nimport {\r\n  createRequest,\r\n  startWork,\r\n  startFlowing,\r\n  abort,\r\n} from 'react-server/src/ReactFizzServer';\r\n\r\nimport {\r\n  createResponseState,\r\n  createRootFormatContext,\r\n} from './ReactDOMServerFormatConfig';\r\n\r\ntype Options = {|\r\n  identifierPrefix?: string,\r\n  namespaceURI?: string,\r\n  nonce?: string,\r\n  bootstrapScriptContent?: string,\r\n  bootstrapScripts?: Array<string>,\r\n  bootstrapModules?: Array<string>,\r\n  progressiveChunkSize?: number,\r\n  signal?: AbortSignal,\r\n  onError?: (error: mixed) => ?string,\r\n|};\r\n\r\n// TODO: Move to sub-classing ReadableStream.\r\ntype ReactDOMServerReadableStream = ReadableStream & {\r\n  allReady: Promise<void>,\r\n};\r\n\r\nfunction renderToReadableStream(\r\n  children: ReactNodeList,\r\n  options?: Options,\r\n): Promise<ReactDOMServerReadableStream> {\r\n  return new Promise((resolve, reject) => {\r\n    let onFatalError;\r\n    let onAllReady;\r\n    const allReady = new Promise((res, rej) => {\r\n      onAllReady = res;\r\n      onFatalError = rej;\r\n    });\r\n\r\n    function onShellReady() {\r\n      const stream: ReactDOMServerReadableStream = (new ReadableStream(\r\n        {\r\n          type: 'bytes',\r\n          pull(controller) {\r\n            startFlowing(request, controller);\r\n          },\r\n          cancel(reason) {\r\n            abort(request);\r\n          },\r\n        },\r\n        // $FlowFixMe size() methods are not allowed on byte streams.\r\n        {highWaterMark: 0},\r\n      ): any);\r\n      // TODO: Move to sub-classing ReadableStream.\r\n      stream.allReady = allReady;\r\n      resolve(stream);\r\n    }\r\n    function onShellError(error: mixed) {\r\n      // If the shell errors the caller of `renderToReadableStream` won't have access to `allReady`.\r\n      // However, `allReady` will be rejected by `onFatalError` as well.\r\n      // So we need to catch the duplicate, uncatchable fatal error in `allReady` to prevent a `UnhandledPromiseRejection`.\r\n      allReady.catch(() => {});\r\n      reject(error);\r\n    }\r\n    const request = createRequest(\r\n      children,\r\n      createResponseState(\r\n        options ? options.identifierPrefix : undefined,\r\n        options ? options.nonce : undefined,\r\n        options ? options.bootstrapScriptContent : undefined,\r\n        options ? options.bootstrapScripts : undefined,\r\n        options ? options.bootstrapModules : undefined,\r\n      ),\r\n      createRootFormatContext(options ? options.namespaceURI : undefined),\r\n      options ? options.progressiveChunkSize : undefined,\r\n      options ? options.onError : undefined,\r\n      onAllReady,\r\n      onShellReady,\r\n      onShellError,\r\n      onFatalError,\r\n    );\r\n    if (options && options.signal) {\r\n      const signal = options.signal;\r\n      const listener = () => {\r\n        abort(request, (signal: any).reason);\r\n        signal.removeEventListener('abort', listener);\r\n      };\r\n      signal.addEventListener('abort', listener);\r\n    }\r\n    startWork(request);\r\n  });\r\n}\r\n\r\nexport {renderToReadableStream, ReactVersion as version};\r\n"],"names":["formatProdErrorMessage","code","url","i","arguments","length","encodeURIComponent","scheduleWork","callback","VIEW_SIZE","currentView","writtenBytes","beginWriting","destination","Uint8Array","writeChunk","chunk","enqueue","buffer","bytesToWrite","allowableBytes","set","subarray","writeChunkAndReturn","completeWriting","close","textEncoder","TextEncoder","stringToChunk","content","encode","stringToPrecomputedChunk","closeWithError","error","hasOwnProperty","Object","prototype","RESERVED","STRING","BOOLEANISH_STRING","BOOLEAN","OVERLOADED_BOOLEAN","NUMERIC","POSITIVE_NUMERIC","ATTRIBUTE_NAME_START_CHAR","ATTRIBUTE_NAME_CHAR","VALID_ATTRIBUTE_NAME_REGEX","RegExp","illegalAttributeNameCache","validatedAttributeNameCache","isAttributeNameSafe","attributeName","call","test","getPropertyInfo","name","properties","PropertyInfoRecord","type","mustUseProperty","attributeNamespace","sanitizeURL","removeEmptyString","acceptsBooleans","propertyName","reservedProps","push","forEach","toLowerCase","CAMELIZE","capitalize","token","toUpperCase","replace","xlinkHref","isUnitlessNumber","animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","opacity","order","orphans","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","prefixKey","prefix","key","charAt","substring","prefixes","keys","prop","matchHtmlRegExp","escapeHtml","string","str","match","exec","escape","html","index","lastIndex","charCodeAt","escapeTextForBrowser","text","uppercasePattern","msPattern","hyphenateStyleName","isArrayImpl","Array","isArray","a","startInlineScript","endInlineScript","startScriptSrc","startModuleSrc","endAsyncScript","escapeBootstrapScriptContent","scriptText","scriptRegex","scriptReplacer","s","suffix","createResponseState","identifierPrefix","nonce","bootstrapScriptContent","bootstrapScripts","bootstrapModules","idPrefix","undefined","inlineScriptWithNonce","bootstrapChunks","placeholderPrefix","segmentPrefix","boundaryPrefix","nextSuspenseID","sentCompleteSegmentFunction","sentCompleteBoundaryFunction","sentClientRenderFunction","ROOT_HTML_MODE","HTML_MODE","SVG_MODE","MATHML_MODE","HTML_TABLE_MODE","HTML_TABLE_BODY_MODE","HTML_TABLE_ROW_MODE","HTML_COLGROUP_MODE","createFormatContext","insertionMode","selectedValue","createRootFormatContext","namespaceURI","getChildFormatContext","parentContext","props","value","defaultValue","UNINITIALIZED_SUSPENSE_BOUNDARY_ID","assignSuspenseBoundaryID","responseState","generatedID","toString","makeId","treeId","localId","id","encodeHTMLTextNode","textSeparator","pushTextInstance","target","textEmbedded","pushSegmentFinale","lastPushedText","styleNameCache","Map","processStyleName","styleName","get","result","styleAttributeStart","styleAssign","styleSeparator","pushStyle","style","isFirst","styleValue","nameChunk","valueChunk","isCustomProperty","indexOf","trim","attributeEnd","attributeSeparator","attributeAssign","attributeEmptyString","pushAttribute","propertyInfo","attributeNameChunk","isNaN","slice","endOfStartTag","endOfStartTagSelfClosing","pushInnerHTML","innerHTML","children","__html","pushStartSelect","startChunkForTag","propKey","propValue","flattenOptionChildren","Children","child","selectedMarkerAttribute","pushStartOption","formatContext","selected","stringValue","v","pushInput","checked","defaultChecked","pushStartTextArea","leadingNewline","pushSelfClosing","tag","pushStartMenuItem","pushStartTitle","pushStartGenericElement","pushStartCustomElement","enableCustomElementPropertySupport","pushStartPreformattedElement","VALID_TAG_REGEX","validatedTagCache","tagStartChunk","DOCTYPE","pushStartInstance","is","endTag1","endTag2","pushEndInstance","writeCompletedRoot","placeholder1","placeholder2","writePlaceholder","formattedID","startCompletedSuspenseBoundary","startPendingSuspenseBoundary1","startPendingSuspenseBoundary2","startClientRenderedSuspenseBoundary","endSuspenseBoundary","clientRenderedSuspenseBoundaryError1","clientRenderedSuspenseBoundaryErrorAttrInterstitial","clientRenderedSuspenseBoundaryError1A","clientRenderedSuspenseBoundaryError1B","clientRenderedSuspenseBoundaryError1C","clientRenderedSuspenseBoundaryError2","writeStartCompletedSuspenseBoundary","writeStartPendingSuspenseBoundary","writeStartClientRenderedSuspenseBoundary","errorDigest","errorMesssage","errorComponentStack","writeEndCompletedSuspenseBoundary","writeEndPendingSuspenseBoundary","writeEndClientRenderedSuspenseBoundary","startSegmentHTML","startSegmentHTML2","endSegmentHTML","startSegmentSVG","startSegmentSVG2","endSegmentSVG","startSegmentMathML","startSegmentMathML2","endSegmentMathML","startSegmentTable","startSegmentTable2","endSegmentTable","startSegmentTableBody","startSegmentTableBody2","endSegmentTableBody","startSegmentTableRow","startSegmentTableRow2","endSegmentTableRow","startSegmentColGroup","startSegmentColGroup2","endSegmentColGroup","writeStartSegment","writeEndSegment","completeSegmentFunction","completeBoundaryFunction","clientRenderFunction","completeSegmentScript1Full","completeSegmentScript1Partial","completeSegmentScript2","completeSegmentScript3","writeCompletedSegmentInstruction","contentSegmentID","completeBoundaryScript1Full","completeBoundaryScript1Partial","completeBoundaryScript2","completeBoundaryScript3","writeCompletedBoundaryInstruction","boundaryID","formattedContentID","clientRenderScript1Full","clientRenderScript1Partial","clientRenderScript1A","clientRenderScript2","clientRenderErrorScriptArgInterstitial","writeClientRenderBoundaryInstruction","errorMessage","escapeJSStringsForInstructionScripts","regexForJSStringsInScripts","input","escaped","JSON","stringify","Error","assign","REACT_ELEMENT_TYPE","Symbol","for","REACT_PORTAL_TYPE","REACT_FRAGMENT_TYPE","REACT_STRICT_MODE_TYPE","REACT_PROFILER_TYPE","REACT_PROVIDER_TYPE","REACT_CONTEXT_TYPE","REACT_SERVER_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_SCOPE_TYPE","REACT_DEBUG_TRACING_MODE_TYPE","REACT_LEGACY_HIDDEN_TYPE","REACT_CACHE_TYPE","REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED","MAYBE_ITERATOR_SYMBOL","iterator","FAUX_ITERATOR_SYMBOL","getIteratorFn","maybeIterable","maybeIterator","getWrappedName","outerType","innerType","wrapperName","displayName","functionName","getContextName","getComponentNameFromType","$$typeof","context","provider","_context","render","outerName","lazyComponent","payload","_payload","init","_init","x","context2","_globalName","ReactSharedInternals","React","ReactCurrentDispatcher","ReactDebugCurrentFrame","emptyContextObject","getMaskedContext","unmaskedContext","contextTypes","processChildContext","instance","childContextTypes","getChildContext","childContext","contextKey","rootContextSnapshot","currentActiveSnapshot","popNode","prev","_currentValue","parentValue","pushNode","next","popToNearestCommonAncestor","parentPrev","parent","parentNext","popAllPrevious","pushAllNext","popPreviousToCommonLevel","depth","popNextToCommonLevel","switchContext","newSnapshot","pushProvider","nextValue","prevValue","prevNode","newNode","popProvider","prevSnapshot","_defaultValue","getActiveContext","readContext","isPrimaryRenderer","_reactInternals","classComponentUpdater","isMounted","inst","enqueueSetState","internals","getInstance","queue","enqueueReplaceState","enqueueForceUpdate","applyDerivedStateFromProps","ctor","getDerivedStateFromProps","prevState","nextProps","partialState","newState","constructClassInstance","maskedLegacyContext","contextType","callComponentWillMount","oldState","state","componentWillMount","UNSAFE_componentWillMount","processUpdateQueue","internalInstance","oldQueue","oldReplace","nextState","dontMutate","partial","mountClassInstance","newProps","initialState","updater","setInstance","getSnapshotBeforeUpdate","emptyTreeContext","overflow","getTreeId","idWithLeadingBit","getLeadingBit","pushTreeContext","baseContext","totalChildren","baseIdWithLeadingBit","baseOverflow","baseLength","getBitLength","baseId","slot","numberOfOverflowBits","newOverflowBits","newOverflow","restOfBaseId","restOfBaseLength","restOfLength","restOfNewBits","newBits","number","clz32","Math","clz32Fallback","log","LN2","asUint","y","objectIs","currentlyRenderingComponent","currentlyRenderingTask","firstWorkInProgressHook","workInProgressHook","isReRender","didScheduleRenderPhaseUpdate","localIdCounter","renderPhaseUpdates","numberOfReRenders","RE_RENDER_LIMIT","resolveCurrentlyRenderingComponent","areHookInputsEqual","nextDeps","prevDeps","createHook","memoizedState","createWorkInProgressHook","prepareToUseHooks","task","componentIdentity","finishHooks","Component","refOrContext","resetHooksState","checkDidRenderIdHook","didRenderIdHook","getCacheForType","resourceType","readContextImpl","useContext","basicStateReducer","action","useState","useReducer","reducer","initialArg","dispatch","firstRenderPhaseUpdate","delete","update","last","dispatchAction","bind","useMemo","nextCreate","deps","useRef","initialValue","previousRef","ref","current","useLayoutEffect","create","inputs","lastRenderPhaseUpdate","useCallback","useMutableSource","source","getSnapshot","subscribe","_source","useSyncExternalStore","getServerSnapshot","useDeferredValue","unsupportedStartTransition","useTransition","useId","treeContext","currentResponseState","unsupportedRefresh","useCacheRefresh","noop","Dispatcher","useInsertionEffect","useImperativeHandle","useEffect","useDebugValue","setCurrentResponseState","PENDING","COMPLETED","FLUSHED","ABORTED","ERRORED","OPEN","CLOSING","CLOSED","DEFAULT_PROGRESSIVE_CHUNK_SIZE","defaultErrorHandler","console","createRequest","rootFormatContext","progressiveChunkSize","onError","onAllReady","onShellReady","onShellError","onFatalError","pingedTasks","abortSet","Set","request","status","fatalError","nextSegmentId","allPendingTasks","pendingRootTasks","completedRootSegment","abortableTasks","clientRenderedBoundaries","completedBoundaries","partialBoundaries","rootSegment","createPendingSegment","parentFlushed","rootTask","createTask","pingTask","performWork","createSuspenseBoundary","fallbackAbortableTasks","rootSegmentID","pendingTasks","forceClientRender","completedSegments","byteSize","node","blockedBoundary","blockedSegment","legacyContext","ping","add","boundary","chunks","pushFunctionComponentStackInDEV","popComponentStackInDEV","logRecoverableError","renderSuspenseBoundary","pushBuiltInComponentStackInDEV","parentBoundary","parentSegment","fallback","fallbackAbortSet","newBoundary","insertionIndex","boundarySegment","contentRootSegment","renderNode","queueCompletedSegment","suspendedFallbackTask","renderHostElement","segment","prevContext","shouldConstruct","isReactComponent","renderWithHooks","secondArg","finishClassComponent","nextChildren","previousContext","mergedContext","renderNodeDestructive","renderClassComponent","pushClassComponentStackInDEV","maskedContext","renderIndeterminateComponent","hasId","prevTreeContext","resolveDefaultProps","baseProps","defaultProps","propName","renderForwardRef","renderMemo","resolvedProps","renderElement","renderContextConsumer","newValue","newChildren","renderContextProvider","renderLazyComponent","info","renderNodeDestructiveImpl","element","lazyNode","resolvedNode","renderChildrenArray","iteratorFn","step","done","childString","join","spawnNewSuspendedTask","newSegment","newTask","then","previousFormatContext","previousLegacyContext","erroredTask","abortTaskSoft","finishedTask","abortTask","reason","fallbackTask","clear","childSegment","retryTask","prevDispatcher","prevResponseState","splice","flushCompletedQueues","flushSubtree","segmentID","r","chunkIdx","childIdx","nextChild","flushSegment","contentSegment","flushClientRenderedBoundary","flushSegmentContainer","flushCompletedBoundary","flushPartiallyCompletedSegment","flushPartialBoundary","largeBoundaries","flushBuffered","startWork","startFlowing","abort","renderToReadableStream","options","Promise","resolve","reject","allReady","res","rej","stream","ReadableStream","pull","controller","cancel","highWaterMark","catch","signal","listener","removeEventListener","addEventListener"],"mappings":"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CV,WAAD,EAAcoT,qBAAd,CAA1B;EACD;;EACD;EAAS;EACP;EACD;EAlDH;EAoDD;AACD,EAAO,SAASG,eAAT,CACLvT,WADK,EAEL8O,aAFK,EAGI;EACT,UAAQA,aAAa,CAACnE,aAAtB;EACE,SAAKT,cAAL;EACA,SAAKC,SAAL;EAAgB;EACd,eAAOzJ,mBAAmB,CAACV,WAAD,EAAcmS,cAAd,CAA1B;EACD;;EACD,SAAK/H,QAAL;EAAe;EACb,eAAO1J,mBAAmB,CAACV,WAAD,EAAcsS,aAAd,CAA1B;EACD;;EACD,SAAKjI,WAAL;EAAkB;EAChB,eAAO3J,mBAAmB,CAACV,WAAD,EAAcyS,gBAAd,CAA1B;EACD;;EACD,SAAKnI,eAAL;EAAsB;EACpB,eAAO5J,mBAAmB,CAACV,WAAD,EAAc4S,eAAd,CAA1B;EACD;;EACD,SAAKrI,oBAAL;EAA2B;EACzB,eAAO7J,mBAAmB,CAACV,WAAD,EAAc+S,mBAAd,CAA1B;EACD;;EACD,SAAKvI,mBAAL;EAA0B;EACxB,eAAO9J,mBAAmB,CAACV,WAAD,EAAckT,kBAAd,CAA1B;EACD;;EACD,SAAKzI,kBAAL;EAAyB;EACvB,eAAO/J,mBAAmB,CAACV,WAAD,EAAcqT,kBAAd,CAA1B;EACD;;EACD;EAAS;EACP;EACD;EAzBH;EA2BD;EAID;EACA;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA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"}